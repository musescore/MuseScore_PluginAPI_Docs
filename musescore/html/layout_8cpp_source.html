<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MuseScore: libmscore/layout.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="musescore_logo_full.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MuseScore
   &#160;<span id="projectnumber">3.6</span>
   </div>
   <div id="projectbrief">Music composition and notation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2509ca22e4b78dc9c1fe9484874b85a6.html">libmscore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">layout.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="layout_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//=============================================================================</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//  MuseScore</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//  Music Composition &amp; Notation</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//  Copyright (C) 2002-2016 Werner Schweer</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  it under the terms of the GNU General Public License version 2</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//  as published by the Free Software Foundation and appearing in</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  the file LICENCE.GPL</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//=============================================================================</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="accidental_8h.html">accidental.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="barline_8h.html">barline.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="beam_8h.html">beam.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="box_8h.html">box.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="chord_8h.html">chord.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="clef_8h.html">clef.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="element_8h.html">element.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fingering_8h.html">fingering.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="glissando_8h.html">glissando.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="harmony_8h.html">harmony.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="key_8h.html">key.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="keysig_8h.html">keysig.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="layoutbreak_8h.html">layoutbreak.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="layout_8h.html">layout.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lyrics_8h.html">lyrics.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="marker_8h.html">marker.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="measure_8h.html">measure.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mmrestrange_8h.html">mmrestrange.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mscore_8h.html">mscore.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="notedot_8h.html">notedot.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="note_8h.html">note.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ottava_8h.html">ottava.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="page_8h.html">page.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libmscore_2part_8h.html">part.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="repeat_8h.html">repeat.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libmscore_2score_8h.html">score.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="segment_8h.html">segment.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sig_8h.html">sig.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slur_8h.html">slur.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="staff_8h.html">staff.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stem_8h.html">stem.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stemslash_8h.html">stemslash.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sticking_8h.html">sticking.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libmscore_2style_8h.html">style.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sym_8h.html">sym.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="system_8h.html">system.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="text_8h.html">text.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libmscore_2tie_8h.html">tie.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timesig_8h.html">timesig.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tremolo_8h.html">tremolo.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tuplet_8h.html">tuplet.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="undo_8h.html">undo.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libmscore_2utils_8h.html">utils.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="volta_8h.html">volta.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="breath_8h.html">breath.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tempotext_8h.html">tempotext.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="systemdivider_8h.html">systemdivider.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hook_8h.html">hook.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ambitus_8h.html">ambitus.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hairpin_8h.html">hairpin.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stafflines_8h.html">stafflines.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="articulation_8h.html">articulation.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="bracket_8h.html">bracket.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="spacer_8h.html">spacer.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fermata_8h.html">fermata.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="measurenumber_8h.html">measurenumber.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceMs.html">Ms</a> {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">// #define PAGE_DEBUG</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#ifdef PAGE_DEBUG</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define PAGEDBG(...)  qDebug(__VA_ARGS__)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="layout_8cpp.html#a663fbe6e23ae3d65d72b995b129712eb">   77</a></span>&#160;<span class="preprocessor">#define PAGEDBG(...)  ;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//   rebuildBspTree</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a42043d12f931f0597ede4c070cafe75a">   84</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a42043d12f931f0597ede4c070cafe75a">Score::rebuildBspTree</a>()</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Page.html">Page</a>* page : <a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>())</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            page-&gt;rebuildBspTree();</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//   layoutSegmentElements</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespaceMs.html#a50d463e01faf54d2cebbf7f248888bb6">   94</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a50d463e01faf54d2cebbf7f248888bb6">layoutSegmentElements</a>(<a class="code" href="classMs_1_1Segment.html">Segment</a>* segment, <span class="keywordtype">int</span> startTrack, <span class="keywordtype">int</span> endTrack)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = startTrack; track &lt; endTrack; ++track) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track))</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                  e-&gt;layout();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//   vUp</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//    reurns true if chord should be treated as up</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//    for purpose of setting horizontal position</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">//    for most chords, this is just chord-&gt;up()</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//    but for notes on cross-staff beams, we take care to produce more consistent results</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//    since the initial guess for up() may change during layout</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> vUp(<a class="code" href="classMs_1_1Chord.html">Chord</a>* chord)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">if</span> (!chord)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>() || !chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>()-&gt;<a class="code" href="classMs_1_1Beam.html#ad4f30020049f6fba843ecfcdd53ba269">cross</a>()) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">return</span> chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">// cross-staff beam: we cannot know the actual direction of this chord until the beam layout,</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">// but that&#39;s too late - it won&#39;t work to lay out as if the chord is up on pass one but then down on pass two</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="comment">// so just assign a logical direction based on attributes that won&#39;t change</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="comment">// so chords can be laid out consistently on both passes</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordtype">bool</span> up;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Chord.html#a722c73034ff13507a1336593e6af9567">stemDirection</a>() != <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ae1f2d5134ed2543d38a0de9751cf75d9">Direction::AUTO</a>)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                  up = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a722c73034ff13507a1336593e6af9567">stemDirection</a>() == <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Direction::UP</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>())</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                  up = chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() &gt; 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">track</a>() &lt; chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>()-&gt;<a class="code" href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">track</a>())</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                  up = <span class="keyword">false</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">track</a>() &gt; chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>()-&gt;<a class="code" href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">track</a>())</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                  up = <span class="keyword">true</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Chord.html#a002bfeb279e714adaff047d623de3fa8">measure</a>()-&gt;<a class="code" href="classMs_1_1Measure.html#acef2a5afe6db83509657e7fcdb03a08e">hasVoices</a>(chord-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>(), chord-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>(), chord-&gt;<a class="code" href="classMs_1_1DurationElement.html#a3791beed710457022daf6619f31a1eeb">actualTicks</a>()))</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                  up = !(chord-&gt;<a class="code" href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">track</a>() % 2);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                  up = !chord-&gt;<a class="code" href="classMs_1_1Element.html#a14581354d9bfc2c39c7dafbed79403da">staff</a>()-&gt;<a class="code" href="classMs_1_1Staff.html#a844c77bb4dd38e718c5d9a4cf2464d5d">isTop</a>();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">return</span> up;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">//   layoutChords1</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//    - layout upstem and downstem chords</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//    - offset as necessary to avoid conflict</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#aabf8eae8fbefcade6724ea507c16a9ed">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#aabf8eae8fbefcade6724ea507c16a9ed">Score::layoutChords1</a>(<a class="code" href="classMs_1_1Segment.html">Segment</a>* segment, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keyword">const</span> <a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> = <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">Score::staff</a>(staffIdx);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> startTrack = staffIdx * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> endTrack   = startTrack + <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">const</span> <a class="code" href="classMs_1_1Fraction.html">Fraction</a> <a class="code" href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a> = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a23cde3c97359266e2787b107aa0c8cdf">tick</a>();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">if</span> (staff-&gt;<a class="code" href="classMs_1_1Staff.html#afdd8a358b8e40b9e02bca11e9fbb8829">isTabStaff</a>(tick)) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="namespaceMs.html#a50d463e01faf54d2cebbf7f248888bb6">layoutSegmentElements</a>(segment, startTrack, endTrack);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordtype">bool</span> crossBeamFound = <span class="keyword">false</span>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      std::vector&lt;Note*&gt; upStemNotes;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      std::vector&lt;Note*&gt; downStemNotes;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordtype">int</span> upVoices       = 0;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordtype">int</span> downVoices     = 0;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      qreal nominalWidth = <a class="code" href="classMs_1_1Score.html#aebf61ce48548d4c61db23b0d94e184ae">noteHeadWidth</a>() * staff-&gt;<a class="code" href="classMs_1_1Staff.html#a80aa5db67223dff29e9113f23865b62b">mag</a>(tick);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      qreal maxUpWidth   = 0.0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      qreal maxDownWidth = 0.0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      qreal maxUpMag     = 0.0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      qreal maxDownMag   = 0.0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">// dots and hooks can affect layout of notes as well as vice versa</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordtype">int</span> upDots         = 0;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordtype">int</span> downDots       = 0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordtype">bool</span> upHooks       = <span class="keyword">false</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordtype">bool</span> downHooks     = <span class="keyword">false</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">// also check for grace notes</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">bool</span> upGrace       = <span class="keyword">false</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">bool</span> downGrace     = <span class="keyword">false</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = startTrack; track &lt; endTrack; ++track) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="classMs_1_1Element.html">Element</a>* e = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isChord()) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                  <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = toChord(e);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                  <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>() &amp;&amp; chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>()-&gt;<a class="code" href="classMs_1_1Beam.html#ad4f30020049f6fba843ecfcdd53ba269">cross</a>())</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                        crossBeamFound = <span class="keyword">true</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  <span class="keywordtype">bool</span> hasGraceBefore = <span class="keyword">false</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Chord.html">Chord</a>* c : chord-&gt;<a class="code" href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">graceNotes</a>()) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <span class="keywordflow">if</span> (c-&gt;isGraceBefore())</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                              hasGraceBefore = <span class="keyword">true</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a047fa69a68b80e772ad8fd9f85d2c837">layoutChords2</a>(c-&gt;notes(), c-&gt;up());       <span class="comment">// layout grace note noteheads</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a0c223da39c9d643f45912fae4e78f17e">layoutChords3</a>(c-&gt;notes(), <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>, 0);      <span class="comment">// layout grace note chords</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>()) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        ++upVoices;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        upStemNotes.insert(upStemNotes.end(), chord-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>().begin(), chord-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>().end());</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        upDots   = qMax(upDots, chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>());</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        maxUpMag = qMax(maxUpMag, chord-&gt;<a class="code" href="classMs_1_1Chord.html#aa3fcf32f0ec0dec0e4b15bc01b6329ec">mag</a>());</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        <span class="keywordflow">if</span> (!upHooks)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                              upHooks = chord-&gt;<a class="code" href="classMs_1_1Chord.html#afa6b543d5f66f5e9c6b216bddf9c4afd">hook</a>();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        <span class="keywordflow">if</span> (hasGraceBefore)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                              upGrace = <span class="keyword">true</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                        ++downVoices;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        downStemNotes.insert(downStemNotes.end(), chord-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>().begin(), chord-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>().end());</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                        downDots = qMax(downDots, chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>());</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        maxDownMag = qMax(maxDownMag, chord-&gt;<a class="code" href="classMs_1_1Chord.html#aa3fcf32f0ec0dec0e4b15bc01b6329ec">mag</a>());</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        <span class="keywordflow">if</span> (!downHooks)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                              downHooks = chord-&gt;<a class="code" href="classMs_1_1Chord.html#afa6b543d5f66f5e9c6b216bddf9c4afd">hook</a>();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <span class="keywordflow">if</span> (hasGraceBefore)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                              downGrace = <span class="keyword">true</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">if</span> (upVoices + downVoices) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">// TODO: use track as secondary sort criteria?</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">// otherwise there might be issues with unisons between voices</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">// in some corner cases</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            maxUpWidth   = nominalWidth * maxUpMag;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            maxDownWidth = nominalWidth * maxDownMag;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="comment">// layout upstem noteheads</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> (upVoices &gt; 1) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                  <a class="code" href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">std::sort</a>(upStemNotes.begin(), upStemNotes.end(),</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                     [](<a class="code" href="classMs_1_1Note.html">Note</a>* n1, <span class="keyword">const</span> <a class="code" href="classMs_1_1Note.html">Note</a>* n2) -&gt;<span class="keywordtype">bool</span> {<span class="keywordflow">return</span> n1-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &gt; n2-&gt;line(); } );</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                  }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">if</span> (upVoices) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                  qreal hw = <a class="code" href="classMs_1_1Score.html#a047fa69a68b80e772ad8fd9f85d2c837">layoutChords2</a>(upStemNotes, <span class="keyword">true</span>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                  maxUpWidth = qMax(maxUpWidth, hw);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                  }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// layout downstem noteheads</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> (downVoices &gt; 1) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                  <a class="code" href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">std::sort</a>(downStemNotes.begin(), downStemNotes.end(),</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                     [](<a class="code" href="classMs_1_1Note.html">Note</a>* n1, <span class="keyword">const</span> <a class="code" href="classMs_1_1Note.html">Note</a>* n2) -&gt;<span class="keywordtype">bool</span> {<span class="keywordflow">return</span> n1-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &gt; n2-&gt;line(); } );</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                  }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">if</span> (downVoices) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                  qreal hw = <a class="code" href="classMs_1_1Score.html#a047fa69a68b80e772ad8fd9f85d2c837">layoutChords2</a>(downStemNotes, <span class="keyword">false</span>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                  maxDownWidth = qMax(maxDownWidth, hw);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            qreal sp                 = staff-&gt;<a class="code" href="classMs_1_1Staff.html#a828f022bce378eb3bdf609c32c44f24d">spatium</a>(tick);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            qreal upOffset           = 0.0;      <span class="comment">// offset to apply to upstem chords</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            qreal downOffset         = 0.0;      <span class="comment">// offset to apply to downstem chords</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            qreal dotAdjust          = 0.0;      <span class="comment">// additional chord offset to account for dots</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            qreal dotAdjustThreshold = 0.0;      <span class="comment">// if it exceeds this amount</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">// centering adjustments for whole note, breve, and small chords</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            qreal centerUp          = 0.0;      <span class="comment">// offset to apply in order to center upstem chords</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            qreal oversizeUp        = 0.0;      <span class="comment">// adjustment to oversized upstem chord needed if laid out to the right</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            qreal centerDown        = 0.0;      <span class="comment">// offset to apply in order to center downstem chords</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            qreal centerAdjustUp    = 0.0;      <span class="comment">// adjustment to upstem chord needed after centering donwstem chord</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            qreal centerAdjustDown  = 0.0;      <span class="comment">// adjustment to downstem chord needed after centering upstem chord</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// only center chords if they differ from nominal by at least this amount</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="comment">// this avoids unnecessary centering on differences due only to floating point roundoff</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="comment">// it also allows for the possibility of disabling centering</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">// for notes only &quot;slightly&quot; larger than nominal, like half notes</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// but this will result in them not being aligned with each other between voices</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">// unless you change to left alignment as described in the comments below</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            qreal centerThreshold   = 0.01 * sp;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">// amount by which actual width exceeds nominal, adjusted for staff mag() only</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            qreal headDiff = maxUpWidth - nominalWidth;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="comment">// amount by which actual width exceeds nominal, adjusted for staff &amp; chord/note mag()</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            qreal headDiff2 = maxUpWidth - nominalWidth * (maxUpMag / staff-&gt;<a class="code" href="classMs_1_1Staff.html#a80aa5db67223dff29e9113f23865b62b">mag</a>(tick));</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (headDiff &gt; centerThreshold) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                  <span class="comment">// larger than nominal</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                  centerUp = headDiff * -0.5;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                  <span class="comment">// maxUpWidth is true width, but we no longer will care about that</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                  <span class="comment">// instead, we care only about portion to right of origin</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                  maxUpWidth += centerUp;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  <span class="comment">// to left align rather than center, delete both of the above</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                  <span class="keywordflow">if</span> (headDiff2 &gt; centerThreshold) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        <span class="comment">// if max notehead is wider than nominal with chord/note mag() applied</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                        <span class="comment">// then noteheads extend to left of origin</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                        <span class="comment">// because stemPosX() is based on nominal width</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                        <span class="comment">// so we need to correct for that too</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        centerUp += headDiff2;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                        oversizeUp = headDiff2;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                        }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                  }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (-headDiff &gt; centerThreshold) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                  <span class="comment">// smaller than nominal</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  centerUp = -headDiff * 0.5;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                  <span class="keywordflow">if</span> (headDiff2 &gt; centerThreshold) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        <span class="comment">// max notehead is wider than nominal with chord/note mag() applied</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        <span class="comment">// perform same adjustment as above</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        centerUp += headDiff2;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        oversizeUp = headDiff2;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                  centerAdjustDown = centerUp;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                  }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            headDiff = maxDownWidth - nominalWidth;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (headDiff &gt; centerThreshold) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  <span class="comment">// larger than nominal</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                  centerDown = headDiff * -0.5;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                  <span class="comment">// to left align rather than center, change the above to</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                  <span class="comment">//centerAdjustUp = headDiff;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                  maxDownWidth = nominalWidth - centerDown;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                  }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (-headDiff &gt; centerThreshold) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                  <span class="comment">// smaller than nominal</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                  centerDown = -headDiff * 0.5;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                  centerAdjustUp = centerDown;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                  }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// handle conflict between upstem and downstem chords</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">if</span> (upVoices &amp;&amp; downVoices) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                  <a class="code" href="classMs_1_1Note.html">Note</a>* bottomUpNote = upStemNotes.front();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                  <a class="code" href="classMs_1_1Note.html">Note</a>* topDownNote  = downStemNotes.back();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                  <span class="keywordtype">int</span> separation;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                  <span class="comment">// TODO: handle conflicts for cross-staff notes and notes on cross-staff beams</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                  <span class="comment">// for now we simply treat these as though there is no conflict</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                  <span class="keywordflow">if</span> (bottomUpNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() == topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() &amp;&amp; !crossBeamFound)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                        separation = topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() - bottomUpNote-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                        separation = 2;   <span class="comment">// no conflict</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                  QVector&lt;Note*&gt; overlapNotes;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                  overlapNotes.reserve(8);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                  <span class="keywordflow">if</span> (separation == 1) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <span class="comment">// second</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        downOffset = maxUpWidth;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        <span class="comment">// align stems if present, leave extra room if not</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        <span class="keywordflow">if</span> (topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>() &amp;&amp; bottomUpNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>())</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                              downOffset -= topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>()-&gt;<a class="code" href="classMs_1_1Stem.html#aadcbdc10cbafbc7486be0092097fae12">lineWidth</a>();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                              downOffset += 0.1 * sp;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (separation &lt; 1) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <span class="comment">// overlap (possibly unison)</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <span class="comment">// build list of overlapping notes</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0, n = upStemNotes.size(); i &lt; n; ++i) {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                              <span class="keywordflow">if</span> (upStemNotes[i]-&gt;line() &gt;= topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() - 1)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                    overlapNotes.append(upStemNotes[i]);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                              }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = downStemNotes.size(); i &gt; 0; --i) { <span class="comment">// loop most probably needs to be in this reverse order</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                              <span class="keywordflow">if</span> (downStemNotes[i-1]-&gt;line() &lt;= bottomUpNote-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() + 1)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                    overlapNotes.append(downStemNotes[i-1]);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                              }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        <a class="code" href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">std::sort</a>(overlapNotes.begin(), overlapNotes.end(),</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                           [](<a class="code" href="classMs_1_1Note.html">Note</a>* n1, <span class="keyword">const</span> <a class="code" href="classMs_1_1Note.html">Note</a>* n2) -&gt;<span class="keywordtype">bool</span> {<span class="keywordflow">return</span> n1-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &gt; n2-&gt;line(); } );</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                        <span class="comment">// determine nature of overlap</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                        <span class="keywordtype">bool</span> shareHeads = <span class="keyword">true</span>;       <span class="comment">// can all overlapping notes share heads?</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        <span class="keywordtype">bool</span> matchPending = <span class="keyword">false</span>;    <span class="comment">// looking for a unison match</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        <span class="keywordtype">bool</span> conflictUnison = <span class="keyword">false</span>;  <span class="comment">// unison found</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        <span class="keywordtype">bool</span> conflictSecondUpHigher = <span class="keyword">false</span>;      <span class="comment">// second found</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        <span class="keywordtype">bool</span> conflictSecondDownHigher = <span class="keyword">false</span>;    <span class="comment">// second found</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        <span class="keywordtype">int</span> lastLine = 1000;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                        <a class="code" href="classMs_1_1Note.html">Note</a>* p = overlapNotes[0];</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, count = overlapNotes.size(); i &lt; count; ++i) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                              <a class="code" href="classMs_1_1Note.html">Note</a>* n = overlapNotes[i];</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                              <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87">NoteHead::Type</a> nHeadType;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                              <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87">NoteHead::Type</a> pHeadType;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                              <a class="code" href="classMs_1_1Chord.html">Chord</a>* nchord = n-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                              <a class="code" href="classMs_1_1Chord.html">Chord</a>* pchord = p-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                              <span class="keywordflow">if</span> (n-&gt;<a class="code" href="classMs_1_1Note.html#a015e1e0a27a32eef6070e3fc45a682fe">mirror</a>()) {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                    <span class="keywordflow">if</span> (separation &lt; 0) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                          <span class="comment">// don&#39;t try to share heads if there is any mirroring</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                          shareHeads = <span class="keyword">false</span>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                          <span class="comment">// don&#39;t worry about conflicts involving mirrored notes</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                          }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                    }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                              <span class="keywordtype">int</span> line = n-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                              <span class="keywordtype">int</span> d = lastLine - line;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                              <span class="keywordflow">switch</span> (d) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                          <span class="comment">// unison</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                          conflictUnison = <span class="keyword">true</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                          matchPending = <span class="keyword">false</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                          nHeadType = (n-&gt;<a class="code" href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">headType</a>() == <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a45b570219d7d4c6d4c05af96807c8d7a">NoteHead::Type::HEAD_AUTO</a>) ? n-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>().<a class="code" href="classMs_1_1TDuration.html#aab1a411cf428fcc4244950a88b03ab95">headType</a>() : n-&gt;<a class="code" href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">headType</a>();</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                          pHeadType = (p-&gt;<a class="code" href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">headType</a>() == <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a45b570219d7d4c6d4c05af96807c8d7a">NoteHead::Type::HEAD_AUTO</a>) ? p-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>().<a class="code" href="classMs_1_1TDuration.html#aab1a411cf428fcc4244950a88b03ab95">headType</a>() : p-&gt;<a class="code" href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">headType</a>();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                          <span class="comment">// the most important rules for sharing noteheads on unisons between voices are</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                          <span class="comment">// that notes must be one same line with same tpc</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                          <span class="comment">// noteheads must be unmirrored and of same group</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                          <span class="comment">// and chords must be same size (or else sharing code won&#39;t work)</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                          <span class="keywordflow">if</span> (n-&gt;<a class="code" href="classMs_1_1Note.html#aa3ab372fd5e04a1563fe8c7581c5aae7">headGroup</a>() != p-&gt;<a class="code" href="classMs_1_1Note.html#aa3ab372fd5e04a1563fe8c7581c5aae7">headGroup</a>() || n-&gt;<a class="code" href="classMs_1_1Note.html#af813072eba46ad48757444a574d0a01f">tpc</a>() != p-&gt;<a class="code" href="classMs_1_1Note.html#af813072eba46ad48757444a574d0a01f">tpc</a>() || n-&gt;<a class="code" href="classMs_1_1Note.html#a015e1e0a27a32eef6070e3fc45a682fe">mirror</a>() || p-&gt;<a class="code" href="classMs_1_1Note.html#a015e1e0a27a32eef6070e3fc45a682fe">mirror</a>() || nchord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a260e9896d5323993e2ba87c40f60d5ce">small</a>() != pchord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a260e9896d5323993e2ba87c40f60d5ce">small</a>()) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                                shareHeads = <span class="keyword">false</span>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                                }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                          <span class="keywordflow">else</span> {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                                <span class="comment">// noteheads are potentially shareable</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                                <span class="comment">// it is more subjective at this point</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                <span class="comment">// current default is to require *either* of the following:</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                                <span class="comment">//    1) both chords have same number of dots, both have stems, and both noteheads are same type and are full size (automatic match)</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                                <span class="comment">// or 2) one or more of the noteheads is not of type AUTO, but is explicitly set to match the other (user-forced match)</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                                <span class="comment">// or 3) exactly one of the noteheads is invisible (user-forced match)</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                                <span class="comment">// thus user can force notes to be shared despite differing number of dots or either being stemless</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                <span class="comment">// by setting one of the notehead types to match the other or by making one notehead invisible</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                                <span class="comment">// TODO: consider adding a style option, staff properties, or note property to control sharing</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                                <span class="keywordflow">if</span> ((nchord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>() != pchord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>() || !nchord-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>() || !pchord-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>() || nHeadType != pHeadType || n-&gt;<a class="code" href="classMs_1_1Note.html#a488c3e17de900353472040373d0e7f83">small</a>() || p-&gt;<a class="code" href="classMs_1_1Note.html#a488c3e17de900353472040373d0e7f83">small</a>()) &amp;&amp;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                                    ((n-&gt;<a class="code" href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">headType</a>() == <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a45b570219d7d4c6d4c05af96807c8d7a">NoteHead::Type::HEAD_AUTO</a> &amp;&amp; p-&gt;<a class="code" href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">headType</a>() == <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a45b570219d7d4c6d4c05af96807c8d7a">NoteHead::Type::HEAD_AUTO</a>) || nHeadType != pHeadType) &amp;&amp;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                                    (n-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>() == p-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>())) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                                      shareHeads = <span class="keyword">false</span>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                                      }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                                }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                          <span class="comment">// second</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                          <span class="comment">// trust that this won&#39;t be a problem for single unison</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                          <span class="keywordflow">if</span> (separation &lt; 0) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                                <span class="keywordflow">if</span> (n-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>())</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                                      conflictSecondUpHigher = <span class="keyword">true</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                                <span class="keywordflow">else</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                                      conflictSecondDownHigher = <span class="keyword">true</span>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                shareHeads = <span class="keyword">false</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                                }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                          <span class="comment">// no conflict</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                          <span class="keywordflow">if</span> (matchPending)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                shareHeads = <span class="keyword">false</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                          matchPending = <span class="keyword">true</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                    }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                              p = n;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                              lastLine = line;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                              }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        <span class="keywordflow">if</span> (matchPending)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                              shareHeads = <span class="keyword">false</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        <span class="comment">// calculate offsets</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        <span class="keywordflow">if</span> (shareHeads) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = overlapNotes.size() - 1; i &gt;= 1; i -= 2) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                    <a class="code" href="classMs_1_1Note.html">Note</a>* previousNote = overlapNotes[i-1];</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                    <a class="code" href="classMs_1_1Note.html">Note</a>* n = overlapNotes[i];</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                    <span class="keywordflow">if</span> (!(previousNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a592da9bef8f5ea3c9840931e8db5f6f6">isNudged</a>() || n-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a592da9bef8f5ea3c9840931e8db5f6f6">isNudged</a>())) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                          <span class="keywordflow">if</span> (previousNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>() == n-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>()) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                <span class="comment">// hide one set dots</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                <span class="keywordtype">bool</span> onLine = !(previousNote-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &amp; 1);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                                <span class="keywordflow">if</span> (onLine) {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                                      <span class="comment">// hide dots for lower voice</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                                      <span class="keywordflow">if</span> (previousNote-&gt;<a class="code" href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">voice</a>() &amp; 1)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                                            previousNote-&gt;<a class="code" href="classMs_1_1Note.html#aac8969ffb365d143f0b60b4a222303f4">setDotsHidden</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                                      <span class="keywordflow">else</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                            n-&gt;<a class="code" href="classMs_1_1Note.html#aac8969ffb365d143f0b60b4a222303f4">setDotsHidden</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                      }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                      <span class="comment">// hide dots for upper voice</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                      <span class="keywordflow">if</span> (!(previousNote-&gt;<a class="code" href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">voice</a>() &amp; 1))</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                            previousNote-&gt;<a class="code" href="classMs_1_1Note.html#aac8969ffb365d143f0b60b4a222303f4">setDotsHidden</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                                      <span class="keywordflow">else</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                            n-&gt;<a class="code" href="classMs_1_1Note.html#aac8969ffb365d143f0b60b4a222303f4">setDotsHidden</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                      }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                                }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                          <span class="comment">// formerly we hid noteheads in an effort to fix playback</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                          <span class="comment">// but this doesn&#39;t work for cases where noteheads cannot be shared</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                          <span class="comment">// so better to solve the problem elsewhere</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                          }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                    }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                              }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conflictUnison &amp;&amp; separation == 0 &amp;&amp; (!downGrace || upGrace))</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                              downOffset = maxUpWidth + 0.3 * sp;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conflictUnison)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                              upOffset = maxDownWidth + 0.3 * sp;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conflictSecondUpHigher)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                              upOffset = maxDownWidth + 0.2 * sp;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((downHooks &amp;&amp; !upHooks) &amp;&amp; !(upDots &amp;&amp; !downDots))</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                              downOffset = maxUpWidth + 0.3 * sp;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conflictSecondDownHigher) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                              <span class="keywordflow">if</span> (downDots &amp;&amp; !upDots)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                    downOffset = maxUpWidth + 0.3 * sp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                              <span class="keywordflow">else</span> {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                    upOffset = maxDownWidth - 0.2 * sp;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                    <span class="keywordflow">if</span> (downHooks)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                          upOffset += 0.3 * sp;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                    }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                              }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                              <span class="comment">// no direct conflict, so parts can overlap (downstem on left)</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                              <span class="comment">// just be sure that stems clear opposing noteheads</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                              qreal clearLeft = 0.0, clearRight = 0.0;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                              <span class="keywordflow">if</span> (topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>())</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                    clearLeft = topDownNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>()-&gt;<a class="code" href="classMs_1_1Stem.html#aadcbdc10cbafbc7486be0092097fae12">lineWidth</a>() + 0.3 * sp;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                              <span class="keywordflow">if</span> (bottomUpNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>())</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                    clearRight = bottomUpNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>()-&gt;<a class="code" href="classMs_1_1Stem.html#aadcbdc10cbafbc7486be0092097fae12">lineWidth</a>() + qMax(maxDownWidth - maxUpWidth, 0.0) + 0.3 * sp;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                    downDots = 0; <span class="comment">// no need to adjust for dots in this case</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                              upOffset = qMax(clearLeft, clearRight);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                              <span class="keywordflow">if</span> (downHooks) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                    <span class="comment">// we will need more space to avoid collision with hook</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                    <span class="comment">// but we won&#39;t need as much dot adjustment</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                    upOffset = qMax(upOffset, maxDownWidth + 0.1 * sp);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                    dotAdjustThreshold = maxUpWidth - 0.3 * sp;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                    }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                              <span class="comment">// if downstem chord is small, don&#39;t center</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                              <span class="comment">// and we might not need as much dot adjustment either</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                              <span class="keywordflow">if</span> (centerDown &gt; 0.0) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                    centerDown = 0.0;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                    centerAdjustUp = 0.0;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                    dotAdjustThreshold = (upOffset - maxDownWidth) + maxUpWidth - 0.3 * sp;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                              }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                  <span class="comment">// adjust for dots</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                  <span class="keywordflow">if</span> ((upDots &amp;&amp; !downDots) || (downDots &amp;&amp; !upDots)) {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <span class="comment">// only one sets of dots</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        <span class="comment">// place between chords</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        <span class="keywordtype">int</span> dots;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                        qreal mag;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        <span class="keywordflow">if</span> (upDots) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                              dots = upDots;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                              mag = maxUpMag;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                              }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                              dots = downDots;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                              mag = maxDownMag;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                              }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        qreal dotWidth = segment-&gt;<a class="code" href="classMs_1_1Element.html#adc45b084165da6ceb3afa7913d6a3feb">symWidth</a>(<a class="code" href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794ae7f80072156130d537acf825545c10f0">SymId::augmentationDot</a>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="comment">// first dot</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        dotAdjust = <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eac694e96ba92f954edbc6a0c810e98aff">Sid::dotNoteDistance</a>) + dotWidth;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="comment">// additional dots</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <span class="keywordflow">if</span> (dots &gt; 1)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                              dotAdjust += <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea5b6e0c6863a2e5149eda540e72454a68">Sid::dotDotDistance</a>) * (dots - 1);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        dotAdjust *= mag;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <span class="comment">// only by amount over threshold</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        dotAdjust = qMax(dotAdjust - dotAdjustThreshold, 0.0);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                  <span class="keywordflow">if</span> (separation == 1)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        dotAdjust += 0.1 * sp;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                  }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="comment">// apply chord offsets</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = startTrack; track &lt; endTrack; ++track) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* e = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isChord()) {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = toChord(e);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>()) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                              <span class="keywordflow">if</span> (upOffset != 0.0) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += upOffset + centerAdjustUp + oversizeUp;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                    <span class="keywordflow">if</span> (downDots &amp;&amp; !upDots)</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                          chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += dotAdjust;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                    }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += centerUp;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                              }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                              <span class="keywordflow">if</span> (downOffset != 0.0) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += downOffset + centerAdjustDown;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                    <span class="keywordflow">if</span> (upDots &amp;&amp; !downDots)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                          chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += dotAdjust;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                    }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += centerDown;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                              }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                  }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="comment">// layout chords</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            std::vector&lt;Note*&gt; notes;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">if</span> (upVoices)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  notes.insert(notes.end(), upStemNotes.begin(), upStemNotes.end());</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> (downVoices)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                  notes.insert(notes.end(), downStemNotes.begin(), downStemNotes.end());</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">if</span> (upVoices + downVoices &gt; 1)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                  <a class="code" href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">std::sort</a>(notes.begin(), notes.end(),</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                     [](<a class="code" href="classMs_1_1Note.html">Note</a>* n1, <span class="keyword">const</span> <a class="code" href="classMs_1_1Note.html">Note</a>* n2) -&gt;<span class="keywordtype">bool</span> {<span class="keywordflow">return</span> n1-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &gt; n2-&gt;line(); } );</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <a class="code" href="classMs_1_1Score.html#a0c223da39c9d643f45912fae4e78f17e">layoutChords3</a>(notes, staff, segment);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="namespaceMs.html#a50d463e01faf54d2cebbf7f248888bb6">layoutSegmentElements</a>(segment, startTrack, endTrack);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">//   layoutChords2</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">//    - determine which notes need mirroring</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">//    - this is called once for each stem direction</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">//      eg, once for voices 1&amp;3, once for 2&amp;4</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">//      with all notes combined and sorted to resemble one chord</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">//    - return maximum non-mirrored notehead width</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a047fa69a68b80e772ad8fd9f85d2c837">  588</a></span>&#160;qreal <a class="code" href="classMs_1_1Score.html#a047fa69a68b80e772ad8fd9f85d2c837">Score::layoutChords2</a>(std::vector&lt;Note*&gt;&amp; notes, <span class="keywordtype">bool</span> up)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordtype">int</span> startIdx, endIdx, incIdx;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      qreal maxWidth = 0.0;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">// loop in correct direction so that first encountered notehead wins conflict</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">if</span> (up) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="comment">// loop bottom up</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            startIdx = 0;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            endIdx = int(notes.size());</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            incIdx = 1;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="comment">// loop top down</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            startIdx = int(notes.size()) - 1;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            endIdx = -1;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            incIdx = -1;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordtype">int</span> ll        = 1000;         <span class="comment">// line of previous notehead</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                    <span class="comment">// hack: start high so first note won&#39;t show as conflict</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordtype">bool</span> lvisible = <span class="keyword">false</span>;        <span class="comment">// was last note visible?</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordtype">bool</span> mirror   = <span class="keyword">false</span>;        <span class="comment">// should current notehead be mirrored?</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                    <span class="comment">// value is retained and may be used on next iteration</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                    <span class="comment">// to track mirror status of previous note</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordtype">bool</span> isLeft   = notes[startIdx]-&gt;chord()-&gt;up();             <span class="comment">// is notehead on left?</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordtype">int</span> lmove     = notes[startIdx]-&gt;chord()-&gt;staffMove();      <span class="comment">// staff offset of last note (for cross-staff beaming)</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = startIdx; idx != endIdx; idx += incIdx) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <a class="code" href="classMs_1_1Note.html">Note</a>* note    = notes[idx];                     <span class="comment">// current note</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordtype">int</span> line      = note-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();                   <span class="comment">// line of current note</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord  = note-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>();</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#a229ec32c64e743ef265e720ac0c44df3">move</a>      = chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>();             <span class="comment">// staff offset of current note</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="comment">// there is a conflict</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="comment">// if this is same or adjacent line as previous note (and chords are on same staff!)</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="comment">// but no need to do anything about it if either note is invisible</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordtype">bool</span> conflict = (qAbs(ll - line) &lt; 2) &amp;&amp; (lmove == move) &amp;&amp; note-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>() &amp;&amp; lvisible;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="comment">// this note is on opposite side of stem as previous note</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="comment">// if there is a conflict</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="comment">// or if this the first note *after* a conflict</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordflow">if</span> (conflict || (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() != isLeft))</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                  isLeft = !isLeft;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="comment">// determine if we would need to mirror current note</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="comment">// to get it to the correct side</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="comment">// this would be needed to get a note to left or downstem or right of upstem</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="comment">// whether or not we actually do this is determined later (based on user mirror property)</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordtype">bool</span> nmirror = (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() != isLeft);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="comment">// by default, notes and dots are not hidden</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="comment">// this may be changed later to allow unisons to share noteheads</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            note-&gt;<a class="code" href="classMs_1_1Note.html#a180de4d0e2a4b8dda03c5ed38c12f4fe">setHidden</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            note-&gt;<a class="code" href="classMs_1_1Note.html#aac8969ffb365d143f0b60b4a222303f4">setDotsHidden</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="comment">// be sure chord position is initialized</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="comment">// chord may be moved to the right later</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="comment">// if there are conflicts between voices</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            chord-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() = 0.0;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="comment">// let user mirror property override the default we calculated</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">if</span> (note-&gt;<a class="code" href="classMs_1_1Note.html#ab0ce88117199ff8fea149d99b515c2e7">userMirror</a>() == <a class="code" href="classMs_1_1MScore.html#ac1a0c95bfede9e37dd3fd910905092b8ae1f2d5134ed2543d38a0de9751cf75d9">MScore::DirectionH::AUTO</a>) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                  mirror = nmirror;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                  }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                  mirror = note-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>();</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                  <span class="keywordflow">if</span> (note-&gt;<a class="code" href="classMs_1_1Note.html#ab0ce88117199ff8fea149d99b515c2e7">userMirror</a>() == <a class="code" href="classMs_1_1MScore.html#ac1a0c95bfede9e37dd3fd910905092b8a684d325a7303f52e64011467ff5c5758">MScore::DirectionH::LEFT</a>)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                        mirror = !mirror;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                  }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            note-&gt;<a class="code" href="classMs_1_1Note.html#a0fd80339f7fe2ce2a9dedae21188821d">setMirror</a>(mirror);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="comment">// accumulate return value</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">if</span> (!mirror)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                  maxWidth = qMax(maxWidth, note-&gt;<a class="code" href="classMs_1_1Note.html#ad55c1e54b156996f2b1d211c31eb7df9">bboxRightPos</a>());</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="comment">// prepare for next iteration</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            lvisible = note-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>();</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            lmove    = <a class="code" href="classMs_1_1Score.html#a229ec32c64e743ef265e720ac0c44df3">move</a>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            ll       = line;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">return</span> maxWidth;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">//   AcEl</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html">  677</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structMs_1_1AcEl.html">AcEl</a> {</div><div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">  678</a></span>&#160;      <a class="code" href="classMs_1_1Note.html">Note</a>* <a class="code" href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">note</a>;</div><div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">  679</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a>;          <span class="comment">// actual x position of this accidental relative to origin</span></div><div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">  680</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a>;        <span class="comment">// top of accidental bbox relative to staff</span></div><div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">  681</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a>;     <span class="comment">// bottom of accidental bbox relative to staff</span></div><div class="line"><a name="l00682"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">  682</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a>;         <span class="comment">// line of note</span></div><div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#a567a45827d8c039061ba10ecbccbfe2c">  683</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structMs_1_1AcEl.html#a567a45827d8c039061ba10ecbccbfe2c">next</a>;         <span class="comment">// index of next accidental of same pitch class (ascending list)</span></div><div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">  684</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>;      <span class="comment">// width of accidental</span></div><div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">  685</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a>;     <span class="comment">// amount (in sp) vertical strokes extend above body</span></div><div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">  686</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">descent</a>;    <span class="comment">// amount (in sp) vertical strokes extend below body</span></div><div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">  687</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">rightClear</a>; <span class="comment">// amount (in sp) to right of last vertical stroke above body</span></div><div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">  688</a></span>&#160;      qreal <a class="code" href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">leftClear</a>;  <span class="comment">// amount (in sp) to left of last vertical stroke below body</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      };</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">//   resolveAccidentals</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">//    lx = calculated position of rightmost edge of left accidental relative to origin</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="namespaceMs.html#ab75fbe8b5bec673d00aa110712b4c887">  696</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#ab75fbe8b5bec673d00aa110712b4c887">resolveAccidentals</a>(<a class="code" href="structMs_1_1AcEl.html">AcEl</a>* left, <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* right, qreal&amp; lx, qreal <a class="code" href="namespaceMs.html#a56be22d124547a688e971dcfc73752ff">pd</a>, qreal sp)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* upper;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* lower;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">if</span> (left-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a> &gt;= right-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a>) {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            upper = right;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            lower = left;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            upper = left;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            lower = right;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      qreal gap = lower-&gt;<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a> - upper-&gt;<a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">// no conflict at all if there is sufficient vertical gap between accidentals</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// the arrangement of accidentals into columns assumes accidentals an octave apart *do* clear</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (gap &gt;= pd || lower-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a> - upper-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a> &gt;= 7)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      qreal allowableOverlap = qMax(upper-&gt;<a class="code" href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">descent</a>, lower-&gt;<a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a>) - <a class="code" href="namespaceMs.html#a56be22d124547a688e971dcfc73752ff">pd</a>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="comment">// accidentals that are &quot;close&quot; (small gap or even slight overlap)</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">if</span> (qAbs(gap) &lt;= 0.33 * sp) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="comment">// acceptable with slight offset</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="comment">// if one of the accidentals can subsume the overlap</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="comment">// and both accidentals allow it</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordflow">if</span> (-gap &lt;= allowableOverlap &amp;&amp; qMin(upper-&gt;<a class="code" href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">descent</a>, lower-&gt;<a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a>) &gt; 0.0) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                  qreal align = qMin(left-&gt;<a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                  lx = qMin(lx, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> + align - pd);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="comment">// amount by which overlapping accidentals will be separated</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="comment">// for example, the vertical stems of two flat signs</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="comment">// these need more space than we would need between non-overlapping accidentals</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      qreal overlapShift = pd * 1.41;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">// accidentals with more significant overlap</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">// acceptable if one accidental can subsume overlap</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">if</span> (left == lower &amp;&amp; -gap &lt;= allowableOverlap) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            qreal offset = qMax(left-&gt;<a class="code" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">rightClear</a>, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">leftClear</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            offset = qMin(offset, left-&gt;<a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>) - overlapShift;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            lx = qMin(lx, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> + offset);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">// accidentals with even more overlap</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="comment">// can work if both accidentals can subsume overlap</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordflow">if</span> (left == lower &amp;&amp; -gap &lt;= upper-&gt;descent + lower-&gt;<a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a> - pd) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            qreal offset = qMin(left-&gt;<a class="code" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">rightClear</a>, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">leftClear</a>) - overlapShift;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">if</span> (offset &gt; 0.0) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                  lx = qMin(lx, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> + offset);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                  }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">// otherwise, there is real conflict</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      lx = qMin(lx, right-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> - pd);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">//   layoutAccidental</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno"><a class="line" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">  763</a></span>&#160;<span class="keyword">static</span> QPair&lt;qreal, qreal&gt; <a class="code" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">layoutAccidental</a>(<a class="code" href="structMs_1_1AcEl.html">AcEl</a>* me, <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* above, <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* below, qreal colOffset, QVector&lt;Note*&gt;&amp; leftNotes, qreal pnd, qreal <a class="code" href="namespaceMs.html#a56be22d124547a688e971dcfc73752ff">pd</a>, qreal sp)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      qreal lx = colOffset;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <a class="code" href="classMs_1_1Accidental.html">Accidental</a>* acc = me-&gt;<a class="code" href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">note</a>-&gt;<a class="code" href="classMs_1_1Note.html#a39025226e9614de8073a91e82dcbb8ee">accidental</a>();</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      qreal mag = acc-&gt;<a class="code" href="classMs_1_1Element.html#ad01cda9f6017d09c9fb9305de18e9310">mag</a>();</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      pnd *= mag;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      pd *= mag;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = me-&gt;<a class="code" href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">note</a>-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>();</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> = chord-&gt;<a class="code" href="classMs_1_1Element.html#a14581354d9bfc2c39c7dafbed79403da">staff</a>();</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> <a class="code" href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a> = chord-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="comment">// extra space for ledger lines</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      qreal ledgerAdjust = 0.0;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      qreal ledgerVerticalClear = 0.0;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordtype">bool</span> ledgerAbove = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a1a35e7598d783204faa93ba261b5909d">upNote</a>()-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &lt;= -2;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordtype">bool</span> ledgerBelow = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a34bb3c54117e0a1b7ca0c632c19a0bd7">downNote</a>()-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() &gt;= staff-&gt;<a class="code" href="classMs_1_1Staff.html#a1a4d5789b71d29fd2e7c05311638aa7b">lines</a>(tick) * 2;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordflow">if</span> (ledgerAbove || ledgerBelow) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">// ledger lines are present</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="comment">// check for collision with lines above &amp; below staff</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="comment">// note that on 1-line staff, both collisions are possible at once</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">// TODO: account for cutouts in accidental</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            qreal lds = staff-&gt;<a class="code" href="classMs_1_1Staff.html#a74445d56eed54f6c4d22c5ba301a531f">lineDistance</a>(tick) * sp;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keywordflow">if</span> ((ledgerAbove &amp;&amp; me-&gt;<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a> + lds &lt;= pnd) || (ledgerBelow &amp;&amp; staff-&gt;<a class="code" href="classMs_1_1Staff.html#a1a4d5789b71d29fd2e7c05311638aa7b">lines</a>(tick) * lds - me-&gt;<a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a> &lt;= pnd)) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                  ledgerAdjust = -acc-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a64f76d8f29e50d9cb8bfda72fbf62d2c">styleS</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead3a95911641db612363b3985d386e7f7">Sid::ledgerLineLength</a>).<a class="code" href="classMs_1_1Spatium.html#ab21fa50b8ec92de51fb08a2365770422">val</a>() * sp;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                  ledgerVerticalClear = acc-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a64f76d8f29e50d9cb8bfda72fbf62d2c">styleS</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eae8ca6eb9d2ba4f6fe3cabadc4719fd1b">Sid::ledgerLineWidth</a>).<a class="code" href="classMs_1_1Spatium.html#ab21fa50b8ec92de51fb08a2365770422">val</a>() * 0.5 * sp;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                  lx = qMin(lx, ledgerAdjust);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="comment">// clear left notes</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordtype">int</span> lns = leftNotes.size();</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; lns; ++i) {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="classMs_1_1Note.html">Note</a>* ln = leftNotes[i];</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordtype">int</span> lnLine = ln-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            qreal lnTop = (lnLine - 1) * 0.5 * sp;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            qreal lnBottom = lnTop + sp;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span> (me-&gt;<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a> - lnBottom &lt;= pnd &amp;&amp; lnTop - me-&gt;bottom &lt;= pnd) {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                  qreal lnLedgerAdjust = 0.0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                  <span class="keywordflow">if</span> (lnLine &lt;= -2 || lnLine &gt;= staff-&gt;<a class="code" href="classMs_1_1Staff.html#a1a4d5789b71d29fd2e7c05311638aa7b">lines</a>(tick) * 2) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <span class="comment">// left note has a ledger line we probably need to clear horizontally as well</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        <span class="comment">// except for accidentals that clear the last extended ledger line vertically</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                        <span class="comment">// in these cases, the accidental may tuck closer</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                        <a class="code" href="classMs_1_1Note.html">Note</a>* lastLnNote = lnLine &lt; 0  ? leftNotes[0] : leftNotes[lns - 1];</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        <span class="keywordtype">int</span> lastLnLine = lastLnNote-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                        qreal ledgerY = (lastLnLine / 2) * sp;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        <span class="keywordflow">if</span> (me-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a> &lt; 0 &amp;&amp; ledgerY - me-&gt;<a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a> &lt; ledgerVerticalClear)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                              lnLedgerAdjust = ledgerAdjust;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (me-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a> &gt; 0 &amp;&amp; me-&gt;<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a> - ledgerY &lt; ledgerVerticalClear)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                              lnLedgerAdjust = ledgerAdjust;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                  <span class="comment">// undercut note above if possible</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                  <span class="keywordflow">if</span> (lnBottom - me-&gt;<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a> &lt;= me-&gt;<a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a> - pnd)</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                        lx = qMin(lx, ln-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>() + ln-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>() + lnLedgerAdjust + me-&gt;<a class="code" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">rightClear</a>);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                        lx = qMin(lx, ln-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>() + ln-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>() + lnLedgerAdjust);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                  }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lnTop &gt; me-&gt;<a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a>)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="comment">// clear other accidentals</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="keywordtype">bool</span> conflictAbove = <span class="keyword">false</span>;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordtype">bool</span> conflictBelow = <span class="keyword">false</span>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">if</span> (above)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            conflictAbove = <a class="code" href="namespaceMs.html#ab75fbe8b5bec673d00aa110712b4c887">resolveAccidentals</a>(me, above, lx, pd, sp);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">if</span> (below)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            conflictBelow = <a class="code" href="namespaceMs.html#ab75fbe8b5bec673d00aa110712b4c887">resolveAccidentals</a>(me, below, lx, pd, sp);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">if</span> (conflictAbove || conflictBelow)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            me-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> = lx - acc-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>() - acc-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().x();</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (colOffset != 0.0)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            me-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> = lx - pd - acc-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>() - acc-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().x();</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            me-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> = lx - pnd - acc-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>() - acc-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().x();</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">return</span> QPair&lt;qreal, qreal&gt; (me-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a>, me-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> + me-&gt;<a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">//   layoutChords3</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">//    - calculate positions of notes, accidentals, dots</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a0c223da39c9d643f45912fae4e78f17e">  847</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a0c223da39c9d643f45912fae4e78f17e">Score::layoutChords3</a>(std::vector&lt;Note*&gt;&amp; notes, <span class="keyword">const</span> <a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>, <a class="code" href="classMs_1_1Segment.html">Segment</a>* segment)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="comment">//    layout accidentals</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="comment">//    find column for dots</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      QVector&lt;Note*&gt; leftNotes; <span class="comment">// notes to left of origin</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      leftNotes.reserve(8);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      QVector&lt;AcEl&gt; aclist;       <span class="comment">// accidentals</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      aclist.reserve(8);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="comment">// track columns of octave-separated accidentals</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordtype">int</span> columnBottom[7] = { -1, -1, -1, -1, -1, -1, -1 };</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> <a class="code" href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a>      =  notes.front()-&gt;chord()-&gt;segment()-&gt;tick();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      qreal sp           = staff-&gt;<a class="code" href="classMs_1_1Staff.html#a828f022bce378eb3bdf609c32c44f24d">spatium</a>(tick);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      qreal stepDistance = sp * staff-&gt;<a class="code" href="classMs_1_1Staff.html#a74445d56eed54f6c4d22c5ba301a531f">lineDistance</a>(tick) * .5;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordtype">int</span> stepOffset     = staff-&gt;<a class="code" href="classMs_1_1Staff.html#ad248bef7f25a4fe152ce281372a24d3f">staffType</a>(tick)-&gt;<a class="code" href="classMs_1_1StaffType.html#ae0ffb4991a51dd2715b6a7104f4caca3">stepOffset</a>();</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      qreal lx           = 10000.0;  <span class="comment">// leftmost notehead position</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      qreal upDotPosX    = 0.0;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      qreal downDotPosX  = 0.0;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordtype">int</span> nNotes = int(notes.size());</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordtype">int</span> nAcc = 0;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nNotes-1; i &gt;= 0; --i) {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <a class="code" href="classMs_1_1Note.html">Note</a>* note     = notes[i];</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <a class="code" href="classMs_1_1Accidental.html">Accidental</a>* ac = note-&gt;<a class="code" href="classMs_1_1Note.html#a39025226e9614de8073a91e82dcbb8ee">accidental</a>();</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keywordflow">if</span> (ac &amp;&amp; !note-&gt;<a class="code" href="classMs_1_1Note.html#a4f70ed1ad94787f19a5b90c38df3564e">fixed</a>()) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                  ac-&gt;<a class="code" href="classMs_1_1Accidental.html#a3c4e78a770ad6163c6502551829249d1">layout</a>();</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                  <span class="keywordflow">if</span> (!ac-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>()) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        ac-&gt;<a class="code" href="classMs_1_1Element.html#a2a2ce2358cc23529d8f038a940062e62">setPos</a>(ac-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().x() - ac-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>(), 0.0);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                        <a class="code" href="structMs_1_1AcEl.html">AcEl</a> acel;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">note</a>   = note;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                        <span class="keywordtype">int</span> line    = note-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a>   = line;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a>      = 0.0;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a>    = line * 0.5 * sp + ac-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().top();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a> = line * 0.5 * sp + ac-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().bottom();</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>  = ac-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                        QPointF bboxNE = ac-&gt;<a class="code" href="classMs_1_1Element.html#a70a8140969dcd988ed77e91c27b6a84f">symBbox</a>(ac-&gt;<a class="code" href="classMs_1_1Accidental.html#a6068f72a92f62c8111e9c36b73bdd732">symbol</a>()).topRight();</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                        QPointF bboxSW = ac-&gt;<a class="code" href="classMs_1_1Element.html#a70a8140969dcd988ed77e91c27b6a84f">symBbox</a>(ac-&gt;<a class="code" href="classMs_1_1Accidental.html#a6068f72a92f62c8111e9c36b73bdd732">symbol</a>()).bottomLeft();</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                        QPointF cutOutNE = ac-&gt;<a class="code" href="classMs_1_1Element.html#a984c5f0381896ac71fcf054d056bbe66">symCutOutNE</a>(ac-&gt;<a class="code" href="classMs_1_1Accidental.html#a6068f72a92f62c8111e9c36b73bdd732">symbol</a>());</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                        QPointF cutOutSW = ac-&gt;<a class="code" href="classMs_1_1Element.html#a0cb9e0cf90c74e5b718e10f8a9a796da">symCutOutSW</a>(ac-&gt;<a class="code" href="classMs_1_1Accidental.html#a6068f72a92f62c8111e9c36b73bdd732">symbol</a>());</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                        <span class="keywordflow">if</span> (!cutOutNE.isNull()) {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a>     = cutOutNE.y() - bboxNE.y();</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">rightClear</a> = bboxNE.x() - cutOutNE.x();</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                              }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">ascent</a>     = 0.0;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">rightClear</a> = 0.0;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                              }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                        <span class="keywordflow">if</span> (!cutOutSW.isNull()) {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">descent</a>   = bboxSW.y() - cutOutSW.y();</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">leftClear</a> = cutOutSW.x() - bboxSW.x();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                              }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">descent</a>   = 0.0;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                              acel.<a class="code" href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">leftClear</a> = 0.0;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                              }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                        <span class="keywordtype">int</span> pitchClass = (line + 700) % 7;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        acel.<a class="code" href="structMs_1_1AcEl.html#a567a45827d8c039061ba10ecbccbfe2c">next</a> = columnBottom[pitchClass];</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        columnBottom[pitchClass] = nAcc;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        aclist.append(acel);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        ++nAcc;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                  }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = note-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>();</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keywordtype">bool</span> _up     = chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>();</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Chord.html#a78fab71d6a88f31deb8477d5022dc743">stemSlash</a>())</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                  chord-&gt;<a class="code" href="classMs_1_1Chord.html#a78fab71d6a88f31deb8477d5022dc743">stemSlash</a>()-&gt;<a class="code" href="classMs_1_1StemSlash.html#a37b6ee2aae8b5b24018145923df93d86">layout</a>();</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            qreal overlapMirror;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <a class="code" href="classMs_1_1Stem.html">Stem</a>* <a class="code" href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794ae730db5c29b7ba34f4d465b01bd33c5e">stem</a> = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>();</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordflow">if</span> (stem)</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                  overlapMirror = stem-&gt;<a class="code" href="classMs_1_1Stem.html#aadcbdc10cbafbc7486be0092097fae12">lineWidth</a>();</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>().<a class="code" href="classMs_1_1TDuration.html#aab1a411cf428fcc4244950a88b03ab95">headType</a>() == <a class="code" href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a78a046aa91d9f18cd0b36fe918e74db1">NoteHead::Type::HEAD_WHOLE</a>)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                  overlapMirror = <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea8a31b7c8a80a77c6c9c5aaad9e2e1e68">Sid::stemWidth</a>) * chord-&gt;<a class="code" href="classMs_1_1Chord.html#aa3fcf32f0ec0dec0e4b15bc01b6329ec">mag</a>();</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                  overlapMirror = 0.0;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            qreal x = 0.0;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="keywordflow">if</span> (note-&gt;<a class="code" href="classMs_1_1Note.html#a015e1e0a27a32eef6070e3fc45a682fe">mirror</a>())</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                  <span class="keywordflow">if</span> (_up)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        x = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a660983b43143b9a1aa6d883e39d0fc81">stemPosX</a>() - overlapMirror;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        x = -note-&gt;<a class="code" href="classMs_1_1Note.html#aaa31b11917139c63c6dc4a46f939b95f">headBodyWidth</a>() + overlapMirror;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_up)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                  x = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a660983b43143b9a1aa6d883e39d0fc81">stemPosX</a>() - note-&gt;<a class="code" href="classMs_1_1Note.html#aaa31b11917139c63c6dc4a46f939b95f">headBodyWidth</a>();</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            qreal ny = (note-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() + stepOffset) * stepDistance;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">if</span> (note-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() != ny) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                  note-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() = ny;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                  <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>()) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        chord-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>()-&gt;<a class="code" href="classMs_1_1Stem.html#a7617f445b0e92b8a90862c7f3df1c682">layout</a>();</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                        <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Chord.html#afa6b543d5f66f5e9c6b216bddf9c4afd">hook</a>())</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                              chord-&gt;<a class="code" href="classMs_1_1Chord.html#afa6b543d5f66f5e9c6b216bddf9c4afd">hook</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>()-&gt;<a class="code" href="classMs_1_1Stem.html#a27fb7f82d5ae95bb9e619a90ec4e09aa">hookPos</a>().y();</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                  }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            note-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>()  = x;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="comment">// find leftmost non-mirrored note to set as X origin for accidental layout</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="comment">// a mirrored note that extends to left of segment X origin</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="comment">// will displace accidentals only if there is conflict</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            qreal sx = x + chord-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>(); <span class="comment">// segment-relative X position of note</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">if</span> (note-&gt;<a class="code" href="classMs_1_1Note.html#a015e1e0a27a32eef6070e3fc45a682fe">mirror</a>() &amp;&amp; !chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() &amp;&amp; sx &lt; 0.0)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                  leftNotes.append(note);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sx &lt; lx)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                  lx = sx;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            qreal xx = x + note-&gt;<a class="code" href="classMs_1_1Note.html#aaa31b11917139c63c6dc4a46f939b95f">headBodyWidth</a>() + chord-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().x();</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6">Direction</a> dotPosition = note-&gt;<a class="code" href="classMs_1_1Note.html#ad9eec4888c9aa3acb109163a2b1819a5">userDotPosition</a>();</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>()) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                  <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>())</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        upDotPosX = qMax(upDotPosX, xx);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                        downDotPosX = qMax(downDotPosX, xx);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                        }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                  <span class="keywordflow">if</span> (dotPosition == <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ae1f2d5134ed2543d38a0de9751cf75d9">Direction::AUTO</a> &amp;&amp; nNotes &gt; 1 &amp;&amp; note-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>() &amp;&amp; !note-&gt;<a class="code" href="classMs_1_1Note.html#af0075d4ea77f911abe041be7e7d0762a">dotsHidden</a>()) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        <span class="comment">// resolve dot conflicts</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        <span class="keywordtype">int</span> line = note-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>();</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        <a class="code" href="classMs_1_1Note.html">Note</a>* above = (i &lt; nNotes - 1) ? notes[i+1] : 0;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        <span class="keywordflow">if</span> (above &amp;&amp; (!above-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>() || above-&gt;<a class="code" href="classMs_1_1Note.html#af0075d4ea77f911abe041be7e7d0762a">dotsHidden</a>()))</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                              above = 0;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        <span class="keywordtype">int</span> intervalAbove = above ? line - above-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() : 1000;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        <a class="code" href="classMs_1_1Note.html">Note</a>* below = (i &gt; 0) ? notes[i-1] : 0;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        <span class="keywordflow">if</span> (below &amp;&amp; (!below-&gt;<a class="code" href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">visible</a>() || below-&gt;<a class="code" href="classMs_1_1Note.html#af0075d4ea77f911abe041be7e7d0762a">dotsHidden</a>()))</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                              below = 0;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        <span class="keywordtype">int</span> intervalBelow = below ? below-&gt;<a class="code" href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">line</a>() - line : 1000;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                        <span class="keywordflow">if</span> ((line &amp; 1) == 0) {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                              <span class="comment">// line</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                              <span class="keywordflow">if</span> (intervalAbove == 1 &amp;&amp; intervalBelow != 1)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                    dotPosition = <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ac4e0e4e3118472beeb2ae75827450f1f">Direction::DOWN</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (intervalBelow == 1 &amp;&amp; intervalAbove != 1)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                    dotPosition = <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Direction::UP</a>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (intervalAbove == 0 &amp;&amp; above-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>()) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                    <span class="comment">// unison</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                    <span class="keywordflow">if</span> (((above-&gt;<a class="code" href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">voice</a>() &amp; 1) == (note-&gt;<a class="code" href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">voice</a>() &amp; 1))) {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                          above-&gt;<a class="code" href="classMs_1_1Note.html#aad21335a2a9a90b9d623bbf3d55f747a">setDotY</a>(<a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Direction::UP</a>);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                          dotPosition = <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ac4e0e4e3118472beeb2ae75827450f1f">Direction::DOWN</a>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                          }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                    }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                              }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                              <span class="comment">// space</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                              <span class="keywordflow">if</span> (intervalAbove == 0 &amp;&amp; above-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">dots</a>()) {</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                    <span class="comment">// unison</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                                    <span class="keywordflow">if</span> (!(note-&gt;<a class="code" href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">voice</a>() &amp; 1))</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                          dotPosition = <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Direction::UP</a>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                          <span class="keywordflow">if</span> (!(above-&gt;<a class="code" href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">voice</a>() &amp; 1))</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                                above-&gt;<a class="code" href="classMs_1_1Note.html#aad21335a2a9a90b9d623bbf3d55f747a">setDotY</a>(<a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Direction::UP</a>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                          <span class="keywordflow">else</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                                dotPosition = <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ac4e0e4e3118472beeb2ae75827450f1f">Direction::DOWN</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                          }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                    }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                              }</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                        }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                  }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            note-&gt;<a class="code" href="classMs_1_1Note.html#aad21335a2a9a90b9d623bbf3d55f747a">setDotY</a>(dotPosition);  <span class="comment">// also removes invalid dots</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="comment">// if there are no non-mirrored notes in a downstem chord,</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="comment">// then use the stem X position as X origin for accidental layout</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordflow">if</span> (nNotes &amp;&amp; leftNotes.size() == nNotes)</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            lx = notes.front()-&gt;chord()-&gt;stemPosX();</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">if</span> (segment) {</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="comment">// align all dots for segment/staff</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="comment">// it would be possible to dots for up &amp; down chords separately</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="comment">// this would require space to have been allocated previously</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="comment">// when calculating chord offsets</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            segment-&gt;<a class="code" href="classMs_1_1Segment.html#a3d52cb81e00336d49938b6e43e96ead3">setDotPosX</a>(staff-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>(), qMax(upDotPosX, downDotPosX));</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">if</span> (nAcc == 0)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      QVector&lt;int&gt; umi;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      qreal <a class="code" href="namespaceMs.html#a56be22d124547a688e971dcfc73752ff">pd</a>  = <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaf2681fbbf073a3545d84861314e6f9d3">Sid::accidentalDistance</a>);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      qreal pnd = <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eac8e280960e5fa9a7f502d66719e60005">Sid::accidentalNoteDistance</a>);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      qreal colOffset = 0.0;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">if</span> (nAcc &gt;= 2 &amp;&amp; aclist[nAcc-1].line - aclist[0].line &gt;= 7) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="comment">// accidentals spread over an octave or more</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="comment">// set up columns for accidentals with octave matches</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <span class="comment">// these will start at right and work to the left</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="comment">// unmatched accidentals will use zig zag approach (see below)</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="comment">// starting to the left of the octave columns</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <span class="keywordtype">int</span> columnTop[7] = { -1, -1, -1, -1, -1, -1, -1 };</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="comment">// find columns of octaves</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pc = 0; pc &lt; 7; ++pc) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                  <span class="keywordflow">if</span> (columnBottom[pc] == -1)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                  <span class="comment">// calculate column height</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = columnBottom[pc]; j != -1; j = aclist[j].next)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        columnTop[pc] = j;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                  }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="comment">// compute reasonable column order</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="comment">// use zig zag</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            QVector&lt;int&gt; column;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            QVector&lt;int&gt; unmatched;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <span class="keywordtype">int</span> n = nAcc - 1;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= n; ++i, --n) {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                  <span class="keywordtype">int</span> pc = (aclist[i].line + 700) % 7;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                  <span class="keywordflow">if</span> (aclist[columnTop[pc]].line != aclist[columnBottom[pc]].line) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        <span class="keywordflow">if</span> (!column.contains(pc))</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                              column.append(pc);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                        unmatched.append(i);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                  <span class="keywordflow">if</span> (i == n)</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                  pc = (aclist[n].line + 700) % 7;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                  <span class="keywordflow">if</span> (aclist[columnTop[pc]].line != aclist[columnBottom[pc]].line) {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                        <span class="keywordflow">if</span> (!column.contains(pc))</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                              column.append(pc);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                        }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                        unmatched.append(n);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                  }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            <span class="keywordtype">int</span> nColumns = column.size();</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <span class="keywordtype">int</span> nUnmatched = unmatched.size();</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="comment">// handle unmatched accidentals</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nUnmatched; ++i) {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                  <span class="comment">// first try to slot it into an existing column</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                  <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* me = &amp;aclist[unmatched[i]];</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                  <span class="comment">// find column</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nColumns; ++j) {</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                        <span class="keywordtype">int</span> pc = column[j];</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        <span class="keywordtype">int</span> above = -1;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        <span class="keywordtype">int</span> below = -1;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        <span class="comment">// find slot within column</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = columnBottom[pc]; k != -1; k = aclist[k].next) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                              <span class="keywordflow">if</span> (aclist[k].line &lt; me-&gt;line) {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                    above = k;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                    }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                              below = k;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                              }</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                        <span class="comment">// check to see if accidental can fit in slot</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                        qreal myPd = pd * me-&gt;<a class="code" href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">note</a>-&gt;<a class="code" href="classMs_1_1Note.html#a39025226e9614de8073a91e82dcbb8ee">accidental</a>()-&gt;<a class="code" href="classMs_1_1Element.html#ad01cda9f6017d09c9fb9305de18e9310">mag</a>();</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                        <span class="keywordtype">bool</span> conflict = <span class="keyword">false</span>;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                        <span class="keywordflow">if</span> (above != -1 &amp;&amp; me-&gt;<a class="code" href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">top</a> - aclist[above].bottom &lt; myPd)</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                              conflict = <span class="keyword">true</span>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (below != -1 &amp;&amp; aclist[below].top - me-&gt;<a class="code" href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">bottom</a> &lt; myPd)</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                              conflict = <span class="keyword">true</span>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                        <span class="keywordflow">if</span> (!conflict) {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                              <span class="comment">// insert into column</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                              found = <span class="keyword">true</span>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                              me-&gt;<a class="code" href="structMs_1_1AcEl.html#a567a45827d8c039061ba10ecbccbfe2c">next</a> = above;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                              <span class="keywordflow">if</span> (above == -1)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                    columnTop[pc] = unmatched[i];</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                              <span class="keywordflow">if</span> (below != -1)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                    aclist[below].next = unmatched[i];</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                    columnBottom[pc] = unmatched[i];</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                              }</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                        }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                  <span class="comment">// if no slot found, then add to list of unmatched accidental indices</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                  <span class="keywordflow">if</span> (!found)</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                        umi.push_back(unmatched[i]);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                  }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            nAcc = umi.size();</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="keywordflow">if</span> (nAcc &gt; 1)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                  <a class="code" href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">std::sort</a>(umi.begin(), umi.end());</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keywordtype">bool</span> alignLeft = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea6198654de2e6d8b98dd935d960ffd154">Sid::alignAccidentalsLeft</a>);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="comment">// through columns</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nColumns; ++i) {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                  <span class="comment">// column index</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> pc = column[i];</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                  qreal minX = 0.0;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                  qreal maxX = 0.0;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                  <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* below = 0;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                  <span class="comment">// through accidentals in this column</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = columnBottom[pc]; j != -1; j = aclist[j].next) {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                        QPair&lt;qreal, qreal&gt; x = <a class="code" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">layoutAccidental</a>(&amp;aclist[j], 0, below, colOffset, leftNotes, pnd, pd, sp);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                        minX = qMin(minX, x.first);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                        maxX = qMin(maxX, x.second);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                        below = &amp;aclist[j];</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                        }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                  <span class="comment">// align</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                  <span class="keywordtype">int</span> next = -1;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = columnBottom[pc]; j != -1; j = next) {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* current = &amp;aclist[j];</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        next = current-&gt;<a class="code" href="structMs_1_1AcEl.html#a567a45827d8c039061ba10ecbccbfe2c">next</a>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        <span class="keywordflow">if</span> (next != -1 &amp;&amp; current-&gt;<a class="code" href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">line</a> == aclist[next].line)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                        <span class="keywordflow">if</span> (alignLeft)</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                current-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> = minX;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                              current-&gt;<a class="code" href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">x</a> = maxX - current-&gt;<a class="code" href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">width</a>;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                  colOffset = minX;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                  }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nAcc; ++i)</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                  umi.push_back(i);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">if</span> (nAcc) {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="comment">// for accidentals with no octave matches, use zig zag approach</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <span class="comment">// layout right to left in pairs, (next) highest then lowest</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* me = &amp;aclist[umi[0]];</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* above = 0;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <a class="code" href="structMs_1_1AcEl.html">AcEl</a>* below = 0;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="comment">// layout top accidental</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <a class="code" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">layoutAccidental</a>(me, above, below, colOffset, leftNotes, pnd, pd, sp);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <span class="comment">// layout bottom accidental</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordtype">int</span> n = nAcc - 1;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <span class="keywordflow">if</span> (n &gt; 0) {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                  above = me;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                  me = &amp;aclist[umi[n]];</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                  <a class="code" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">layoutAccidental</a>(me, above, below, colOffset, leftNotes, pnd, pd, sp);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                  }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <span class="comment">// layout middle accidentals</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="keywordflow">if</span> (n &gt; 1) {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; n; ++i, --n) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                        <span class="comment">// next highest</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                        below = me;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        me = &amp;aclist[umi[i]];</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                        <a class="code" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">layoutAccidental</a>(me, above, below, colOffset, leftNotes, pnd, pd, sp);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        <span class="keywordflow">if</span> (i == n - 1)</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                        <span class="comment">// next lowest</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        above = me;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                        me = &amp;aclist[umi[n-1]];</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                        <a class="code" href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">layoutAccidental</a>(me, above, below, colOffset, leftNotes, pnd, pd, sp);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                        }</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                  }</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="structMs_1_1AcEl.html">AcEl</a>&amp; e : qAsConst(aclist)) {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <span class="comment">// even though we initially calculate accidental position relative to segment</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            <span class="comment">// we must record pos for accidental relative to note,</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="comment">// since pos is always interpreted relative to parent</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <a class="code" href="classMs_1_1Note.html">Note</a>* note = e.note;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            qreal x    = e.<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a> + lx - (note-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>() + note-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">x</a>());</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            note-&gt;<a class="code" href="classMs_1_1Note.html#a39025226e9614de8073a91e82dcbb8ee">accidental</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a2a2ce2358cc23529d8f038a940062e62">setPos</a>(x, 0);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            }</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"><a class="line" href="layout_8cpp.html#ac9c2a6b16ac8e14d25a6387217db3507"> 1215</a></span>&#160;<span class="preprocessor">#define beamModeMid(a) (a == Beam::Mode::MID || a == Beam::Mode::BEGIN32 || a == Beam::Mode::BEGIN64)</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"><a class="line" href="namespaceMs.html#afa6870c3c1f6f75078e098386e4a6bdf"> 1217</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#afa6870c3c1f6f75078e098386e4a6bdf">beamNoContinue</a>(<a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fe">Beam::Mode</a> mode)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="keywordflow">return</span> mode == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab1a326c06d88bf042f73d70f50197905">Beam::Mode::END</a> || mode == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693">Beam::Mode::NONE</a> || mode == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feaccc0377a8afbf50e7094f5c23a8af223">Beam::Mode::INVALID</a>;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">//   beamGraceNotes</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a38ee585135744839b5ac1eb26f0da0f5"> 1226</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a38ee585135744839b5ac1eb26f0da0f5">Score::beamGraceNotes</a>(<a class="code" href="classMs_1_1Chord.html">Chord</a>* mainNote, <span class="keywordtype">bool</span> after)</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      {</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* a1    = 0;      <span class="comment">// start of (potential) beam</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="classMs_1_1Beam.html">Beam</a>* beam       = 0;      <span class="comment">// current beam</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fe">Beam::Mode</a> bm = <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feae1f2d5134ed2543d38a0de9751cf75d9">Beam::Mode::AUTO</a>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      QVector&lt;Chord*&gt; graceNotes = after ? mainNote-&gt;<a class="code" href="classMs_1_1Chord.html#afe552a986cb79260a7776bce05bdb6ff">graceNotesAfter</a>() : mainNote-&gt;<a class="code" href="classMs_1_1Chord.html#a136eb39ecfa4096dc41df49e135a5ce7">graceNotesBefore</a>();</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr : qAsConst(graceNotes)) {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            bm = <a class="code" href="classMs_1_1Groups.html#a941048b9a1849553fefa03c781b06c65">Groups::endBeam</a>(cr);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="keywordflow">if</span> ((cr-&gt;durationType().type() &lt;= <a class="code" href="classMs_1_1TDuration.html#ad9263bf173856b77421e83a48a7bf68ca05e8f1c139e16d278117c17e7fc13ef6">TDuration::DurationType::V_QUARTER</a>) || (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693">Beam::Mode::NONE</a>)) {</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                  <span class="keywordflow">if</span> (beam) {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                        beam-&gt;<a class="code" href="classMs_1_1Beam.html#a7952d1966f3d3b451d8d796a6958a5c3">layoutGraceNotes</a>();</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                        beam = 0;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                        }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                  <span class="keywordflow">if</span> (a1) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                        a1 = 0;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                        }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                  cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                  }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keywordflow">if</span> (beam) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                  <span class="keywordtype">bool</span> beamEnd = bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea19aad9f2fe3ce0023298ab83f7e75775">Beam::Mode::BEGIN</a>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                  <span class="keywordflow">if</span> (!beamEnd) {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                        cr-&gt;replaceBeam(beam);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                        cr = 0;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                        beamEnd = (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab1a326c06d88bf042f73d70f50197905">Beam::Mode::END</a>);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                        }</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                  <span class="keywordflow">if</span> (beamEnd) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                        beam-&gt;<a class="code" href="classMs_1_1Beam.html#a7952d1966f3d3b451d8d796a6958a5c3">layoutGraceNotes</a>();</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                        beam = 0;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                        }</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                  }</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="keywordflow">if</span> (!cr)</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordflow">if</span> (a1 == 0)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                  a1 = cr;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="layout_8cpp.html#ac9c2a6b16ac8e14d25a6387217db3507">beamModeMid</a>(bm) &amp;&amp; (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea19aad9f2fe3ce0023298ab83f7e75775">Beam::Mode::BEGIN</a>)) {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                        a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                        a1 = cr;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                        }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                        beam = a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                        <span class="keywordflow">if</span> (beam == 0 || beam-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().front() != a1) {</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                              beam = <span class="keyword">new</span> <a class="code" href="classMs_1_1Beam.html">Beam</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                              beam-&gt;<a class="code" href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">setGenerated</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                              beam-&gt;<a class="code" href="classMs_1_1Element.html#a884bf81982c8c302cbdf79ea567c3ced">setTrack</a>(mainNote-&gt;<a class="code" href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">track</a>());</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                              a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a688dc7a975a470846cf6ca71d2628af9">replaceBeam</a>(beam);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                              }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                        cr-&gt;replaceBeam(beam);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                        a1 = 0;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                        }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                  }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keywordflow">if</span> (beam)</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            beam-&gt;<a class="code" href="classMs_1_1Beam.html#a7952d1966f3d3b451d8d796a6958a5c3">layoutGraceNotes</a>();</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a1)</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor">#if 0 // unused</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">//   layoutSpanner</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">//    called after dragging a staff</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="keywordtype">void</span> Score::layoutSpanner()</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      {</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="keywordtype">int</span> tracks = <a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a>();</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = 0; track &lt; tracks; ++track) {</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* segment = <a class="code" href="classMs_1_1Score.html#aeb1a034f75cd5b9e6ba3cf3af695ad19">firstSegment</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ab1c94ca2fbc3e78fc30069c8d0f01680">SegmentType::All</a>); segment; segment = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a8c27ddfb0004417dd89b655e3480a6a0">next1</a>()) {</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                  <span class="keywordflow">if</span> (track == tracks-1) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                        <span class="keywordtype">size_t</span> n = segment-&gt;annotations().size();</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i)</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                              segment-&gt;annotations().at(i)-&gt;layout();</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                        }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* e = segment-&gt;element(track);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                  <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isChord()) {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                        <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(segment-&gt;element(track));</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                        c-&gt;<a class="code" href="classMs_1_1Chord.html#a8a5728af14a2e7b599dabe6df851858d">layoutStem</a>();</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Note.html">Note</a>* n : c-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>()) {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                              <a class="code" href="classMs_1_1Tie.html">Tie</a>* tie = n-&gt;tieFor();</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                              <span class="keywordflow">if</span> (tie)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                    tie-&gt;<a class="code" href="classMs_1_1Element.html#a3ae68f5da280c53fd1d329f20601818b">layout</a>();</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                              <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Spanner.html">Spanner</a>* sp : n-&gt;spannerFor())</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                    sp-&gt;layout();</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                              }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                        }</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                  }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            }</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <a class="code" href="classMs_1_1Score.html#a42043d12f931f0597ede4c070cafe75a">rebuildBspTree</a>();</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      }</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">//   hideEmptyStaves</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#aeb406ae3e71511fd168057f3f5b22bb9"> 1325</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#aeb406ae3e71511fd168057f3f5b22bb9">Score::hideEmptyStaves</a>(<a class="code" href="classMs_1_1System.html">System</a>* system, <span class="keywordtype">bool</span> isFirstSystem)</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aaa9eed88d78a41f6cef322c1e3b663a8">staves</a>   = <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.size();</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordtype">bool</span> systemIsEmpty = <span class="keyword">true</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> : qAsConst(<a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>)) {</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* ss  = system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(staffIdx);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <a class="code" href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98">Staff::HideMode</a> hideMode = <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#a6e52d003f76686f0e20bb7843558cfab">hideWhenEmpty</a>();</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="keywordflow">if</span> (hideMode == <a class="code" href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98af3fc827ade4b968e50406496907ef962">Staff::HideMode::ALWAYS</a></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                || (<a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eae2fec131897c443768056e19b2fe6899">Sid::hideEmptyStaves</a>)</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                    &amp;&amp; (staves &gt; 1)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                    &amp;&amp; !(isFirstSystem &amp;&amp; <a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead544010bf5b65ef3708e600ed4585df6">Sid::dontHideStavesInFirstSystem</a>))</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    &amp;&amp; hideMode != <a class="code" href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98a443475558f0168dff92ecde26b98ae5a">Staff::HideMode::NEVER</a>)) {</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                  <span class="keywordtype">bool</span> hideStaff = <span class="keyword">true</span>;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* m : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        <span class="keywordflow">if</span> (!m-&gt;isMeasure())</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a> = toMeasure(m);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        <span class="keywordflow">if</span> (!measure-&gt;<a class="code" href="classMs_1_1Measure.html#aa8955b92304c0f9e719c99cd1302db78">isEmpty</a>(staffIdx)) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                              hideStaff = <span class="keyword">false</span>;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                              }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                        }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                  <span class="comment">// check if notes moved into this staff</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                  <a class="code" href="classMs_1_1Part.html">Part</a>* part = <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#ae31dc0de799c1e206af979e65bf837ab">part</a>();</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                  <span class="keywordtype">int</span> n = part-&gt;<a class="code" href="classMs_1_1Part.html#ac0d6f1ee40e54d54510e2c2b56a7ec5c">nstaves</a>();</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                  <span class="keywordflow">if</span> (hideStaff &amp;&amp; (n &gt; 1)) {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                        <span class="keywordtype">int</span> idx = part-&gt;<a class="code" href="classMs_1_1Part.html#aa11473b705e1917640e87bba141cdee4">staves</a>()-&gt;front()-&gt;idx();</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; part-&gt;<a class="code" href="classMs_1_1Part.html#ac0d6f1ee40e54d54510e2c2b56a7ec5c">nstaves</a>(); ++i) {</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                              <span class="keywordtype">int</span> st = idx + i;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                              <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                    <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                    <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#a6e52d003f76686f0e20bb7843558cfab">hideWhenEmpty</a>() == <a class="code" href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98ae54be9a95671f32cb40effb470d6c188">Staff::HideMode::INSTRUMENT</a> &amp;&amp; !m-&gt;<a class="code" href="classMs_1_1Measure.html#aa8955b92304c0f9e719c99cd1302db78">isEmpty</a>(st)) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                          hideStaff = <span class="keyword">false</span>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                          }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>)) {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                                <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s-&gt;cr(st * VOICES + voice);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                                <span class="keywordflow">if</span> (cr == 0 || cr-&gt;isRest())</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                                      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                                <span class="keywordtype">int</span> staffMove = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>();</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                                <span class="keywordflow">if</span> (staffIdx == st + staffMove) {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                                      hideStaff = <span class="keyword">false</span>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                                      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                                      }</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                                }</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                          }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                    <span class="keywordflow">if</span> (!hideStaff)</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                    }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                              <span class="keywordflow">if</span> (!hideStaff)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                              }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                        }</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                  ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a57e339125410bd2815b37f3a294e3ea0">setShow</a>(hideStaff ? <span class="keyword">false</span> : <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>());</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                  <span class="keywordflow">if</span> (ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a15edb8450b4cbf7ec4c20591804def65">show</a>())</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        systemIsEmpty = <span class="keyword">false</span>;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                  }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>()) {</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                  <span class="comment">// TODO: OK to check this first and not bother with checking if empty?</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                  ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a57e339125410bd2815b37f3a294e3ea0">setShow</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                  }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                  systemIsEmpty = <span class="keyword">false</span>;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                  ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a57e339125410bd2815b37f3a294e3ea0">setShow</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                  }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            }</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <a class="code" href="classMs_1_1Staff.html">Staff</a>* firstVisible = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> (systemIsEmpty) {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> : qAsConst(<a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>)) {</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                  <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* ss  = system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>());</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#acde5406d19a2a8eb5d61d3557f449e58">showIfEmpty</a>() &amp;&amp; !ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a15edb8450b4cbf7ec4c20591804def65">show</a>()) {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                        ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a57e339125410bd2815b37f3a294e3ea0">setShow</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        systemIsEmpty = <span class="keyword">false</span>;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                        }</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!firstVisible &amp;&amp; <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>()) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                        firstVisible = <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                        }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                  }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="comment">// don’t allow a complete empty system</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">if</span> (systemIsEmpty) {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> = firstVisible ? firstVisible : <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.front();</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* ss = system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(staff-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>());</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a57e339125410bd2815b37f3a294e3ea0">setShow</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            }</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      }</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">//   connectTies</span><span class="comment"></span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">///   Rebuild tie connections.</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment"></span><span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#ae50d0b620dca99b269dea62ddcf71f5a"> 1427</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#ae50d0b620dca99b269dea62ddcf71f5a">Score::connectTies</a>(<span class="keywordtype">bool</span> silent)</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordtype">int</span> tracks = <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>() * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = <a class="code" href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">firstMeasure</a>();</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">if</span> (!m)</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894">SegmentType</a> st = <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(st); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a8c27ddfb0004417dd89b655e3480a6a0">next1</a>(st)) {</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; tracks; ++i) {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* e = s-&gt;element(i);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                  <span class="keywordflow">if</span> (e == 0 || !e-&gt;isChord())</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                  <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(e);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Note.html">Note</a>* n : c-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>()) {</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                        <span class="comment">// connect a tie without end note</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                        <a class="code" href="classMs_1_1Tie.html">Tie</a>* tie = n-&gt;tieFor();</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                        <span class="keywordflow">if</span> (tie &amp;&amp; !tie-&gt;<a class="code" href="classMs_1_1Tie.html#a9719252bb8e38b88324bdd19ca07f13d">endNote</a>()) {</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                              <a class="code" href="classMs_1_1Note.html">Note</a>* nnote;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                              <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#ac02bb72ce68df75fc38ee2c1222de735">_mscVersion</a> &lt;= 114)</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                    nnote = <a class="code" href="namespaceMs.html#a53c7362a3d7031429624621b2753b8cf">searchTieNote114</a>(n);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                                    nnote = <a class="code" href="namespaceMs.html#a7efd77a58797a375f3d6d631e51b204e">searchTieNote</a>(n);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                              <span class="keywordflow">if</span> (nnote == 0) {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                    <span class="keywordflow">if</span> (!silent) {</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                          qDebug(<span class="stringliteral">&quot;next note at %d track %d for tie not found (version %d)&quot;</span>, s-&gt;tick().ticks(), i, <a class="code" href="classMs_1_1Score.html#ac02bb72ce68df75fc38ee2c1222de735">_mscVersion</a>);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                          <span class="keyword">delete</span> tie;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                                          n-&gt;setTieFor(0);</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                                          }</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                    }</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                              <span class="keywordflow">else</span> {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                    tie-&gt;<a class="code" href="classMs_1_1Tie.html#a10612faf2ce6ddf3be9f99970df069b8">setEndNote</a>(nnote);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                    nnote-&gt;<a class="code" href="classMs_1_1Note.html#a9bdc2e024e29b58a2a25678a957782d5">setTieBack</a>(tie);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                    }</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                              }</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                        <span class="comment">// connect a glissando without initial note (old glissando format)</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Spanner.html">Spanner</a>* <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a> : n-&gt;spannerBack()) {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                              <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;isGlissando() &amp;&amp; !<a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;startElement()) {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                    <a class="code" href="classMs_1_1Note.html">Note</a>* initialNote = <a class="code" href="classMs_1_1Glissando.html#a19066d9818980d4177b724e54df62047">Glissando::guessInitialNote</a>(n-&gt;chord());</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                    n-&gt;<a class="code" href="classMs_1_1Note.html#a97575ef0255cb4b9cde48b6c8730a00f">removeSpannerBack</a>(<a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                    <span class="keywordflow">if</span> (initialNote) {</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setStartElement(initialNote);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setEndElement(n);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setTick(initialNote-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>());</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setTick2(n-&gt;chord()-&gt;tick());</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setTrack(n-&gt;track());</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setTrack2(n-&gt;track());</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                          <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;setParent(initialNote);</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                          initialNote-&gt;<a class="code" href="classMs_1_1Note.html#a62c2aead455c3d63ec9466b945c6fb5a">add</a>(<a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                          }</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                          <span class="keyword">delete</span> <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                          }</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                    }</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                              }</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        <span class="comment">// spanner with no end element can happen during copy/paste</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Spanner.html">Spanner</a>* <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a> : n-&gt;spannerFor()) {</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                              <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>-&gt;endElement() == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                    n-&gt;removeSpannerFor(<a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                    <span class="keyword">delete</span> <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                                    }</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                              }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        }</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="preprocessor">#if 0    // chords are set in tremolo-&gt;layout()</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                  <span class="comment">// connect two note tremolos</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                  <a class="code" href="classMs_1_1Tremolo.html">Tremolo</a>* tremolo = c-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>();</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                  <span class="keywordflow">if</span> (tremolo &amp;&amp; tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#a7e98943cb86fb69bc5e59024f3d880fd">twoNotes</a>() &amp;&amp; !tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">chord2</a>()) {</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* ls = s-&gt;<a class="code" href="classMs_1_1Segment.html#a8c27ddfb0004417dd89b655e3480a6a0">next1</a>(st); ls; ls = ls-&gt;<a class="code" href="classMs_1_1Segment.html#a8c27ddfb0004417dd89b655e3480a6a0">next1</a>(st)) {</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                              <a class="code" href="classMs_1_1Element.html">Element</a>* element = ls-&gt;element(i);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                              <span class="keywordflow">if</span> (!element)</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                              <span class="keywordflow">if</span> (!element-&gt;isChord())</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                    qDebug(<span class="stringliteral">&quot;cannot connect tremolo&quot;</span>);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                              <span class="keywordflow">else</span> {</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                    <a class="code" href="classMs_1_1Chord.html">Chord</a>* nc = toChord(element);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                                    nc-&gt;<a class="code" href="classMs_1_1Chord.html#a86bcbc446dea8eeec80bd81505fd77bd">setTremolo</a>(tremolo);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                                    tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#ae23f822657ab2477a8ad0d203e44569f">setChords</a>(c, nc);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                    <span class="comment">// cross-measure tremolos are not supported</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                    <span class="comment">// but can accidentally result from copy &amp; paste</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                    <span class="comment">// remove them now</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="classMs_1_1Chord.html#a002bfeb279e714adaff047d623de3fa8">measure</a>() != nc-&gt;<a class="code" href="classMs_1_1Chord.html#a002bfeb279e714adaff047d623de3fa8">measure</a>())</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                          c-&gt;<a class="code" href="classMs_1_1Chord.html#a68b1fd6dd0a9d1bb28c7746b37bd8157">remove</a>(tremolo);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                    }</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                              }</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                        }</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                  }</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            }</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      }</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">//   checkDivider</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"><a class="line" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a"> 1522</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keywordtype">bool</span> left, <a class="code" href="classMs_1_1System.html">System</a>* s, qreal yOffset, <span class="keywordtype">bool</span> <span class="keyword">remove</span> = <span class="keyword">false</span>)</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <a class="code" href="classMs_1_1SystemDivider.html">SystemDivider</a>* divider = left ? s-&gt;<a class="code" href="classMs_1_1System.html#a5cb93da114779e0e9811e2e6d9322e2e">systemDividerLeft</a>() : s-&gt;<a class="code" href="classMs_1_1System.html#af04d55563537c07d6b993edbf897f5fd">systemDividerRight</a>();</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(left ? <a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaefa10f531820c21c466b58288845a875">Sid::dividerLeft</a> : <a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea427a6835629e8b670545ded6a98c68d7">Sid::dividerRight</a>)) &amp;&amp; !<span class="keyword">remove</span>) {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            <span class="keywordflow">if</span> (!divider) {</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                  divider = <span class="keyword">new</span> <a class="code" href="classMs_1_1SystemDivider.html">SystemDivider</a>(s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>());</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1SystemDivider.html#a6b9161958a162319d850b16050e12995">setDividerType</a>(left ? SystemDivider::Type::LEFT : SystemDivider::Type::RIGHT);</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">setGenerated</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                  s-&gt;<a class="code" href="classMs_1_1System.html#a38215a755206cfd574aab3986d59a11c">add</a>(divider);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                  }</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            divider-&gt;<a class="code" href="classMs_1_1SystemDivider.html#a00847d5bb01faa5657fca4d4d87dedf8">layout</a>();</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            divider-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() = divider-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>() * .5 + yOffset;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="keywordflow">if</span> (left) {</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() += s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaefbbb63ca3f542327e2160efc22f0427">Sid::dividerLeftY</a>) * <a class="code" href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">SPATIUM20</a>;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() =  s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea418582c858ff61bb5f4855690b7abf0d">Sid::dividerLeftX</a>) * <a class="code" href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">SPATIUM20</a>;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                  }</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() += s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaae705a92c3920c285df68ebcc0a5fbbf">Sid::dividerRightY</a>) * <a class="code" href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">SPATIUM20</a>;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() =  s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead80edba277a8f1ab117e9c42036187c8">Sid::pagePrintableWidth</a>) * <a class="code" href="namespaceMs.html#ab7904232a877db2441531871cf3f5108">DPI</a> - divider-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                  divider-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea03d7b999cbb700ae7ae5a55141d76384">Sid::dividerRightX</a>) * <a class="code" href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">SPATIUM20</a>;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                  }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            }</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (divider) {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <span class="keywordflow">if</span> (divider-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>()) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                  s-&gt;<a class="code" href="classMs_1_1System.html#aaf529665602c113a229f81e888bdf06f">remove</a>(divider);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                  <span class="keyword">delete</span> divider;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                  }</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                  s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a365e5013395d4a660672ad8fff61a864">undoRemoveElement</a>(divider);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            }</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      }</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">//   almostZero</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"><a class="line" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71"> 1558</a></span>&#160;<span class="keywordtype">bool</span> <span class="keyword">inline</span> <a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(qreal value)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      {</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="comment">// 1e-3 is close enough to zero to see it as zero.</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">return</span> value &gt; -1e-3 &amp;&amp; value &lt; 1e-3;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">//   distributeStaves</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"><a class="line" href="namespaceMs.html#a299f1a25ba7157c59bcfb113649dbd05"> 1568</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a299f1a25ba7157c59bcfb113649dbd05">distributeStaves</a>(<a class="code" href="classMs_1_1Page.html">Page</a>* page)</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      {</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <a class="code" href="classMs_1_1Score.html">Score</a>* <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a> { page-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>() };</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <a class="code" href="classMs_1_1VerticalGapDataList.html">VerticalGapDataList</a> vgdl;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <span class="comment">// Find and classify all gaps between staves.</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="keywordtype">int</span>    ngaps { 0 };</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      qreal  prevYBottom  { page-&gt;<a class="code" href="classMs_1_1Page.html#a27cbb69c1c1cdbe3f3a51f00283f465b">tm</a>() };</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      qreal  yBottom      { 0.0        };</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordtype">bool</span>   vbox         { <span class="keyword">false</span>      };</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <a class="code" href="classMs_1_1Spacer.html">Spacer</a>* activeSpacer { <span class="keyword">nullptr</span>    };</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="keywordtype">bool</span> transferNormalBracket { <span class="keyword">false</span> };</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordtype">bool</span> transferCurlyBracket  { <span class="keyword">false</span> };</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1System.html">System</a>* system : page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>()) {</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            <span class="keywordflow">if</span> (system-&gt;vbox()) {</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                  <a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd = <span class="keyword">new</span> <a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>(!ngaps++, system, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, prevYBottom);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                  vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a429b1f1b6240aec75c46b7aab08c8b1f">addSpaceAroundVBox</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                  prevYBottom = system-&gt;y();</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                  yBottom     = system-&gt;y() + system-&gt;height();</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                  vbox        = <span class="keyword">true</span>;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                  vgdl.append(vgd);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                  transferNormalBracket = <span class="keyword">false</span>;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                  transferCurlyBracket  = <span class="keyword">false</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                  }</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                  <span class="keywordtype">bool</span> newSystem       { <span class="keyword">true</span> };</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                  <span class="keywordtype">bool</span> addSpaceAroundNormalBracket { <span class="keyword">false</span> };</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                  <span class="keywordtype">bool</span> addSpaceAroundCurlyBracket  { <span class="keyword">false</span> };</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                  <span class="keywordtype">int</span> endNormalBracket { -1   };</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                  <span class="keywordtype">int</span> endCurlyBracket  { -1   };</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                  <span class="keywordtype">int</span> staffNr { -1 };</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* sysStaff : *system-&gt;staves()) {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                        <a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> { <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(++staffNr)};</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                        addSpaceAroundNormalBracket |= endNormalBracket == staffNr;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                        addSpaceAroundCurlyBracket  |= endCurlyBracket == staffNr;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1BracketItem.html">BracketItem</a>* bi : <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#a0ab58cc207efdeaedf1de006cd22d03d">brackets</a>()) {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                              <span class="keywordflow">if</span>  (bi-&gt;bracketType() == <a class="code" href="namespaceMs.html#a4c0a2128d0477020d4faf110cc01e3aba1e23852820b9154316c7c06e2b7ba051">BracketType::NORMAL</a>) {</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                                    addSpaceAroundNormalBracket |= <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>() &gt; (endNormalBracket - 1);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                                    endNormalBracket = qMax(endNormalBracket, <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>() + bi-&gt;bracketSpan());</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                    }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                              <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bi-&gt;bracketType() == <a class="code" href="namespaceMs.html#ad645340ae3d26d22eb29ecc4395824a0aa978f79663129bdb1ab765185b15a9b2">BracketType::BRACE</a>) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                                    addSpaceAroundCurlyBracket |= <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>() &gt; (endCurlyBracket - 1);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                    endCurlyBracket = qMax(endCurlyBracket, <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>-&gt;<a class="code" href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">idx</a>() + bi-&gt;bracketSpan());</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                    }</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                              }</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                        <span class="keywordflow">if</span> (!sysStaff-&gt;show())</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                        <a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd = <span class="keyword">new</span> <a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>(!ngaps++, system, <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>, sysStaff, activeSpacer, prevYBottom);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                        activeSpacer = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                        <span class="keywordflow">if</span> (newSystem) {</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                              vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a7a6a0cffa1ec2e82a7ae63937688e97f">addSpaceBetweenSections</a>();</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                              newSystem = <span class="keyword">false</span>;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                              }</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                        <span class="keywordflow">if</span> (addSpaceAroundNormalBracket || transferNormalBracket) {</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                              vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a7dd8ea76bec4d8ff3103b7bd9b441596">addSpaceAroundNormalBracket</a>();</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                              addSpaceAroundNormalBracket = <span class="keyword">false</span>;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                              transferNormalBracket = <span class="keyword">false</span>;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                              }</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                        <span class="keywordflow">if</span> (addSpaceAroundCurlyBracket || transferCurlyBracket) {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                              vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a2504e5f861dd1f31323c9da26a3234c8">addSpaceAroundCurlyBracket</a>();</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                              addSpaceAroundCurlyBracket = <span class="keyword">false</span>;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                              transferCurlyBracket = <span class="keyword">false</span>;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                              }</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (staffNr &lt; endCurlyBracket) {</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                              vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#aa4067fe8548ee70fb5f9a8e09bdd8c7f">insideCurlyBracket</a>();</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                              }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                        <span class="keywordflow">if</span> (vbox) {</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                              vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a429b1f1b6240aec75c46b7aab08c8b1f">addSpaceAroundVBox</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                              vbox = <span class="keyword">false</span>;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                              }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                        prevYBottom = system-&gt;y() + sysStaff-&gt;y() + sysStaff-&gt;bbox().height();</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                        yBottom     = system-&gt;y() + sysStaff-&gt;y() + sysStaff-&gt;skyline().south().max();</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                        vgdl.append(vgd);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                        }</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                  transferNormalBracket = endNormalBracket &gt;= 0;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                  transferCurlyBracket  = endCurlyBracket &gt;= 0;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                  }</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            activeSpacer = system-&gt;getActiveSpacer();</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      --ngaps;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      qreal spaceLeft { page-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>() - page-&gt;<a class="code" href="classMs_1_1Page.html#a7e188c4049e98cb251340317bedeb1c0">bm</a>() - <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea8840c6da2e66f5ee18c4b1aa2c354fd1">Sid::staffLowerBorder</a>) - yBottom };</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="keywordflow">if</span> (activeSpacer)</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          spaceLeft -= activeSpacer-&gt;gap();</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      <span class="keywordflow">if</span> (spaceLeft &lt;= 0.0)</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="comment">// Try to make the gaps equal, taking the spread factors and maximum spacing into account.</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> maxPasses { 20 };   <span class="comment">// Saveguard to prevent endless loops.</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="keywordtype">int</span> pass { 0 };</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(spaceLeft) &amp;&amp; (ngaps &gt; 0) &amp;&amp; (++pass &lt; maxPasses)) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            ngaps = 0;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            qreal smallest     { vgdl.<a class="code" href="classMs_1_1VerticalGapDataList.html#a1a7300a0d3832784cf4b478d6f65bbe2">smallest</a>()         };</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            qreal nextSmallest { vgdl.<a class="code" href="classMs_1_1VerticalGapDataList.html#a1a7300a0d3832784cf4b478d6f65bbe2">smallest</a>(smallest) };</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(smallest) || <a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(nextSmallest))</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            <span class="keywordflow">if</span> ((nextSmallest - smallest) * vgdl.<a class="code" href="classMs_1_1VerticalGapDataList.html#ad0221acb745b4c68868ce307c8070732">sumStretchFactor</a>() &gt; spaceLeft)</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                  nextSmallest = smallest + spaceLeft/vgdl.<a class="code" href="classMs_1_1VerticalGapDataList.html#ad0221acb745b4c68868ce307c8070732">sumStretchFactor</a>();</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            qreal addedSpace { 0.0 };</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            <a class="code" href="classMs_1_1VerticalGapDataList.html">VerticalGapDataList</a> modified;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd : vgdl) {</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(vgd-&gt;spacing() - smallest))</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                  qreal step { nextSmallest - vgd-&gt;spacing() };</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                  <span class="keywordflow">if</span> (step &lt; 0.0)</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                  step = vgd-&gt;addSpacing(step);</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(step)) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                        addedSpace += step * vgd-&gt;factor();</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                        modified.append(vgd);</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                        ++ngaps;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                        }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                  <span class="keywordflow">if</span> ((spaceLeft - addedSpace) &lt;= 0.0)</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                  }</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;            <span class="keywordflow">if</span> ((spaceLeft - addedSpace) &lt;= 0.0)</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                  {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd : modified)</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                        vgd-&gt;undoLastAddSpacing();</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                  ngaps = 0;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                  }</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                  spaceLeft -= addedSpace;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                  }</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="comment">// If there is still space left, distribute the space of the staves.</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="keyword">const</span> qreal maxPageFill { <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea5e99b620cdaa454546db9d777cae32a6">Sid::maxPageFillSpread</a>) };</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      pass = 0;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      ngaps = 1;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(spaceLeft) &amp;&amp; !<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(maxPageFill) &amp;&amp; (ngaps &gt; 0) &amp;&amp; (++pass &lt; maxPasses)) {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            ngaps = 0;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            qreal addedSpace { 0.0 };</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd : vgdl) {</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                  qreal step = spaceLeft / vgdl.sumStretchFactor();</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                  step = vgd-&gt;addFillSpacing(step, maxPageFill);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(step)) {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                        addedSpace += step * vgd-&gt;factor();</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                        ++ngaps;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                        }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                  }</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            spaceLeft -= addedSpace;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            }</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      QSet&lt;System*&gt; <a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      qreal systemShift { 0.0 };</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      qreal staffShift  { 0.0 };</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <a class="code" href="classMs_1_1System.html">System</a>* prvSystem { <span class="keyword">nullptr</span> };</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd : vgdl) {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            <span class="keywordflow">if</span> (vgd-&gt;sysStaff)</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                  systems.insert(vgd-&gt;system);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            systemShift += vgd-&gt;actualAddedSpace();</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            <span class="keywordflow">if</span> (prvSystem == vgd-&gt;system) {</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                  staffShift += vgd-&gt;actualAddedSpace();</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                  }</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                  vgd-&gt;system-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() += systemShift;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                  <span class="keywordflow">if</span> (prvSystem) {</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                        prvSystem-&gt;setDistance(vgd-&gt;system-&gt;y() - prvSystem-&gt;y());</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                        prvSystem-&gt;setHeight(prvSystem-&gt;height() + staffShift);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                        }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                  staffShift = 0.0;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                  }</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            <span class="keywordflow">if</span> (vgd-&gt;sysStaff)</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                  vgd-&gt;sysStaff-&gt;bbox().translate(0.0, staffShift);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            prvSystem = vgd-&gt;system;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keywordflow">if</span> (prvSystem) {</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            prvSystem-&gt;setHeight(prvSystem-&gt;height() + staffShift);</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            }</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1System.html">System</a>* system : systems) {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            system-&gt;setMeasureHeight(system-&gt;height());</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            system-&gt;layoutBracketsVertical();</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            system-&gt;layoutInstrumentNames();</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            }</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      vgdl.deleteAll();</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      }</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">//   layoutPage</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">//    restHeight - vertical space which has to be distributed</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">//                 between systems</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">//    The algorithm tries to produce most equally spaced</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">//    systems.</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"><a class="line" href="namespaceMs.html#aea8cb39fcc02e1ea400e11bbdd037198"> 1764</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#aea8cb39fcc02e1ea400e11bbdd037198">layoutPage</a>(<a class="code" href="classMs_1_1Page.html">Page</a>* page, qreal restHeight)</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keywordflow">if</span> (restHeight &lt; 0.0) {</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            qDebug(<span class="stringliteral">&quot;restHeight &lt; 0.0: %f\n&quot;</span>, restHeight);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            restHeight = 0;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            }</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <a class="code" href="classMs_1_1Score.html">Score</a>* <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a> = page-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>();</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keywordtype">int</span> gaps     = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().size() - 1;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      QList&lt;System*&gt; sList;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="comment">// build list of systems (excluding last)</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="comment">// set initial distance for each to the unstretched minimum distance to next</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gaps; ++i) {</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* s1 = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(i);</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* s2 = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(i+1);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            s1-&gt;<a class="code" href="classMs_1_1System.html#a0b00b334328d65102dfd1cbe86c9e629">setDistance</a>(s2-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>() - s1-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>());</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <span class="keywordflow">if</span> (s1-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>() || s2-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>() || s1-&gt;<a class="code" href="classMs_1_1System.html#aa562355bd9ceb1065284da1e2a19cc9c">hasFixedDownDistance</a>()) {</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                  <span class="keywordflow">if</span> (s2-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>()) {</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                        <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">true</span>, s1, 0.0, <span class="keyword">true</span>);      <span class="comment">// remove</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                        <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">false</span>, s1, 0.0, <span class="keyword">true</span>);     <span class="comment">// remove</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                        <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">true</span>, s2, 0.0, <span class="keyword">true</span>);      <span class="comment">// remove</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                        <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">false</span>, s2, 0.0, <span class="keyword">true</span>);     <span class="comment">// remove</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                        }</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                  }</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            sList.push_back(s1);</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="comment">// last system needs no divider</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <a class="code" href="classMs_1_1System.html">System</a>* lastSystem = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().back();</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">true</span>, lastSystem, 0.0, <span class="keyword">true</span>);      <span class="comment">// remove</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">false</span>, lastSystem, 0.0, <span class="keyword">true</span>);     <span class="comment">// remove</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="keywordflow">if</span> (sList.empty() || <a class="code" href="classMs_1_1MScore.html#a4a728f9ca94208b1b67962318eea1317">MScore::noVerticalStretch</a> || score-&gt;<a class="code" href="classMs_1_1Score.html#a93f20b9f05035a10d6e78c10ebdaf761">enableVerticalSpread</a>() || score-&gt;<a class="code" href="classMs_1_1Score.html#a48d54ab45d94e4ef6a420f94d2612f18">layoutMode</a>() == <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bafa177138f94a7ea01f549b1aa7893d03">LayoutMode::SYSTEM</a>) {</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <span class="keywordflow">if</span> (score-&gt;<a class="code" href="classMs_1_1Score.html#a48d54ab45d94e4ef6a420f94d2612f18">layoutMode</a>() == <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6">LayoutMode::FLOAT</a>) {</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                  qreal y = restHeight * .5;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1System.html">System</a>* system : page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>())</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                        system-&gt;move(QPointF(0.0, y));</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                  }</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((score-&gt;<a class="code" href="classMs_1_1Score.html#a48d54ab45d94e4ef6a420f94d2612f18">layoutMode</a>() != <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bafa177138f94a7ea01f549b1aa7893d03">LayoutMode::SYSTEM</a>) &amp;&amp; score-&gt;<a class="code" href="classMs_1_1Score.html#a93f20b9f05035a10d6e78c10ebdaf761">enableVerticalSpread</a>())</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                  <a class="code" href="namespaceMs.html#a299f1a25ba7157c59bcfb113649dbd05">distributeStaves</a>(page);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="comment">// system dividers</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gaps; ++i) {</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                  <a class="code" href="classMs_1_1System.html">System</a>* s1 = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(i);</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                  <a class="code" href="classMs_1_1System.html">System</a>* s2 = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(i+1);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                  <span class="keywordflow">if</span> (!(s1-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>() || s2-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>())) {</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                        qreal yOffset = s1-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>() + (s1-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>()-s1-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>()) * .5;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                        <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">true</span>,  s1, yOffset);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                        <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">false</span>, s1, yOffset);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                        }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                  }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            }</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      qreal maxDist = score-&gt;<a class="code" href="classMs_1_1Score.html#a6dbe701d1fecb2a897f97acaac59c7ea">maxSystemDistance</a>();</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="comment">// allocate space as needed to normalize system distance (bottom of one system to top of next)</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <a class="code" href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">std::sort</a>(sList.begin(), sList.end(), [](<a class="code" href="classMs_1_1System.html">System</a>* a, <a class="code" href="classMs_1_1System.html">System</a>* b) { <span class="keywordflow">return</span> a-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>() - a-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>() &lt; b-&gt;distance() - b-&gt;height(); });</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      <a class="code" href="classMs_1_1System.html">System</a>* s0 = sList[0];</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      qreal dist = s0-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>() - s0-&gt;height();           <span class="comment">// distance for shortest system</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; sList.size(); ++i) {</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* si = sList[i];</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            qreal ndist = si-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>() - si-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>();    <span class="comment">// next taller system</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            qreal fill  = ndist - dist;                     <span class="comment">// amount by which this system distance exceeds next shorter</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="keywordflow">if</span> (fill &gt; 0.0) {</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                  qreal totalFill = fill * i;               <span class="comment">// space required to add this amount to all shorter systems</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                  <span class="keywordflow">if</span> (totalFill &gt; restHeight) {</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                        totalFill = restHeight;             <span class="comment">// too much; adjust amount</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                        fill = restHeight / i;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        }</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; i; ++k) {             <span class="comment">// add amount to all shorter systems</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                        <a class="code" href="classMs_1_1System.html">System</a>* s = sList[k];</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                        qreal d = s-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>() + fill;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                        <span class="keywordflow">if</span> ((d - s-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>()) &gt; maxDist)    <span class="comment">// but don&#39;t exceed max system distance</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                              d = qMax(maxDist + s-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>(), s-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>());</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        s-&gt;<a class="code" href="classMs_1_1System.html#a0b00b334328d65102dfd1cbe86c9e629">setDistance</a>(d);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                        }</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                  restHeight -= totalFill;                  <span class="comment">// reduce available space for next iteration</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                  <span class="keywordflow">if</span> (restHeight &lt;= 0)</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                        <span class="keywordflow">break</span>;                              <span class="comment">// no space left</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                  }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            dist = ndist;                                   <span class="comment">// set up for next iteration</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            }</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordflow">if</span> (restHeight &gt; 0.0) {                               <span class="comment">// space left?</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            qreal fill = restHeight / sList.size();</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1System.html">System</a>* s : qAsConst(sList)) {                       <span class="comment">// allocate it to systems equally</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                  qreal d = s-&gt;distance() + fill;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                  <span class="keywordflow">if</span> ((d - s-&gt;height()) &gt; maxDist)          <span class="comment">// but don&#39;t exceed max system distance</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                        d = qMax(maxDist + s-&gt;height(), s-&gt;distance());</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                  s-&gt;setDistance(d);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                  }</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      qreal y = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(0)-&gt;y();</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gaps; ++i) {</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* s1  = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(i);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* s2  = page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().at(i+1);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            s1-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() = y;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            y          += s1-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>();</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <span class="keywordflow">if</span> (!(s1-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>() || s2-&gt;<a class="code" href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">vbox</a>())) {</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                  qreal yOffset = s1-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>() + (s1-&gt;<a class="code" href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">distance</a>()-s1-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>()) * .5;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                  <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">true</span>,  s1, yOffset);</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                  <a class="code" href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">checkDivider</a>(<span class="keyword">false</span>, s1, yOffset);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                  }</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            }</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      page-&gt;<a class="code" href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">systems</a>().back()-&gt;rypos() = y;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      }</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">//   Spring</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"><a class="line" href="structMs_1_1Spring.html"> 1881</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structMs_1_1Spring.html">Spring</a> {</div><div class="line"><a name="l01882"></a><span class="lineno"><a class="line" href="structMs_1_1Spring.html#a063e8bc40e6f7f909e42f8098f0f485d"> 1882</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structMs_1_1Spring.html#a063e8bc40e6f7f909e42f8098f0f485d">seg</a>;</div><div class="line"><a name="l01883"></a><span class="lineno"><a class="line" href="structMs_1_1Spring.html#a7e0380cc850bb2909bb576c549c7abce"> 1883</a></span>&#160;      qreal <a class="code" href="structMs_1_1Spring.html#a7e0380cc850bb2909bb576c549c7abce">stretch</a>;</div><div class="line"><a name="l01884"></a><span class="lineno"><a class="line" href="structMs_1_1Spring.html#a1cbc2c5ab8e76451bbcc84b0cdc94bd6"> 1884</a></span>&#160;      qreal <a class="code" href="structMs_1_1Spring.html#a1cbc2c5ab8e76451bbcc84b0cdc94bd6">fix</a>;</div><div class="line"><a name="l01885"></a><span class="lineno"><a class="line" href="structMs_1_1Spring.html#ad22ab9409d5f708042ae3ab507af1359"> 1885</a></span>&#160;      <a class="code" href="structMs_1_1Spring.html#ad22ab9409d5f708042ae3ab507af1359">Spring</a>(<span class="keywordtype">int</span> i, qreal s, qreal f) : seg(i), stretch(s), fix(f) {}</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      };</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div><div class="line"><a name="l01888"></a><span class="lineno"><a class="line" href="namespaceMs.html#a365dcf81941d576fcd006011e32185c5"> 1888</a></span>&#160;<span class="keyword">typedef</span> std::multimap&lt;qreal, Spring, std::less&lt;qreal&gt; &gt; <a class="code" href="namespaceMs.html#a365dcf81941d576fcd006011e32185c5">SpringMap</a>;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment">//   sff2</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="comment">//    compute 1/Force for a given Extend</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"><a class="line" href="namespaceMs.html#a1f8470ac2e722a112c0c83de917a51a6"> 1895</a></span>&#160;<span class="keyword">static</span> qreal <a class="code" href="namespaceMs.html#a1f8470ac2e722a112c0c83de917a51a6">sff2</a>(qreal width, qreal xMin, <span class="keyword">const</span> SpringMap&amp; springs)</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      {</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">if</span> (width &lt;= xMin)</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keyword">auto</span> i = springs.begin();</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      qreal c  = i-&gt;second.stretch;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordflow">if</span> (c == 0.0)           <span class="comment">//DEBUG</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            c = 1.1;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      qreal f = 0.0;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">for</span> (; i != springs.end();) {</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            xMin -= i-&gt;second.fix;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            f = (width - xMin) / c;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            ++i;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <span class="keywordflow">if</span> (i == springs.end() || f &lt;= i-&gt;first)</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            c += i-&gt;second.stretch;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="keywordflow">return</span> f;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment">//   respace</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div><div class="line"><a name="l01919"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a5dc40137cd531f03daad7bdca7ab68e6"> 1919</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a5dc40137cd531f03daad7bdca7ab68e6">Score::respace</a>(std::vector&lt;ChordRest*&gt;* elements)</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      {</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr1 = elements-&gt;front();</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr2 = elements-&gt;back();</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordtype">int</span> n          = int(elements-&gt;size());</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      qreal x1       = cr1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().x();</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      qreal x2       = cr2-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().x();</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="preprocessor">#if (!defined (_MSCVER) &amp;&amp; !defined (_MSC_VER))</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      qreal width[n-1];</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordtype">int</span> ticksList[n-1];</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="comment">// MSVC does not support VLA. Replace with std::vector. If profiling determines that the</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="comment">//    heap allocation is slow, an optimization might be used.</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      std::vector&lt;qreal&gt; width(n-1);</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      std::vector&lt;int&gt; ticksList(n-1);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keywordtype">int</span> minTick = 100000;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n-1; ++i) {</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr  = (*elements)[i];</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* ncr  = (*elements)[i+1];</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            width[i]       = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a9263c16f6d004ee4fce1ae6633fd022d">shape</a>().<a class="code" href="classMs_1_1Shape.html#a159413b243aff63b765b2a0aebde7f36">minHorizontalDistance</a>(ncr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a9263c16f6d004ee4fce1ae6633fd022d">shape</a>());</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            ticksList[i]   = cr-&gt;<a class="code" href="classMs_1_1DurationElement.html#abd480ba4d052d040db56e1e504cf2596">ticks</a>().<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>();</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            minTick = qMin(ticksList[i], minTick);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="comment">// compute stretches</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      SpringMap springs;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      qreal minimum = 0.0;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n-1; ++i) {</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            qreal w   = width[i];</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            <span class="keywordtype">int</span> t     = ticksList[i];</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            qreal str = 1.0 + 0.865617 * <a class="code" href="namespaceMs.html#a3f1ba7877c228a0e6e42e11658b4d77a">log</a>(qreal(t) / qreal(minTick));</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            qreal d   = w / str;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            springs.insert(std::pair&lt;qreal, Spring&gt;(d, <a class="code" href="structMs_1_1Spring.html">Spring</a>(i, str, w)));</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            minimum += w;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            }</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="comment">//    distribute stretch to elements</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      qreal force = <a class="code" href="namespaceMs.html#a1f8470ac2e722a112c0c83de917a51a6">sff2</a>(x2 - x1, minimum, springs);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = springs.begin(); i != springs.end(); ++i) {</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            qreal stretch = force * i-&gt;second.stretch;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <span class="keywordflow">if</span> (stretch &lt; i-&gt;second.fix)</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                  stretch = i-&gt;second.fix;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            width[i-&gt;second.seg] = stretch;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            }</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      qreal x = x1;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; n-1; ++i) {</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            x += width[i-1];</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = (*elements)[i];</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            qreal dx = x - cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().x();</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            cr-&gt;<a class="code" href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">rxpos</a>() += dx;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            }</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      }</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">//   getNextPage</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"><a class="line" href="structMs_1_1LayoutContext.html#ac53ba577f2fb5d2c0884a0d02c628a48"> 1986</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structMs_1_1LayoutContext.html#ac53ba577f2fb5d2c0884a0d02c628a48">LayoutContext::getNextPage</a>()</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      {</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="keywordflow">if</span> (!page || curPage &gt;= <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a291718ca12053bd8e663a8fcd756bd6b">npages</a>()) {</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            page = <span class="keyword">new</span> <a class="code" href="classMs_1_1Page.html">Page</a>(<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>);</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>().push_back(page);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            prevSystem = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            pageOldMeasure = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            }</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            page = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>()[curPage];</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            QList&lt;System*&gt;&amp; <a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a> = page-&gt;systems();</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            pageOldMeasure = systems.isEmpty() ? nullptr : systems.back()-&gt;measures().back();</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> i = systems.indexOf(curSystem);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; systems[i-1]-&gt;page() == page) {</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                  <span class="comment">// Current and previous systems are on the current page.</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                  <span class="comment">// Erase only the current and the following systems</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                  <span class="comment">// as the previous one will not participate in layout.</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                  systems.erase(systems.begin() + i, systems.end());</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                  }</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// system is not on the current page (or will be the first one)</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                  systems.clear();</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            prevSystem = systems.empty() ? nullptr : systems.back();</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            }</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      page-&gt;bbox().setRect(0.0, 0.0, <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#afd4b28e5752dc085c8e0e4203631a1c0">loWidth</a>(), <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#acc471f15d19ad2e742abb8433c071fcb">loHeight</a>());</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      page-&gt;setNo(curPage);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      qreal x = 0.0;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      qreal y = 0.0;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordflow">if</span> (curPage) {</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;            <a class="code" href="classMs_1_1Page.html">Page</a>* prevPage = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>()[curPage - 1];</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1MScore.html#aca131f1f53787e9bfa4fa5e3b564e7de">MScore::verticalOrientation</a>())</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                  y = prevPage-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().y() + page-&gt;height() + <a class="code" href="classMs_1_1MScore.html#a2d1e149be3385c5540ef31af5d4fb20e">MScore::verticalPageGap</a>;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                  qreal gap = (curPage + <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a8226b0d61543b1fca19861ca748900ba">pageNumberOffset</a>()) &amp; 1 ? <a class="code" href="classMs_1_1MScore.html#a4869cc8207f7c0ad6772120a1ec78c56">MScore::horizontalPageGapOdd</a> : <a class="code" href="classMs_1_1MScore.html#ac9d042a7decd57dbcea04544594b33c1">MScore::horizontalPageGapEven</a>;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                  x = prevPage-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().x() + page-&gt;width() + gap;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                  }</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            }</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      ++curPage;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      page-&gt;setPos(x, y);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      }</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">//   getNextSystem</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02030"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a864ad984e2922bc06edd59dd0ac9a889"> 2030</a></span>&#160;<a class="code" href="classMs_1_1System.html">System</a>* <a class="code" href="classMs_1_1Score.html#a864ad984e2922bc06edd59dd0ac9a889">Score::getNextSystem</a>(<a class="code" href="structMs_1_1LayoutContext.html">LayoutContext</a>&amp; lc)</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      {</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="keywordtype">bool</span> isVBox = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isVBox();</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <a class="code" href="classMs_1_1System.html">System</a>* system;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#add8b93fda5fa1fedd7e5e29759ce6d97">systemList</a>.empty()) {</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            system = <span class="keyword">new</span> <a class="code" href="classMs_1_1System.html">System</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a7e8b4ba56f18cb041803394a6cf5128a">systemOldMeasure</a> = 0;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            }</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            system = lc.<a class="code" href="structMs_1_1LayoutContext.html#add8b93fda5fa1fedd7e5e29759ce6d97">systemList</a>.takeFirst();</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a7e8b4ba56f18cb041803394a6cf5128a">systemOldMeasure</a> = system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().empty() ? 0 : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().back();</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            system-&gt;<a class="code" href="classMs_1_1System.html#a630eb061f651b37400274e180f12cc62">clear</a>();   <span class="comment">// remove measures from system</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            }</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.append(system);</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keywordflow">if</span> (!isVBox) {</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a> = <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">Score::nstaves</a>();</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            system-&gt;<a class="code" href="classMs_1_1System.html#af40610f94eb1240d9b432efc583e805e">adjustStavesNumber</a>(nstaves);</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            }</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="keywordflow">return</span> system;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      }</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">//   createMMRest</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">//    create a multi measure rest from m to lm (inclusive)</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a4aefe9ae9c020b436a6dfca0a9129531"> 2056</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a4aefe9ae9c020b436a6dfca0a9129531">Score::createMMRest</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m, <a class="code" href="classMs_1_1Measure.html">Measure</a>* lm, <span class="keyword">const</span> <a class="code" href="classMs_1_1Fraction.html">Fraction</a>&amp; len)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      {</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keywordtype">int</span> n = 1;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keywordflow">if</span> (m != lm) {</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Measure.html">Measure</a>* mm = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>(); mm; mm = mm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>()) {</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                  ++n;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                  mm-&gt;setMMRestCount(-1);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                  <span class="keywordflow">if</span> (mm-&gt;mmRest())</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1ChangeMMRest.html">ChangeMMRest</a>(mm, 0));</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                  <span class="keywordflow">if</span> (mm == lm)</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                  }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            }</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <a class="code" href="classMs_1_1Measure.html">Measure</a>* mmr = m-&gt;<a class="code" href="classMs_1_1Measure.html#a9109c2c9621f0cc9ecd86afcae54afe8">mmRest</a>();</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="keywordflow">if</span> (mmr) {</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;            <span class="comment">// reuse existing mmrest</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <span class="keywordflow">if</span> (mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>() != len) {</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                  <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d">SegmentType::EndBarLine</a>, mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                  <span class="comment">// adjust length</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                  mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#adb1ce7a9970f4e47d69a6344eb51aa61">setTicks</a>(len);</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                  <span class="comment">// move existing end barline</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                  <span class="keywordflow">if</span> (s)</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                        s-&gt;<a class="code" href="classMs_1_1Segment.html#a458e64e2a7ec6846e1f085dc843fa416">setRtick</a>(len);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                  }</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a95d953121aa2ea9b6db91e2b147fed50">removeSystemTrailer</a>();</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            }</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            mmr = <span class="keyword">new</span> <a class="code" href="classMs_1_1Measure.html">Measure</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#adb1ce7a9970f4e47d69a6344eb51aa61">setTicks</a>(len);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#abbb8a43c3c9cdb1a3cce412bfe4409ef">setTick</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>());</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1ChangeMMRest.html">ChangeMMRest</a>(m, mmr));</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            }</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1Measure.html#ad506977829d7909fc0ad9b74e00bea33">setTimesig</a>(m-&gt;<a class="code" href="classMs_1_1Measure.html#aca83bf67143934f224cd28aa7bdb4459">timesig</a>());</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#aab85a5d7b01dd5f816168d3e8a6e4dad">setPageBreak</a>(lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6c58c83a689bd9d8caa462ab3559b176">pageBreak</a>());</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a87f96d1fa43004af6444997951f70a6e">setLineBreak</a>(lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ad4153b0dbfe2fb2a229fd93a45c71f7b">lineBreak</a>());</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a405ecf7ac85a17e4285644b04a8085d0">setMMRestCount</a>(n);</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2aaffc490540f2744696b3ffda1fd66a">setNo</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0624346b77edaab4269b9eb2523a225">no</a>());</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* ss = lm-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d">SegmentType::EndBarLine</a>, lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordflow">if</span> (ss) {</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            <a class="code" href="classMs_1_1Segment.html">Segment</a>* ds = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">undoGetSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d">SegmentType::EndBarLine</a>, mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* e = ss-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                  <span class="keywordflow">if</span> (e) {</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                        <span class="keywordtype">bool</span> generated = e-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>();</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                        <span class="keywordflow">if</span> (!ds-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * VOICES)) {</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                              <a class="code" href="classMs_1_1Element.html">Element</a>* ee = generated ? e-&gt;<a class="code" href="classMs_1_1Element.html#adcd981af2ae9890f31c993050d5f0f25">clone</a>() : e-&gt;<a class="code" href="classMs_1_1Element.html#ab6aade6de785c3ad52c1ed1dadcfcd9f">linkedClone</a>();</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                              ee-&gt;<a class="code" href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">setGenerated</a>(generated);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                              ee-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(ds);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a88d1556bac485bde9b2d6ae3c1e6bd77">undoAddElement</a>(ee);</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                              }</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                              <a class="code" href="classMs_1_1BarLine.html">BarLine</a>* bd = toBarLine(ds-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * VOICES));</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                              <a class="code" href="classMs_1_1BarLine.html">BarLine</a>* bs = toBarLine(e);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                              <span class="keywordflow">if</span> (!generated &amp;&amp; !bd-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a3d5c97191484848b3f10e754246f8758">links</a>())</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                                    <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1Link.html">Link</a>(bd, bs));</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                              <span class="keywordflow">if</span> (bd-&gt;<a class="code" href="classMs_1_1BarLine.html#a4a0426d2e0676bda9cca5f61388cbcf6">barLineType</a>() != bs-&gt;barLineType()) {</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                                    <span class="comment">// change directly when generating mmrests, do not change underlying measures or follow links</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                                    <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1ChangeProperty.html">ChangeProperty</a>(bd, <a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a0e367b050268c19d741b999b26536350">Pid::BARLINE_TYPE</a>, QVariant::fromValue(bs-&gt;barLineType()), <a class="code" href="namespaceMs.html#a56785a0f227cf3d1d0a4891656a35daaa97b2544863191b69cc11635be5d02244">PropertyFlags::NOSTYLE</a>));</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                    <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1ChangeProperty.html">ChangeProperty</a>(bd, <a class="code" href="namespaceMs.html#a02cda2a18206af7dc3efbd0db9142e22a381fe0b09931a4acf5bc2176e1e6f854">Pid::GENERATED</a>, generated, <a class="code" href="namespaceMs.html#a56785a0f227cf3d1d0a4891656a35daaa97b2544863191b69cc11635be5d02244">PropertyFlags::NOSTYLE</a>));</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                                    }</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                              }</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                        }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                  }</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            }</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* clefSeg = lm-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041">SegmentType::Clef</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894af69392a2ebed1af02428c867f81fed3f">SegmentType::HeaderClef</a>, lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      <span class="keywordflow">if</span> (clefSeg) {</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <a class="code" href="classMs_1_1Segment.html">Segment</a>* mmrClefSeg = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#ab6c8d20b57a9c8e72e75684687932777">undoGetSegment</a>(clefSeg-&gt;<a class="code" href="classMs_1_1Segment.html#accf66d981db70ac1bd843ca5e03330a1">segmentType</a>(), lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>());</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> track = <a class="code" href="namespaceMs.html#a9b94748a1c466ed6e89f2c80e57b644b">staff2track</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* e = clefSeg-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track);</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                  <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isClef()) {</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                        <a class="code" href="classMs_1_1Clef.html">Clef</a>* clef = toClef(e);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                        <span class="keywordflow">if</span> (!mmrClefSeg-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track)) {</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                              <a class="code" href="classMs_1_1Clef.html">Clef</a>* mmrClef = clef-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>() ? clef-&gt;<a class="code" href="classMs_1_1Clef.html#aca48a453519341c23fd7394f0654738e">clone</a>() : toClef(clef-&gt;<a class="code" href="classMs_1_1Element.html#ab6aade6de785c3ad52c1ed1dadcfcd9f">linkedClone</a>());</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                              mmrClef-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(mmrClefSeg);</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a88d1556bac485bde9b2d6ae3c1e6bd77">undoAddElement</a>(mmrClef);</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                              }</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                              <a class="code" href="classMs_1_1Clef.html">Clef</a>* mmrClef = toClef(mmrClefSeg-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                              mmrClef-&gt;<a class="code" href="classMs_1_1Clef.html#a2eecb12827da565064dae00af74efa16">setClefType</a>(clef-&gt;<a class="code" href="classMs_1_1Clef.html#ab6bf0a0ccc8357db3cc87d213d204811">clefType</a>());</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                              mmrClef-&gt;<a class="code" href="classMs_1_1Clef.html#a31fa86e7a76e66fd538bd1247e2c9f34">setShowCourtesy</a>(clef-&gt;<a class="code" href="classMs_1_1Clef.html#a906b7768a20cb40b4e79aacdb94a583c">showCourtesy</a>());</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                              }</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                        }</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                  }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a697017a2b8bc5e08c40c79579c4f9826">setRepeatStart</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>() || lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>());</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2abd8e864fcfe4f972fc807ddd9f0dcc">setRepeatEnd</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2137ef7315aaed4adc68372946380d2c">repeatEnd</a>() || lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2137ef7315aaed4adc68372946380d2c">repeatEnd</a>());</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a0cf3aae4535ef71cc3ac6aca5bc4777d">setSectionBreak</a>(lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>());</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <a class="code" href="classMs_1_1ElementList.html">ElementList</a> oldList = mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ae4c2254a3440f2fb993cee717412fec5">takeElements</a>();</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <a class="code" href="classMs_1_1ElementList.html">ElementList</a> newList = lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0832f1270b77762f3c12758fe22c3c2">el</a>();</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0832f1270b77762f3c12758fe22c3c2">el</a>()) {</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            <span class="keywordflow">if</span> (e-&gt;isMarker())</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                  newList.push_back(e);</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            }</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : newList) {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* ee : oldList) {</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                  <span class="keywordflow">if</span> (ee-&gt;type() == e-&gt;type() &amp;&amp; ee-&gt;subtype() == e-&gt;subtype()) {</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                        mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a817b1bd3c14e6d5e9ba961ccd092e45b">add</a>(ee);</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                        <span class="keyword">auto</span> i = std::find(oldList.begin(), oldList.end(), ee);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                        <span class="keywordflow">if</span> (i != oldList.end())</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                              oldList.erase(i);</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        found = <span class="keyword">true</span>;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                        }</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                  }</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="keywordflow">if</span> (!found)</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                  mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a817b1bd3c14e6d5e9ba961ccd092e45b">add</a>(e-&gt;clone());</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            }</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : oldList)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            <span class="keyword">delete</span> e;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">undoGetSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.size(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            <span class="keywordtype">int</span> track = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            <span class="keywordflow">if</span> (s-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track) == 0) {</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                  <a class="code" href="classMs_1_1Rest.html">Rest</a>* r = <span class="keyword">new</span> <a class="code" href="classMs_1_1Rest.html">Rest</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                  r-&gt;<a class="code" href="classMs_1_1ChordRest.html#adc6b9aa10c0b149eea492432ceeb3ce3">setDurationType</a>(<a class="code" href="classMs_1_1TDuration.html#ad9263bf173856b77421e83a48a7bf68cac23bf58f35bf1fdfa910d9de6dba47f4">TDuration::DurationType::V_MEASURE</a>);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                  r-&gt;<a class="code" href="classMs_1_1DurationElement.html#ab46be26ba621ac65774af1ad7bb07cd7">setTicks</a>(mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                  r-&gt;<a class="code" href="classMs_1_1Rest.html#ab29b536313ed9f33a07e65939faadef3">setTrack</a>(track);</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                  r-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(s);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                  <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1AddElement.html">AddElement</a>(r));</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                  }</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            }</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      <span class="comment">// check for clefs</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* cs = lm-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041">SegmentType::Clef</a>, lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a66a3e42855dec1d88936966d197a0ac0">findSegment</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041">SegmentType::Clef</a>, lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>());</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">if</span> (cs) {</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="keywordflow">if</span> (ns == 0)</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                  ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">undoGetSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041">SegmentType::Clef</a>, lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(cs-&gt;<a class="code" href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">enabled</a>());</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#a304d88a7891a731cbfb8e5b0c2e8a5fc">setTrailer</a>(cs-&gt;<a class="code" href="classMs_1_1Element.html#a868f0f5663dd1d7422c19700e070a4a6">trailer</a>());</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.size(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                  <span class="keywordtype">int</span> track = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                  <a class="code" href="classMs_1_1Clef.html">Clef</a>* clef = toClef(cs-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                  <span class="keywordflow">if</span> (clef) {</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        <span class="keywordflow">if</span> (ns-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track) == 0)</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                              ns-&gt;<a class="code" href="classMs_1_1Segment.html#a1a43bbbee320ca145d6bf07f16243837">add</a>(clef-&gt;<a class="code" href="classMs_1_1Clef.html#aca48a453519341c23fd7394f0654738e">clone</a>());</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                              <span class="comment">//TODO: check if same clef</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                              }</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                        }</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                  }</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            }</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ns) {</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            <span class="comment">// TODO: remove elements from ns?</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1RemoveElement.html">RemoveElement</a>(ns));</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            }</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <span class="comment">// check for time signature</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      cs = m-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb">SegmentType::TimeSig</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a66a3e42855dec1d88936966d197a0ac0">findSegment</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb">SegmentType::TimeSig</a>, m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>());</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordflow">if</span> (cs) {</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            <span class="keywordflow">if</span> (ns == 0)</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                  ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">undoGetSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb">SegmentType::TimeSig</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(cs-&gt;<a class="code" href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">enabled</a>());</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#a5033ef29dffbf6e40958e4fdd2802b6d">setHeader</a>(cs-&gt;<a class="code" href="classMs_1_1Element.html#abb3880878a2f2826b253d5e0e14b32b6">header</a>());</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.size(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                  <span class="keywordtype">int</span> track = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                  <a class="code" href="classMs_1_1TimeSig.html">TimeSig</a>* ts = toTimeSig(cs-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                  <span class="keywordflow">if</span> (ts) {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                        <a class="code" href="classMs_1_1TimeSig.html">TimeSig</a>* nts = toTimeSig(ns-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                        <span class="keywordflow">if</span> (!nts) {</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                              nts = ts-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>() ? ts-&gt;<a class="code" href="classMs_1_1TimeSig.html#ae890234f0152fc2af7ec392c5ce0abf2">clone</a>() : toTimeSig(ts-&gt;<a class="code" href="classMs_1_1Element.html#ab6aade6de785c3ad52c1ed1dadcfcd9f">linkedClone</a>());</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                              nts-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(ns);</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1AddElement.html">AddElement</a>(nts));</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                              }</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                              nts-&gt;<a class="code" href="classMs_1_1TimeSig.html#a78e7202ffb38948cd251b6e86eab9ef1">setSig</a>(ts-&gt;<a class="code" href="classMs_1_1TimeSig.html#adf5c9dc552745c05fda274364a894881">sig</a>(), ts-&gt;<a class="code" href="classMs_1_1TimeSig.html#aa96a3e42c031384a82e0b3d078114a02">timeSigType</a>());</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                              nts-&gt;<a class="code" href="classMs_1_1TimeSig.html#ac05d6d09cbb195e39fa48c5611d08e31">layout</a>();</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                              }</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                        }</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                  }</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            }</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ns) {</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            <span class="comment">// TODO: remove elements from ns?</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1RemoveElement.html">RemoveElement</a>(ns));</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            }</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <span class="comment">// check for ambitus</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      cs = m-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a744c4c5d2986906841d0f6e0e4906985">SegmentType::Ambitus</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a66a3e42855dec1d88936966d197a0ac0">findSegment</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a744c4c5d2986906841d0f6e0e4906985">SegmentType::Ambitus</a>, m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>());</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="keywordflow">if</span> (cs) {</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            <span class="keywordflow">if</span> (ns == 0)</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                  ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">undoGetSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a744c4c5d2986906841d0f6e0e4906985">SegmentType::Ambitus</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.size(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                  <span class="keywordtype">int</span> track = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                  <a class="code" href="classMs_1_1Ambitus.html">Ambitus</a>* a = toAmbitus(cs-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                  <span class="keywordflow">if</span> (a) {</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                        <a class="code" href="classMs_1_1Ambitus.html">Ambitus</a>* na = toAmbitus(ns-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                        <span class="keywordflow">if</span> (!na) {</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                              na = a-&gt;<a class="code" href="classMs_1_1Ambitus.html#a742733b3bbe922ee6ef0563aab3723a4">clone</a>();</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                              na-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(ns);</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1AddElement.html">AddElement</a>(na));</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                              }</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                              na-&gt;<a class="code" href="classMs_1_1Ambitus.html#a9bce2caa3538a8bc7e03855a70cf9d0e">initFrom</a>(a);</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                              na-&gt;<a class="code" href="classMs_1_1Ambitus.html#a48ca0c7673fd47eb158ac88ba65d663d">layout</a>();</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                              }</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                        }</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                  }</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            }</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ns) {</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            <span class="comment">// TODO: remove elements from ns?</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;            <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1RemoveElement.html">RemoveElement</a>(ns));</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            }</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="comment">// check for key signature</span></div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      cs = m-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ac9bacf3e6728a92c9bf826c740ae5436">SegmentType::KeySig</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ac9bacf3e6728a92c9bf826c740ae5436">SegmentType::KeySig</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordflow">if</span> (cs) {</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <span class="keywordflow">if</span> (ns == 0)</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                  ns = mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">undoGetSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ac9bacf3e6728a92c9bf826c740ae5436">SegmentType::KeySig</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(cs-&gt;<a class="code" href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">enabled</a>());</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#a5033ef29dffbf6e40958e4fdd2802b6d">setHeader</a>(cs-&gt;<a class="code" href="classMs_1_1Element.html#abb3880878a2f2826b253d5e0e14b32b6">header</a>());</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">_staves</a>.size(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                  <span class="keywordtype">int</span> track = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                  <a class="code" href="classMs_1_1KeySig.html">KeySig</a>* ks  = toKeySig(cs-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                  <span class="keywordflow">if</span> (ks) {</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                        <a class="code" href="classMs_1_1KeySig.html">KeySig</a>* nks = toKeySig(ns-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track));</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                        <span class="keywordflow">if</span> (!nks) {</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                              nks = ks-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>() ? ks-&gt;<a class="code" href="classMs_1_1KeySig.html#ac70a2ea997165c6d12af4238a05c4d37">clone</a>() : toKeySig(ks-&gt;<a class="code" href="classMs_1_1Element.html#ab6aade6de785c3ad52c1ed1dadcfcd9f">linkedClone</a>());</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                              nks-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(ns);</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                              nks-&gt;<a class="code" href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">setGenerated</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1AddElement.html">AddElement</a>(nks));</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                              }</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                              <span class="keywordflow">if</span> (!(nks-&gt;<a class="code" href="classMs_1_1KeySig.html#a167094029a75cd2df41ebd1b2abee522">keySigEvent</a>() == ks-&gt;<a class="code" href="classMs_1_1KeySig.html#a167094029a75cd2df41ebd1b2abee522">keySigEvent</a>())) {</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                                    <span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a47dcef959ab36006b46ca9005b316008">addKey</a> = ks-&gt;<a class="code" href="classMs_1_1KeySig.html#aaf05171f7463c35873048bf6fa251f2b">isChange</a>();</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                                    <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1ChangeKeySig.html">ChangeKeySig</a>(nks, ks-&gt;<a class="code" href="classMs_1_1KeySig.html#a167094029a75cd2df41ebd1b2abee522">keySigEvent</a>(), nks-&gt;<a class="code" href="classMs_1_1KeySig.html#ae86100386edc3a5b7445b4c3d7cee79a">showCourtesy</a>(), <a class="code" href="namespaceMs.html#a47dcef959ab36006b46ca9005b316008">addKey</a>));</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                                    }</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                              }</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                        }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                  }</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            }</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ns) {</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;            ns-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            <span class="comment">// TODO: remove elements from ns, then delete ns</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            <span class="comment">// previously we removed the segment if not empty,</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <span class="comment">// but this resulted in &quot;stale&quot; keysig in mmrest after removed from underlying measure</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            <span class="comment">//undo(new RemoveElement(ns));</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            }</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a8b08d9e9607782a9400c16140e243112">checkHeader</a>();</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1Measure.html#a5c2da938ad615b8d3d2adccf77eb2059">checkTrailer</a>();</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <span class="comment">// check for rehearsal mark etc.</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      cs = m-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="keywordflow">if</span> (cs) {</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <span class="comment">// clone elements from underlying measure to mmr</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : cs-&gt;<a class="code" href="classMs_1_1Segment.html#ac30bce62d008049b47f408497d32dccc">annotations</a>()) {</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                  <span class="comment">// look at elements in underlying measure</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                  <span class="keywordflow">if</span> (!(e-&gt;isRehearsalMark() || e-&gt;isTempoText() || e-&gt;isHarmony() || e-&gt;isStaffText() || e-&gt;isSystemText() || e-&gt;isInstrumentChange()))</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                  <span class="comment">// try to find a match in mmr</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* ee : s-&gt;<a class="code" href="classMs_1_1Segment.html#ac30bce62d008049b47f408497d32dccc">annotations</a>()) {</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;linkList().contains(ee)) {</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                              found = <span class="keyword">true</span>;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                              }</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                        }</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                  <span class="comment">// add to mmr if no match found</span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                  <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                        <a class="code" href="classMs_1_1Element.html">Element</a>* ne = e-&gt;<a class="code" href="classMs_1_1Element.html#ab6aade6de785c3ad52c1ed1dadcfcd9f">linkedClone</a>();</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                        ne-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(s);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1AddElement.html">AddElement</a>(ne));</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                        }</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                  }</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            <span class="comment">// remove stray elements (possibly leftover from a previous layout of this mmr)</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            <span class="comment">// this should not happen since the elements are linked?</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;<a class="code" href="classMs_1_1Segment.html#ac30bce62d008049b47f408497d32dccc">annotations</a>()) {</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                  <span class="comment">// look at elements in mmr</span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                  <span class="keywordflow">if</span> (!(e-&gt;isRehearsalMark() || e-&gt;isTempoText() || e-&gt;isHarmony() || e-&gt;isStaffText() || e-&gt;isSystemText() || e-&gt;isInstrumentChange()))</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                  <span class="comment">// try to find a match in underlying measure</span></div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* ee : cs-&gt;<a class="code" href="classMs_1_1Segment.html#ac30bce62d008049b47f408497d32dccc">annotations</a>()) {</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;linkList().contains(ee)) {</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                              found = <span class="keyword">true</span>;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                              }</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                        }</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                  <span class="comment">// remove from mmr if no match found</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                  <span class="keywordflow">if</span> (!found)</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1RemoveElement.html">RemoveElement</a>(e));</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                  }</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            }</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* nm = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ? lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">next</a>() : lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>();</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4c552b7fbbd974800106c2e1edfe8517">setNext</a>(nm);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      mmr-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5a6ecdc9edbbef845313a1048311dc40">setPrev</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">prev</a>());</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      }</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">// validMMRestMeasure</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">//    return true if this might be a measure in a</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">//    multi measure rest</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"><a class="line" href="namespaceMs.html#a109fc606d9239dddfd029040503d453c"> 2372</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a109fc606d9239dddfd029040503d453c">validMMRestMeasure</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m)</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      {</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a01e69b6f8d32b6eb8f28bdf9ed370f56">irregular</a>())</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <span class="keywordtype">int</span> n = 0;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>()) {</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                  <span class="keywordflow">if</span> (!(e-&gt;isRehearsalMark() || e-&gt;isTempoText() || e-&gt;isHarmony() || e-&gt;isStaffText() || e-&gt;isSystemText() || e-&gt;isInstrumentChange()))</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                  }</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            <span class="keywordflow">if</span> (s-&gt;isChordRestType()) {</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                  <span class="keywordtype">bool</span> restFound = <span class="keyword">false</span>;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                  <span class="keywordtype">int</span> tracks = m-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a>();</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = 0; track &lt; tracks; ++track) {</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                        <span class="keywordflow">if</span> ((track % <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>) == 0 &amp;&amp; !m-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(track/VOICES)-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>()) {</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                              track += VOICES-1;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                              }</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                        <span class="keywordflow">if</span> (s-&gt;element(track))  {</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                              <span class="keywordflow">if</span> (!s-&gt;element(track)-&gt;isRest())</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                              restFound = <span class="keyword">true</span>;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                              }</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                        }</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;isFermata())</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;                              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                        }</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                  <span class="keywordflow">if</span> (restFound)</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                        ++n;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                  <span class="comment">// measure is not empty if there is more than one rest</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                  <span class="keywordflow">if</span> (n &gt; 1)</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                  }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            }</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      }</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">//  breakMultiMeasureRest</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">//    return true if this measure should start a new</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">//    multi measure rest</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;</div><div class="line"><a name="l02417"></a><span class="lineno"><a class="line" href="namespaceMs.html#a105a71265c435455f12f9198895fb3ee"> 2417</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a105a71265c435455f12f9198895fb3ee">breakMultiMeasureRest</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m)</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      {</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1Measure.html#adcb12997b0fc5b963013139a4e1f3921">breakMultiMeasureRest</a>())</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>()</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;         || (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>() &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>()-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2137ef7315aaed4adc68372946380d2c">repeatEnd</a>())</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;         || (m-&gt;<a class="code" href="classMs_1_1Measure.html#aaf1d634e5b6782073f551ccf9e6b4481">isIrregular</a>())</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;         || (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>() &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>()-&gt;<a class="code" href="classMs_1_1Measure.html#aaf1d634e5b6782073f551ccf9e6b4481">isIrregular</a>())</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;         || (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>() &amp;&amp; (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>()-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>())))</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="keyword">auto</span> sl = m-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#aec3ae8afe6d74337ccdaf50a735f4c92">spannerMap</a>().<a class="code" href="classMs_1_1SpannerMap.html#a50d0c4abc63052ad825a4c48cc72dbd3">findOverlapping</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>().<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>(), m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>().<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>());</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : sl) {</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            <a class="code" href="classMs_1_1Spanner.html">Spanner</a>* s = i.value;</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;            <span class="comment">// break for first measure of volta or textline and first measure *after* volta</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            <span class="keywordflow">if</span> ((s-&gt;isVolta() || s-&gt;isTextLine()) &amp;&amp; (s-&gt;<a class="code" href="classMs_1_1Spanner.html#a825bfba09be9b0598940b854ba494312">tick</a>() == m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() || s-&gt;<a class="code" href="classMs_1_1Spanner.html#affc33cb9d3e419eb2c5a52ecb9e44736">tick2</a>() == m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()))</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            }</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <span class="comment">// break for marker in this measure</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0832f1270b77762f3c12758fe22c3c2">el</a>()) {</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;            <span class="keywordflow">if</span> (e-&gt;isMarker()) {</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                  <a class="code" href="classMs_1_1Marker.html">Marker</a>* mark = toMarker(e);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                  <span class="keywordflow">if</span> (!(mark-&gt;align() &amp; <a class="code" href="namespaceMs.html#a94b50213647d6de824820f47673bd500a21507b40c80068eda19865706fdc2403">Align::RIGHT</a>))</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                  }</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            }</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="comment">// break for marker &amp; jump in previous measure</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <a class="code" href="classMs_1_1Measure.html">Measure</a>* pm = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>();</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="keywordflow">if</span> (pm) {</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : pm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0832f1270b77762f3c12758fe22c3c2">el</a>()) {</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isJump())</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;isMarker()) {</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                        <a class="code" href="classMs_1_1Marker.html">Marker</a>* mark = toMarker(e);</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                        <span class="keywordflow">if</span> (mark-&gt;align() &amp; <a class="code" href="namespaceMs.html#a94b50213647d6de824820f47673bd500a21507b40c80068eda19865706fdc2403">Align::RIGHT</a>)</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                        }</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                  }</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            }</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>()) {</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                  <span class="keywordflow">if</span> (!e-&gt;visible())</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isRehearsalMark() ||</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                      e-&gt;isTempoText() ||</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                      ((e-&gt;isHarmony() || e-&gt;isStaffText() || e-&gt;isSystemText() || e-&gt;isInstrumentChange()) &amp;&amp; (e-&gt;systemFlag() || m-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(e-&gt;staffIdx())-&gt;show())))</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                  }</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; m-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                  <span class="keywordflow">if</span> (!m-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>())</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* e = s-&gt;element(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                  <span class="keywordflow">if</span> (!e || e-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>())</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                  <span class="keywordflow">if</span> (s-&gt;isStartRepeatBarLineType())</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                  <span class="keywordflow">if</span> (s-&gt;isType(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ac9bacf3e6728a92c9bf826c740ae5436">SegmentType::KeySig</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb">SegmentType::TimeSig</a>) &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>().<a class="code" href="classMs_1_1Fraction.html#ab7f69a821d6b59f4e448eb3e5ecb33fa">isNotZero</a>())</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                  <span class="keywordflow">if</span> (s-&gt;isClefType()) {</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                        <span class="keywordflow">if</span> (s-&gt;tick() != m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>() &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>().<a class="code" href="classMs_1_1Fraction.html#ab7f69a821d6b59f4e448eb3e5ecb33fa">isNotZero</a>())</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                        }</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                  }</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            }</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="keywordflow">if</span> (pm) {</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = pm-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d">SegmentType::EndBarLine</a>, pm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>());</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <span class="keywordflow">if</span> (s) {</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                        <a class="code" href="classMs_1_1BarLine.html">BarLine</a>* bl = toBarLine(s-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>));</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                        <span class="keywordflow">if</span> (bl) {</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                              <a class="code" href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914f">BarLineType</a> t = bl-&gt;<a class="code" href="classMs_1_1BarLine.html#a4a0426d2e0676bda9cca5f61388cbcf6">barLineType</a>();</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                              <span class="keywordflow">if</span> (t != <a class="code" href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914fa1e23852820b9154316c7c06e2b7ba051">BarLineType::NORMAL</a> &amp;&amp; t != <a class="code" href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914fa10c4a304905dd48439743b393540ce88">BarLineType::BROKEN</a> &amp;&amp; t != <a class="code" href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914faede91669dcab48ceb3bc9cfb08bf0605">BarLineType::DOTTED</a> &amp;&amp; !bl-&gt;<a class="code" href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">generated</a>())</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                              }</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                        }</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                  }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="keywordflow">if</span> (pm-&gt;<a class="code" href="classMs_1_1Measure.html#a66a3e42855dec1d88936966d197a0ac0">findSegment</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041">SegmentType::Clef</a>, m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()))</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            }</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      }</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">//   adjustMeasureNo</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div><div class="line"><a name="l02509"></a><span class="lineno"><a class="line" href="structMs_1_1LayoutContext.html#ae0e98f18c6aade818eb0c8594cebc69c"> 2509</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="structMs_1_1LayoutContext.html#ae0e98f18c6aade818eb0c8594cebc69c">LayoutContext::adjustMeasureNo</a>(<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* m)</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      {</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      measureNo += m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a29b7c1273c42ffbceaed3be455a8eff1">noOffset</a>();</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2aaffc490540f2744696b3ffda1fd66a">setNo</a>(measureNo);</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="keywordflow">if</span> (!m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a01e69b6f8d32b6eb8f28bdf9ed370f56">irregular</a>())          <span class="comment">// don’t count measure</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            ++measureNo;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>() &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>()-&gt;<a class="code" href="classMs_1_1LayoutBreak.html#a160b67956d9b958c49cfd08b81b55868">startWithMeasureOne</a>())</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            measureNo = 0;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="keywordflow">return</span> measureNo;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      }</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">//   createBeams</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">//    helper function</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;</div><div class="line"><a name="l02525"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a29c760c918a400d7fb360c44da0e3ed1"> 2525</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a29c760c918a400d7fb360c44da0e3ed1">Score::createBeams</a>(<a class="code" href="structMs_1_1LayoutContext.html">LayoutContext</a>&amp; lc, <a class="code" href="classMs_1_1Measure.html">Measure</a>* <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a>)</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      {</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      <span class="keywordtype">bool</span> crossMeasure = <a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea573e8a963f644296eee0dd671585b1ee">Sid::crossMeasureValues</a>);</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = 0; track &lt; <a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a>(); ++track) {</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            <a class="code" href="classMs_1_1Staff.html">Staff</a>* stf = <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(<a class="code" href="namespaceMs.html#ae665d4585b944f2ec91a33a5c89732bd">track2staff</a>(track));</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            <span class="comment">// don’t compute beams for invisible staves and tablature without stems</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            <span class="keywordflow">if</span> (!stf-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>() || (stf-&gt;<a class="code" href="classMs_1_1Staff.html#afdd8a358b8e40b9e02bca11e9fbb8829">isTabStaff</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()) &amp;&amp; stf-&gt;<a class="code" href="classMs_1_1Staff.html#ad248bef7f25a4fe152ce281372a24d3f">staffType</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>())-&gt;stemless()))</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* a1    = 0;      <span class="comment">// start of (potential) beam</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            <span class="keywordtype">bool</span> firstCR     = <span class="keyword">true</span>;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            <a class="code" href="classMs_1_1Beam.html">Beam</a>* beam       = 0;      <span class="comment">// current beam</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fe">Beam::Mode</a> bm    = <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feae1f2d5134ed2543d38a0de9751cf75d9">Beam::Mode::AUTO</a>;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* prev  = 0;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="keywordtype">bool</span> checkBeats  = <span class="keyword">false</span>;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            <a class="code" href="classMs_1_1Fraction.html">Fraction</a> stretch = <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(1,1);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            QHash&lt;int, TDuration&gt; beatSubdivision;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            <span class="comment">// if this measure is simple meter (actually X/4),</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            <span class="comment">// then perform a prepass to determine the subdivision of each beat</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            beatSubdivision.clear();</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;            <a class="code" href="classMs_1_1TimeSig.html">TimeSig</a>* ts = stf-&gt;<a class="code" href="classMs_1_1Staff.html#ab6ff6aba127497e2aa116b01ca73b563">timeSig</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>());</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;            checkBeats  = <span class="keyword">false</span>;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            stretch     = ts ? ts-&gt;<a class="code" href="classMs_1_1TimeSig.html#a48f845d7303e0445e4d9bb220873accc">stretch</a>() : <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(1,1);</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894">SegmentType</a> st = <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            <span class="keywordflow">if</span> (ts &amp;&amp; ts-&gt;<a class="code" href="classMs_1_1TimeSig.html#abed8eb110fc91cb3bbf8312d71c8c763">denominator</a>() == 4) {</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                  checkBeats = <span class="keyword">true</span>;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = measure-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(st); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>(st)) {</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                        <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* mcr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(s-&gt;element(track));</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                        <span class="keywordflow">if</span> (mcr == 0)</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                        <span class="keywordtype">int</span> beat = (mcr-&gt;<a class="code" href="classMs_1_1Element.html#ad4608ce52672a6b42930af320d9de2ef">rtick</a>() * stretch).ticks() / <a class="code" href="classMs_1_1MScore.html#a11b6172fa0289a8eaad4b8f7b995f817">MScore::division</a>;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                        <span class="keywordflow">if</span> (beatSubdivision.contains(beat))</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                              beatSubdivision[beat] = qMin(beatSubdivision[beat], mcr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>());</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                              beatSubdivision[beat] = mcr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>();</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                        }</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                  }</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* segment = measure-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(st); segment; segment = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>(st)) {</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                  <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = segment-&gt;cr(track);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                  <span class="keywordflow">if</span> (cr == 0)</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                  <span class="keywordflow">if</span> (firstCR) {</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                        firstCR = <span class="keyword">false</span>;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                        <span class="comment">// Handle cross-measure beams</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                        <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fe">Beam::Mode</a> mode = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a9103d7e3ecf91f604d7bfd8a529ef09d">beamMode</a>();</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                        <span class="keywordflow">if</span> (mode == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea18e48bbdf6d326bd88d3ebb99ad7515d">Beam::Mode::MID</a> || mode == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab1a326c06d88bf042f73d70f50197905">Beam::Mode::END</a>) {</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                              <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* prevCR = <a class="code" href="classMs_1_1Score.html#aad15f62a3b7005066fff26ef0012874e">findCR</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() - <a class="code" href="classMs_1_1Fraction.html#a63e242155373d30a2de43750ea718368">Fraction::fromTicks</a>(1), track);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                              <span class="keywordflow">if</span> (prevCR) {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classMs_1_1Measure.html">Measure</a>* pm = prevCR-&gt;<a class="code" href="classMs_1_1ChordRest.html#aaa704d32c5e4253d54d722276f507e2d">measure</a>();</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                                    <span class="keywordflow">if</span> (!<a class="code" href="namespaceMs.html#afa6870c3c1f6f75078e098386e4a6bdf">beamNoContinue</a>(prevCR-&gt;<a class="code" href="classMs_1_1ChordRest.html#a9103d7e3ecf91f604d7bfd8a529ef09d">beamMode</a>())</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                                        &amp;&amp; !pm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ad4153b0dbfe2fb2a229fd93a45c71f7b">lineBreak</a>() &amp;&amp; !pm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6c58c83a689bd9d8caa462ab3559b176">pageBreak</a>() &amp;&amp; !pm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>()</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                                        &amp;&amp; lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                                        &amp;&amp; !(prevCR-&gt;isChord() &amp;&amp; prevCR-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>().<a class="code" href="classMs_1_1TDuration.html#a123168fe235332a63c716e041fc3ddd5">type</a>() &lt;= <a class="code" href="classMs_1_1TDuration.html#ad9263bf173856b77421e83a48a7bf68ca05e8f1c139e16d278117c17e7fc13ef6">TDuration::DurationType::V_QUARTER</a>)) {</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                                          beam = prevCR-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                                          <span class="comment">//a1 = beam ? beam-&gt;elements().front() : prevCR;</span></div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                                          a1 = beam ? nullptr : prevCR; <span class="comment">// when beam is found, a1 is no longer required.</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                                          }</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                                    }</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                              }</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                        }</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                        <span class="keywordflow">if</span> (l)</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                              l-&gt;<a class="code" href="classMs_1_1Element.html#a3ae68f5da280c53fd1d329f20601818b">layout</a>();</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                        }</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                  <span class="comment">// handle grace notes and cross-measure beaming</span></div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                  <span class="comment">// (tied chords?)</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                  <span class="keywordflow">if</span> (cr-&gt;isChord()) {</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                        <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = toChord(cr);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a38ee585135744839b5ac1eb26f0da0f5">beamGraceNotes</a>(chord, <span class="keyword">false</span>); <span class="comment">// grace before</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a38ee585135744839b5ac1eb26f0da0f5">beamGraceNotes</a>(chord, <span class="keyword">true</span>);  <span class="comment">// grace after</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                        <span class="comment">// set up for cross-measure values as soon as possible</span></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                        <span class="comment">// to have all computations (stems, hooks, ...) consistent with it</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                        <span class="keywordflow">if</span> (!chord-&gt;<a class="code" href="classMs_1_1Chord.html#a6071a1241456ef93c8a06c62269090a7">isGrace</a>())</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                              chord-&gt;<a class="code" href="classMs_1_1Chord.html#afe0530ec07045553559ded6c16d5dd6c">crossMeasureSetup</a>(crossMeasure);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                        }</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                  <span class="keywordflow">if</span> (cr-&gt;isRest() &amp;&amp; cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a9103d7e3ecf91f604d7bfd8a529ef09d">beamMode</a>() == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feae1f2d5134ed2543d38a0de9751cf75d9">Beam::Mode::AUTO</a>)</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                        bm = <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693">Beam::Mode::NONE</a>;           <span class="comment">// do not beam rests set to Beam::Mode::AUTO</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                        bm = <a class="code" href="classMs_1_1Groups.html#a941048b9a1849553fefa03c781b06c65">Groups::endBeam</a>(cr, prev);  <span class="comment">// get defaults from time signature properties</span></div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                  <span class="comment">// perform additional context-dependent checks</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                  <span class="keywordflow">if</span> (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feae1f2d5134ed2543d38a0de9751cf75d9">Beam::Mode::AUTO</a>) {</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                        <span class="comment">// check if we need to break beams according to minimum duration in current / previous beat</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                        <span class="keywordflow">if</span> (checkBeats &amp;&amp; cr-&gt;<a class="code" href="classMs_1_1Element.html#ad4608ce52672a6b42930af320d9de2ef">rtick</a>().<a class="code" href="classMs_1_1Fraction.html#ab7f69a821d6b59f4e448eb3e5ecb33fa">isNotZero</a>()) {</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                              <a class="code" href="classMs_1_1Fraction.html">Fraction</a> <a class="code" href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a> = cr-&gt;<a class="code" href="classMs_1_1Element.html#ad4608ce52672a6b42930af320d9de2ef">rtick</a>() * stretch;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                              <span class="comment">// check if on the beat</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                              <span class="keywordflow">if</span> ((tick.<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>() % <a class="code" href="classMs_1_1MScore.html#a11b6172fa0289a8eaad4b8f7b995f817">MScore::division</a>) == 0) {</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                                    <span class="keywordtype">int</span> beat = tick.<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>() / <a class="code" href="classMs_1_1MScore.html#a11b6172fa0289a8eaad4b8f7b995f817">MScore::division</a>;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                                    <span class="comment">// get minimum duration for this &amp; previous beat</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                                    <a class="code" href="classMs_1_1TDuration.html">TDuration</a> minDuration = qMin(beatSubdivision[beat], beatSubdivision[beat - 1]);</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                                    <span class="comment">// re-calculate beam as if this were the duration of current chordrest</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                                    <a class="code" href="classMs_1_1TDuration.html">TDuration</a> saveDuration        = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a6802d9faa8168c8425b8dcb3d11d2edb">actualDurationType</a>();</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                                    <a class="code" href="classMs_1_1TDuration.html">TDuration</a> saveCMDuration      = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a1564e474208b08b6bdb6cb0ffce38b08">crossMeasureDurationType</a>();</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                                    <a class="code" href="namespaceMs.html#a1d19008c03cb6d496010a5451a9a5e71">CrossMeasure</a> saveCrossMeasVal = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a34e17dca66c25cbd046523dc0c1c7978">crossMeasure</a>();</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                                    cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#adc6b9aa10c0b149eea492432ceeb3ce3">setDurationType</a>(minDuration);</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                                    bm = <a class="code" href="classMs_1_1Groups.html#a941048b9a1849553fefa03c781b06c65">Groups::endBeam</a>(cr, prev);</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                                    cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#adc6b9aa10c0b149eea492432ceeb3ce3">setDurationType</a>(saveDuration);</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                                    cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#acc7b8669972325c93c8bc7c819a94b28">setCrossMeasure</a>(saveCrossMeasVal);</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                                    cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad1a47117e08b36e435b627bde7861886">setCrossMeasureDurationType</a>(saveCMDuration);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                                    }</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                              }</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                        }</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                  prev = cr;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;                  <span class="comment">// if chord has hooks and is 2nd element of a cross-measure value</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                  <span class="comment">// set beam mode to NONE (do not combine with following chord beam/hook, if any)</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                  <span class="keywordflow">if</span> (cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>().<a class="code" href="classMs_1_1TDuration.html#a11652d3de9232ccf4fb664758fecfaf3">hooks</a>() &gt; 0 &amp;&amp; cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a34e17dca66c25cbd046523dc0c1c7978">crossMeasure</a>() == <a class="code" href="namespaceMs.html#a1d19008c03cb6d496010a5451a9a5e71a2200becb80f0019c4a2ccecec350d0db">CrossMeasure::SECOND</a>)</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                        bm = <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693">Beam::Mode::NONE</a>;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;                  <span class="keywordflow">if</span> ((cr-&gt;isChord() &amp;&amp; cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">durationType</a>().<a class="code" href="classMs_1_1TDuration.html#a123168fe235332a63c716e041fc3ddd5">type</a>() &lt;= <a class="code" href="classMs_1_1TDuration.html#ad9263bf173856b77421e83a48a7bf68ca05e8f1c139e16d278117c17e7fc13ef6">TDuration::DurationType::V_QUARTER</a>) || (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693">Beam::Mode::NONE</a>)) {</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                        <span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a1c23512c83b57cff9134dee4c7bf009f">removeBeam</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                        <span class="keywordflow">if</span> (beam) {</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                              beam-&gt;<a class="code" href="classMs_1_1Beam.html#aeab5dbce17b6f48fd75b63b46c6a426b">layout1</a>();</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                              removeBeam = (beam-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().size() &lt;= 1);</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;                              beam = 0;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                              }</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                        <span class="keywordflow">if</span> (a1) {</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                              <span class="keywordflow">if</span> (removeBeam)</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                                    a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                              a1 = 0;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                              }</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                        cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                        }</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                  <span class="keywordflow">if</span> (beam) {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                        <span class="keywordtype">bool</span> beamEnd = (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea19aad9f2fe3ce0023298ab83f7e75775">Beam::Mode::BEGIN</a>);</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;                        <span class="keywordflow">if</span> (!beamEnd) {</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;                              cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a688dc7a975a470846cf6ca71d2628af9">replaceBeam</a>(beam);</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                              cr = 0;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                              beamEnd = (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab1a326c06d88bf042f73d70f50197905">Beam::Mode::END</a>);</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                              }</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                        <span class="keywordflow">if</span> (beamEnd) {</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                              beam-&gt;<a class="code" href="classMs_1_1Beam.html#aeab5dbce17b6f48fd75b63b46c6a426b">layout1</a>();</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                              beam = 0;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                              }</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                        }</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                  <span class="keywordflow">if</span> (!cr)</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                  <span class="keywordflow">if</span> (a1 == 0)</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                        a1 = cr;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="layout_8cpp.html#ac9c2a6b16ac8e14d25a6387217db3507">beamModeMid</a>(bm)</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                           &amp;&amp;</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                           (bm == <a class="code" href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea19aad9f2fe3ce0023298ab83f7e75775">Beam::Mode::BEGIN</a></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                              || (a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Segment.html#accf66d981db70ac1bd843ca5e03330a1">segmentType</a>() != cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Segment.html#accf66d981db70ac1bd843ca5e03330a1">segmentType</a>())</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                              || (a1-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>() + a1-&gt;<a class="code" href="classMs_1_1DurationElement.html#a3791beed710457022daf6619f31a1eeb">actualTicks</a>() &lt; cr-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>())</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                              )</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                           )</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                              {</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                              a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                              a1 = cr;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                              }</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                              beam = a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                              <span class="keywordflow">if</span> (beam == 0 || beam-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().front() != a1) {</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                                    beam = <span class="keyword">new</span> <a class="code" href="classMs_1_1Beam.html">Beam</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                                    beam-&gt;<a class="code" href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">setGenerated</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                                    beam-&gt;<a class="code" href="classMs_1_1Element.html#a884bf81982c8c302cbdf79ea567c3ced">setTrack</a>(track);</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                    a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a688dc7a975a470846cf6ca71d2628af9">replaceBeam</a>(beam);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                                    }</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                              cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a688dc7a975a470846cf6ca71d2628af9">replaceBeam</a>(beam);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                              a1 = 0;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                              }</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                        }</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                  }</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;            <span class="keywordflow">if</span> (beam)</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                  beam-&gt;<a class="code" href="classMs_1_1Beam.html#aeab5dbce17b6f48fd75b63b46c6a426b">layout1</a>();</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a1) {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                  <a class="code" href="classMs_1_1Fraction.html">Fraction</a> nextTick = a1-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>() + a1-&gt;<a class="code" href="classMs_1_1DurationElement.html#a3791beed710457022daf6619f31a1eeb">actualTicks</a>();</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = (nextTick &gt;= measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>() ? measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>() : <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a>);</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                  <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* nextCR = (m ? m-&gt;<a class="code" href="classMs_1_1Measure.html#abcc300aa27120a1c799aedfa211aec6d">findChordRest</a>(nextTick, track) : <span class="keyword">nullptr</span>);</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                  <a class="code" href="classMs_1_1Beam.html">Beam</a>* b = a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                  <span class="keywordflow">if</span> (!(b &amp;&amp; b-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().startsWith(a1) &amp;&amp; nextCR &amp;&amp; <a class="code" href="layout_8cpp.html#ac9c2a6b16ac8e14d25a6387217db3507">beamModeMid</a>(nextCR-&gt;<a class="code" href="classMs_1_1ChordRest.html#a9103d7e3ecf91f604d7bfd8a529ef09d">beamMode</a>())))</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                        a1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">removeDeleteBeam</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                  }</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            }</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      }</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment">//   breakCrossMeasureBeams</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;</div><div class="line"><a name="l02721"></a><span class="lineno"><a class="line" href="namespaceMs.html#aa80fcdcc05a733b5f5503f5ebac3913e"> 2721</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#aa80fcdcc05a733b5f5503f5ebac3913e">breakCrossMeasureBeams</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a>)</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      {</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mbNext = measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">next</a>();</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <span class="keywordflow">if</span> (!mbNext || !mbNext-&gt;isMeasure())</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <a class="code" href="classMs_1_1Measure.html">Measure</a>* next = toMeasure(mbNext);</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <a class="code" href="classMs_1_1Score.html">Score</a>* <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a> = measure-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>();</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a> = score-&gt;<a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a>();</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* fstSeg = next-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>);</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <span class="keywordflow">if</span> (!fstSeg)</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = 0; track &lt; <a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a>; ++track) {</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;            <a class="code" href="classMs_1_1Staff.html">Staff</a>* stf = score-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(<a class="code" href="namespaceMs.html#ae665d4585b944f2ec91a33a5c89732bd">track2staff</a>(track));</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;            <span class="comment">// don’t compute beams for invisible staves and tablature without stems</span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;            <span class="keywordflow">if</span> (!stf-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>() || (stf-&gt;<a class="code" href="classMs_1_1Staff.html#afdd8a358b8e40b9e02bca11e9fbb8829">isTabStaff</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()) &amp;&amp; stf-&gt;<a class="code" href="classMs_1_1Staff.html#ad248bef7f25a4fe152ce281372a24d3f">staffType</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>())-&gt;stemless()))</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            <a class="code" href="classMs_1_1Element.html">Element</a>* e = fstSeg-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(track);</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            <span class="keywordflow">if</span> (!e || !e-&gt;<a class="code" href="classMs_1_1ScoreElement.html#accef1c91df491a43c54e70474deea60c">isChordRest</a>())</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <a class="code" href="classMs_1_1Beam.html">Beam</a>* beam = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            <span class="keywordflow">if</span> (!beam || beam-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().front()-&gt;measure() == next) <span class="comment">// no beam or not cross-measure beam</span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            std::vector&lt;ChordRest*&gt; mElements;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            std::vector&lt;ChordRest*&gt; nextElements;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* beamCR : beam-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>()) {</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                  <span class="keywordflow">if</span> (beamCR-&gt;measure() == <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a>)</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                        mElements.push_back(beamCR);</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                        nextElements.push_back(beamCR);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                  }</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;            <span class="keywordflow">if</span> (mElements.size() == 1)</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                  mElements[0]-&gt;removeDeleteBeam(<span class="keyword">false</span>);</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            <a class="code" href="classMs_1_1Beam.html">Beam</a>* newBeam = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            <span class="keywordflow">if</span> (nextElements.size() &gt; 1) {</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                  newBeam = <span class="keyword">new</span> <a class="code" href="classMs_1_1Beam.html">Beam</a>(score);</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                  newBeam-&gt;<a class="code" href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">setGenerated</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                  newBeam-&gt;<a class="code" href="classMs_1_1Element.html#a884bf81982c8c302cbdf79ea567c3ced">setTrack</a>(track);</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                  }</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> nextBeamed = bool(newBeam);</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* nextCR : nextElements) {</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                  nextCR-&gt;removeDeleteBeam(nextBeamed);</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                  <span class="keywordflow">if</span> (newBeam)</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                        newBeam-&gt;<a class="code" href="classMs_1_1Beam.html#a992a7da1c28a530754bfa2cf5cde85a1">add</a>(nextCR);</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                  }</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            <span class="keywordflow">if</span> (newBeam)</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                  newBeam-&gt;<a class="code" href="classMs_1_1Beam.html#aeab5dbce17b6f48fd75b63b46c6a426b">layout1</a>();</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            }</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      }</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">//   layoutDrumsetChord</span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;</div><div class="line"><a name="l02786"></a><span class="lineno"><a class="line" href="namespaceMs.html#a43546ea8d8f5343ffe26bcdd5d53ef8d"> 2786</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a43546ea8d8f5343ffe26bcdd5d53ef8d">layoutDrumsetChord</a>(<a class="code" href="classMs_1_1Chord.html">Chord</a>* c, <span class="keyword">const</span> <a class="code" href="classMs_1_1Drumset.html">Drumset</a>* drumset, <span class="keyword">const</span> <a class="code" href="classMs_1_1StaffType.html">StaffType</a>* st, qreal <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>)</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      {</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Note.html">Note</a>* note : c-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>()) {</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;            <span class="keywordtype">int</span> pitch = note-&gt;pitch();</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;            <span class="keywordflow">if</span> (!drumset-&gt;<a class="code" href="classMs_1_1Drumset.html#a0c116c7a1faa14e7d3f5b583561f5245">isValid</a>(pitch)) {</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                  <span class="comment">// qDebug(&quot;unmapped drum note %d&quot;, pitch);</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                  }</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!note-&gt;fixed()) {</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                  note-&gt;undoChangeProperty(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a5d15377f29d4bca438ef8a339555af95">Pid::HEAD_GROUP</a>, <span class="keywordtype">int</span>(drumset-&gt;<a class="code" href="classMs_1_1Drumset.html#a57e943db32934a5f5b85f56d6cc5dc47">noteHead</a>(pitch)));</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                  <span class="keywordtype">int</span> line = drumset-&gt;<a class="code" href="classMs_1_1Drumset.html#a19e7739fa57e35a79928fa58766d9c5a">line</a>(pitch);</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                  note-&gt;setLine(line);</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                  <span class="keywordtype">int</span> off  = st-&gt;<a class="code" href="classMs_1_1StaffType.html#ae0ffb4991a51dd2715b6a7104f4caca3">stepOffset</a>();</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                  qreal ld = st-&gt;<a class="code" href="classMs_1_1StaffType.html#a8573023e9149c33b1dc28e8e841e21ca">lineDistance</a>().<a class="code" href="classMs_1_1Spatium.html#ab21fa50b8ec92de51fb08a2365770422">val</a>();</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                  note-&gt;rypos()  = (line + off * 2.0) * spatium * .5 * ld;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                  }</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            }</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      }</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment">//   extendedStemLenWithTwoNotesTremolo</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment">//    Goal: To extend stem of one of the chords to make the tremolo less steep</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment">//    Returns a modified pair of stem lengths of two chords</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div><div class="line"><a name="l02811"></a><span class="lineno"><a class="line" href="namespaceMs.html#a8a1496edbc37ad47b5c22a3a5edf419d"> 2811</a></span>&#160;std::pair&lt;qreal, qreal&gt; <a class="code" href="namespaceMs.html#a8a1496edbc37ad47b5c22a3a5edf419d">extendedStemLenWithTwoNoteTremolo</a>(<a class="code" href="classMs_1_1Tremolo.html">Tremolo</a>* tremolo, qreal stemLen1, qreal stemLen2)</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      {</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      <span class="keyword">const</span> qreal <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a> = tremolo-&gt;<a class="code" href="classMs_1_1Element.html#a9f375d79304c4cec5b45ea883c9efc86">spatium</a>();</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <a class="code" href="classMs_1_1Chord.html">Chord</a>* c1 = tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#af3fbc117c926f4bc9bd5f0ee3e8ad478">chord1</a>();</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      <a class="code" href="classMs_1_1Chord.html">Chord</a>* c2 = tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">chord2</a>();</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <a class="code" href="classMs_1_1Stem.html">Stem</a>*  s1 = c1-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>();</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <a class="code" href="classMs_1_1Stem.html">Stem</a>*  s2 = c2-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>();</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="keyword">const</span> qreal sgn1 = c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() ? -1.0 : 1.0;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="keyword">const</span> qreal sgn2 = c2-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() ? -1.0 : 1.0;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      <span class="keyword">const</span> qreal stemTipDistance = (s1 &amp;&amp; s2) ? (s2-&gt;<a class="code" href="classMs_1_1Element.html#a06cc027fe14db0cf896f02931356ae24">pagePos</a>().y() + stemLen2) - (s1-&gt;<a class="code" href="classMs_1_1Element.html#a06cc027fe14db0cf896f02931356ae24">pagePos</a>().y() + stemLen1)</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;         : (c2-&gt;<a class="code" href="classMs_1_1Chord.html#aadbf45e4cc8747dd4bbdf585c5fdddb7">stemPos</a>().y() + stemLen2) - (c1-&gt;<a class="code" href="classMs_1_1Chord.html#aadbf45e4cc8747dd4bbdf585c5fdddb7">stemPos</a>().y() + stemLen1);</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="comment">// same staff &amp; same direction: extend one of the stems</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <span class="keywordflow">if</span> (c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() == c2-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() &amp;&amp; c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() == c2-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>()) {</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> stem1Higher = stemTipDistance &gt; 0.0;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            <span class="keywordflow">if</span> (std::abs(stemTipDistance) &gt; 1.0 * <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>) {</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                  <span class="keywordflow">if</span> ((c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() &amp;&amp; !stem1Higher) || (!c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() &amp;&amp; stem1Higher))</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                        <span class="keywordflow">return</span> { stemLen1 + sgn1 * (std::abs(stemTipDistance) - 1.0 * <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>), stemLen2 };</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                  <span class="keywordflow">else</span> <span class="comment">/* if ((c1-&gt;up() &amp;&amp; stem1Higher) || (!c1-&gt;up() &amp;&amp; !stem1Higher)) */</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                        <span class="keywordflow">return</span> { stemLen1, stemLen2 + sgn2 * (std::abs(stemTipDistance) - 1.0 * <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>) };</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                  }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;            }</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="comment">// TODO: cross-staff two-note tremolo. Currently doesn&#39;t generate the right result in some cases.</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      <span class="comment">// cross-staff &amp; beam between staves: extend both stems by the same length</span></div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#a3406a68198349ff0e9516ec040dfb40c">crossStaffBeamBetween</a>()) {</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;            <span class="keyword">const</span> qreal sw = tremolo-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a64f76d8f29e50d9cb8bfda72fbf62d2c">styleS</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eafc0415d5a6fdf38990713e10a6d18ac2">Sid::tremoloStrokeWidth</a>).<a class="code" href="classMs_1_1Spatium.html#ab21fa50b8ec92de51fb08a2365770422">val</a>();</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;            <span class="keyword">const</span> qreal td = tremolo-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a64f76d8f29e50d9cb8bfda72fbf62d2c">styleS</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea2699e0ac7f36e1099d48db3e5706992f">Sid::tremoloDistance</a>).<a class="code" href="classMs_1_1Spatium.html#ab21fa50b8ec92de51fb08a2365770422">val</a>();</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            <span class="keyword">const</span> qreal tremoloMinHeight = ((tremolo-&gt;<a class="code" href="classMs_1_1Tremolo.html#a3c2a1a737f7fb1fa190291b63ce118f4">lines</a>() - 1) * td + sw) * <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;            <span class="keyword">const</span> qreal dy = c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">up</a>() ? tremoloMinHeight - stemTipDistance : tremoloMinHeight + stemTipDistance;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> tooShort = dy &gt; 1.0 * <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> tooLong = dy &lt; -1.0 * <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            <span class="keyword">const</span> qreal idealDistance = 1.0 * spatium - tremoloMinHeight;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;            <span class="keywordflow">if</span> (tooShort)</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                  <span class="keywordflow">return</span> { stemLen1 + sgn1 * (std::abs(stemTipDistance) - idealDistance) / 2.0,</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                           stemLen2 + sgn2 * (std::abs(stemTipDistance) - idealDistance) / 2.0 };</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tooLong)</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                  <span class="keywordflow">return</span> { stemLen1 - sgn1 * (std::abs(stemTipDistance) + idealDistance) / 2.0,</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                           stemLen2 - sgn2 * (std::abs(stemTipDistance) + idealDistance) / 2.0 };</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;            }</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      <span class="keywordflow">return</span> { stemLen1, stemLen2 };</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      }</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment">//   getNextMeasure</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div><div class="line"><a name="l02862"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de"> 2862</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de">Score::getNextMeasure</a>(<a class="code" href="structMs_1_1LayoutContext.html">LayoutContext</a>&amp; lc)</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;      {</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>  = lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="keywordflow">if</span> (!lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ? <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a>() : <a class="code" href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">firstMeasure</a>();</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ? lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">next</a>() : lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>();</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="keywordflow">if</span> (!lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      <span class="keywordtype">int</span> mno = lc.<a class="code" href="structMs_1_1LayoutContext.html#ae0e98f18c6aade818eb0c8594cebc69c">adjustMeasureNo</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isMeasure()) {</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea83a473e523160149b1f60621fcba0b5b">Sid::createMultiMeasureRests</a>)) {</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* nm = m;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* lm = nm;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                  <span class="keywordtype">int</span> n       = 0;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                  <a class="code" href="classMs_1_1Fraction.html">Fraction</a> len;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                  <span class="keywordflow">while</span> (<a class="code" href="namespaceMs.html#a109fc606d9239dddfd029040503d453c">validMMRestMeasure</a>(nm)) {</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                        <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ? nm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">next</a>() : nm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>();</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a105a71265c435455f12f9198895fb3ee">breakMultiMeasureRest</a>(nm) &amp;&amp; n)</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                        <span class="keywordflow">if</span> (nm != m)</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                              lc.<a class="code" href="structMs_1_1LayoutContext.html#ae0e98f18c6aade818eb0c8594cebc69c">adjustMeasureNo</a>(nm);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                        ++n;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                        len += nm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>();</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                        lm = nm;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                        <span class="keywordflow">if</span> (!(mb &amp;&amp; mb-&gt;isMeasure()))</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                        nm = toMeasure(mb);</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                        }</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                  <span class="keywordflow">if</span> (n &gt;= <a class="code" href="classMs_1_1Score.html#a979a12736465161f2e680cd26df8c0a3">styleI</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea7c57c1a271c9009fd6ca44f199ed31de">Sid::minEmptyMeasures</a>)) {</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                        <a class="code" href="classMs_1_1Score.html#a4aefe9ae9c020b436a6dfca0a9129531">createMMRest</a>(m, lm, len);</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>  = m-&gt;<a class="code" href="classMs_1_1Measure.html#a9109c2c9621f0cc9ecd86afcae54afe8">mmRest</a>();</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ?  lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">next</a>() : lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>();</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                        }</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                        <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1Measure.html#a9109c2c9621f0cc9ecd86afcae54afe8">mmRest</a>())</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">undo</a>(<span class="keyword">new</span> <a class="code" href="classMs_1_1ChangeMMRest.html">ChangeMMRest</a>(m, 0));</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                        m-&gt;<a class="code" href="classMs_1_1Measure.html#a405ecf7ac85a17e4285644b04a8085d0">setMMRestCount</a>(0);</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">measureNo</a> = mno;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                        }</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                  }</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)-&gt;isMMRest()) {</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                  qDebug(<span class="stringliteral">&quot;mmrest: no %d += %d&quot;</span>, lc.<a class="code" href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">measureNo</a>, toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)-&gt;mmRestCount());</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">measureNo</a> += toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)-&gt;mmRestCount() - 1;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                  }</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            }</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="keywordflow">if</span> (!lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isMeasure()) {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#abbb8a43c3c9cdb1a3cce412bfe4409ef">setTick</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">tick</a>);</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;            }</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="comment">//-----------------------------------------</span></div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <span class="comment">//    process one measure</span></div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="comment">//-----------------------------------------</span></div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <a class="code" href="classMs_1_1Measure.html">Measure</a>* <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a> = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      measure-&gt;<a class="code" href="classMs_1_1Measure.html#ae612bd158973276baba3df65f1e5d9d4">moveTicks</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">tick</a> - measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>());</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a7e623a06766698ff471836eac2f3fa57">lineMode</a>() &amp;&amp; (measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() &lt; lc.<a class="code" href="structMs_1_1LayoutContext.html#a19322e850e35356fc301b735ed3900c8">startTick</a> || measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() &gt; lc.<a class="code" href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">endTick</a>)) {</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;            <span class="comment">// needed to reset segment widths if they can change after measure width is computed</span></div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;            <span class="comment">//for (Segment&amp; s : measure-&gt;segments())</span></div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;            <span class="comment">//      s.createShapes();</span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">tick</a> += measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>();</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;            }</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      measure-&gt;<a class="code" href="classMs_1_1Measure.html#a772e278641842c27ed84b4234f339e55">connectTremolo</a>();</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <span class="comment">// calculate accidentals and note lines,</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <span class="comment">// create stem and set stem direction</span></div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;            <span class="keyword">const</span> <a class="code" href="classMs_1_1Staff.html">Staff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>     = <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">Score::staff</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            <span class="keyword">const</span> <a class="code" href="classMs_1_1Drumset.html">Drumset</a>* drumset = staff-&gt;<a class="code" href="classMs_1_1Staff.html#ae31dc0de799c1e206af979e65bf837ab">part</a>()-&gt;<a class="code" href="classMs_1_1Part.html#a6cae82662abe64d683dff09b3c7874f8">instrument</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>())-&gt;useDrumset() ? staff-&gt;<a class="code" href="classMs_1_1Staff.html#ae31dc0de799c1e206af979e65bf837ab">part</a>()-&gt;<a class="code" href="classMs_1_1Part.html#a6cae82662abe64d683dff09b3c7874f8">instrument</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>())-&gt;drumset() : 0;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;            <a class="code" href="classMs_1_1AccidentalState.html">AccidentalState</a> as;      <span class="comment">// list of already set accidentals for this measure</span></div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            as.<a class="code" href="classMs_1_1AccidentalState.html#a3d8092df8cff6239b00865e957610f9e">init</a>(staff-&gt;<a class="code" href="classMs_1_1Staff.html#a39233bf07b8a9434df49fd14fa92fb12">keySigEvent</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()), staff-&gt;<a class="code" href="classMs_1_1Staff.html#a44fa196161dc82a567582d7acd4f8cca">clef</a>(measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()));</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; segment : measure-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                  <span class="comment">// TODO? maybe we do need to process it here to make it possible to enable later</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                  <span class="comment">//if (!segment.enabled())</span></div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                  <span class="comment">//      continue;</span></div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                  <span class="keywordflow">if</span> (segment.isKeySigType()) {</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                        <a class="code" href="classMs_1_1KeySig.html">KeySig</a>* ks = toKeySig(segment.element(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>));</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                        <span class="keywordflow">if</span> (!ks)</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                        <a class="code" href="classMs_1_1Fraction.html">Fraction</a> <a class="code" href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a> = segment.tick();</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                        as.<a class="code" href="classMs_1_1AccidentalState.html#a3d8092df8cff6239b00865e957610f9e">init</a>(staff-&gt;<a class="code" href="classMs_1_1Staff.html#a39233bf07b8a9434df49fd14fa92fb12">keySigEvent</a>(tick), staff-&gt;<a class="code" href="classMs_1_1Staff.html#a44fa196161dc82a567582d7acd4f8cca">clef</a>(tick));</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                        ks-&gt;<a class="code" href="classMs_1_1KeySig.html#a50ff6fe9275deb66132ebc4166bf8207">layout</a>();</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                        }</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (segment.isChordRestType()) {</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classMs_1_1StaffType.html">StaffType</a>* st = staff-&gt;<a class="code" href="classMs_1_1Staff.html#ab6c2b0280a3c3de384d8a1b6b721e5b6">staffTypeForElement</a>(&amp;segment);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                        <span class="keywordtype">int</span> track     = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                        <span class="keywordtype">int</span> endTrack  = track + <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = track; t &lt; endTrack; ++t) {</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                              <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = segment.cr(t);</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                              <span class="keywordflow">if</span> (!cr)</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                              qreal m = staff-&gt;<a class="code" href="classMs_1_1Staff.html#a80aa5db67223dff29e9113f23865b62b">mag</a>(&amp;segment);</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                              <span class="keywordflow">if</span> (cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a260e9896d5323993e2ba87c40f60d5ce">small</a>())</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                                    m *= <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea6ddf2c55b0a7ea98059dc9d6320ebf8f">Sid::smallNoteMag</a>);</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                              <span class="keywordflow">if</span> (cr-&gt;isChord()) {</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                                    <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = toChord(cr);</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Chord.html#a550c9abf9f41513672b152651e4c6a95">cmdUpdateNotes</a>(&amp;as);</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Chord.html">Chord</a>* c : chord-&gt;<a class="code" href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">graceNotes</a>()) {</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                                          c-&gt;setMag(m * <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eacf91555d502f169a47dcd9db66a88590">Sid::graceNoteMag</a>));</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                                          c-&gt;computeUp();</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                                          <span class="keywordflow">if</span> (c-&gt;stemDirection() != <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ae1f2d5134ed2543d38a0de9751cf75d9">Direction::AUTO</a>)</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                                                c-&gt;setUp(c-&gt;stemDirection() == <a class="code" href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Direction::UP</a>);</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                                          <span class="keywordflow">else</span></div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                                                c-&gt;setUp(!(t % 2));</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                                          <span class="keywordflow">if</span> (drumset)</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                                                <a class="code" href="namespaceMs.html#a43546ea8d8f5343ffe26bcdd5d53ef8d">layoutDrumsetChord</a>(c, drumset, st, <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>());</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                                          c-&gt;layoutStem1();</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                                          }</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                                    <span class="keywordflow">if</span> (drumset)</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                                          <a class="code" href="namespaceMs.html#a43546ea8d8f5343ffe26bcdd5d53ef8d">layoutDrumsetChord</a>(chord, drumset, st, <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>());</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Chord.html#a33b64f9292f5e20eb55a8013e977b722">computeUp</a>();</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                                    chord-&gt;<a class="code" href="classMs_1_1Chord.html#a185fc7776084b28c2f33003434729ffe">layoutStem1</a>();   <span class="comment">// create stems needed to calculate spacing</span></div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                                            <span class="comment">// stem direction can change later during beam processing</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                                    <span class="comment">// if there is a two-note tremolo attached, and it is too steep,</span></div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                                    <span class="comment">// extend stem of one of the chords (if not cross-staff)</span></div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                                    <span class="comment">// or extend both stems (if cross-staff)</span></div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                                    <span class="comment">// this should be done after the stem lengths of two notes are both calculated</span></div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                                    <span class="keywordflow">if</span> (chord-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>() &amp;&amp; chord == chord-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>()-&gt;<a class="code" href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">chord2</a>()) {</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                                          <a class="code" href="classMs_1_1Stem.html">Stem</a>* stem1 = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>()-&gt;<a class="code" href="classMs_1_1Tremolo.html#af3fbc117c926f4bc9bd5f0ee3e8ad478">chord1</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>();</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                                          <a class="code" href="classMs_1_1Stem.html">Stem</a>* stem2 = chord-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>()-&gt;<a class="code" href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">chord2</a>()-&gt;<a class="code" href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">stem</a>();</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                                          <span class="keywordflow">if</span> (stem1 &amp;&amp; stem2) {</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                                                std::pair&lt;qreal, qreal&gt; extendedLen = <a class="code" href="namespaceMs.html#a8a1496edbc37ad47b5c22a3a5edf419d">extendedStemLenWithTwoNoteTremolo</a>(chord-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>(),</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                                                   stem1-&gt;<a class="code" href="classMs_1_1Stem.html#ab86a81e498e1f8cc1029b3e6160f717a">p2</a>().y(), stem2-&gt;<a class="code" href="classMs_1_1Stem.html#ab86a81e498e1f8cc1029b3e6160f717a">p2</a>().y());</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                                                stem1-&gt;<a class="code" href="classMs_1_1Stem.html#af82b7550b3812ab906901aa32efe0e2b">setLen</a>(extendedLen.first);</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                                                stem2-&gt;<a class="code" href="classMs_1_1Stem.html#af82b7550b3812ab906901aa32efe0e2b">setLen</a>(extendedLen.second);</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                                                }</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;                                          }</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                                    }</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                              cr-&gt;<a class="code" href="classMs_1_1Element.html#a49df2a43ee4c87d33b78c60cce70ff4e">setMag</a>(m);</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                              }</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                        }</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (segment.isClefType()) {</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                        <a class="code" href="classMs_1_1Element.html">Element</a>* e = segment.element(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>);</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                        <span class="keywordflow">if</span> (e) {</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;                              toClef(e)-&gt;setSmall(<span class="keyword">true</span>);</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;                              e-&gt;<a class="code" href="classMs_1_1Element.html#a3ae68f5da280c53fd1d329f20601818b">layout</a>();</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                              }</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                        }</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (segment.isType(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb">SegmentType::TimeSig</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a744c4c5d2986906841d0f6e0e4906985">SegmentType::Ambitus</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894af69392a2ebed1af02428c867f81fed3f">SegmentType::HeaderClef</a>)) {</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                        <a class="code" href="classMs_1_1Element.html">Element</a>* e = segment.element(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>);</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                        <span class="keywordflow">if</span> (e)</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                              e-&gt;<a class="code" href="classMs_1_1Element.html#a3ae68f5da280c53fd1d329f20601818b">layout</a>();</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                        }</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                  }</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            }</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <a class="code" href="classMs_1_1Score.html#a29c760c918a400d7fb360c44da0e3ed1">createBeams</a>(lc, measure);</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; segment : measure-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                  <span class="keywordflow">if</span> (segment.isChordRestType()) {</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                        <a class="code" href="classMs_1_1Score.html#aabf8eae8fbefcade6724ea507c16a9ed">layoutChords1</a>(&amp;segment, <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                              <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = segment.cr(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * VOICES + voice);</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                              <span class="keywordflow">if</span> (cr) {</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                                          <span class="keywordflow">if</span> (l)</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                                                l-&gt;<a class="code" href="classMs_1_1Element.html#a3ae68f5da280c53fd1d329f20601818b">layout</a>();</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                                          }</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                                    }</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                              }</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                        }</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                  }</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;            }</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      measure-&gt;<a class="code" href="classMs_1_1Measure.html#a9909fe4a0720b7800e1fedcda555444b">computeTicks</a>();</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; segment : measure-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;            <span class="keywordflow">if</span> (segment.isBreathType()) {</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : segment.elist()) {</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                        <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isBreath())</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                              e-&gt;layout();</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;                        }</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;                  }</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (segment.isChordRestType()) {</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : segment.annotations()) {</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;isSymbol())</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                              e-&gt;layout();</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                        }</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                  }</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            }</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      <a class="code" href="classMs_1_1Score.html#a0d0757612d3d41e59d34a20278900258">rebuildTempoAndTimeSigMaps</a>(measure);</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      <a class="code" href="classMs_1_1Segment.html">Segment</a>* seg = measure-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">SegmentType::StartRepeatBarLine</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;      <span class="keywordflow">if</span> (measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>()) {</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;            <span class="keywordflow">if</span> (!seg)</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                  seg = measure-&gt;<a class="code" href="classMs_1_1Measure.html#aad5110345772e4588ae5c651c35d9387">getSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">SegmentType::StartRepeatBarLine</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;            measure-&gt;<a class="code" href="classMs_1_1Measure.html#afa5c4d44781f40f962d4818271f60249">barLinesSetSpan</a>(seg);      <span class="comment">// this also creates necessary barlines</span></div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                  <a class="code" href="classMs_1_1BarLine.html">BarLine</a>* b = toBarLine(seg-&gt;<a class="code" href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">element</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>));</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                  <span class="keywordflow">if</span> (b) {</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                        b-&gt;<a class="code" href="classMs_1_1BarLine.html#aa7cce50a8d5f1e25e7a511039e311e3d">setBarLineType</a>(<a class="code" href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914fa7c6a77bcc662a0b7d6e00c22fba3ba21">BarLineType::START_REPEAT</a>);</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                        b-&gt;<a class="code" href="classMs_1_1BarLine.html#a42d506ca189702e276733a14b70f017e">layout</a>();</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                        }</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                  }</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;            }</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg)</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a365e5013395d4a660672ad8fff61a864">undoRemoveElement</a>(seg);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : measure-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;            <span class="comment">// TODO? maybe we do need to process it here to make it possible to enable later</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;            <span class="comment">//if (!s.enabled())</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;            <span class="comment">//      continue;</span></div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            <span class="comment">// DEBUG: relayout grace notes as beaming/flags may have changed</span></div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;            <span class="keywordflow">if</span> (s.isChordRestType()) {</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s.elist()) {</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                        <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isChord()) {</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                              <a class="code" href="classMs_1_1Chord.html">Chord</a>* chord = toChord(e);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                              chord-&gt;<a class="code" href="classMs_1_1Chord.html#ad2edc025a393651b7cd3d8c1b4404c8b">layout</a>();</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="comment">//                              if (chord-&gt;tremolo())            // debug</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="comment">//                                    chord-&gt;tremolo()-&gt;layout();</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                              }</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                        }</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                  }</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s.isEndBarLineType())</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;            s.createShapes();</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            }</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">tick</a> += measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">ticks</a>();</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      }</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="comment">//   isTopBeam</span></div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;<span class="comment">//    returns true for the first CR of a beam that is not cross-staff</span></div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;</div><div class="line"><a name="l03105"></a><span class="lineno"><a class="line" href="namespaceMs.html#a410467a129f146b200e237377e2a695c"> 3105</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a410467a129f146b200e237377e2a695c">isTopBeam</a>(<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr)</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      {</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      <a class="code" href="classMs_1_1Beam.html">Beam</a>* b = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="keywordflow">if</span> (b &amp;&amp; b-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().front() == cr) {</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <span class="comment">// beam already considered cross?</span></div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;            <span class="keywordflow">if</span> (b-&gt;<a class="code" href="classMs_1_1Beam.html#ad4f30020049f6fba843ecfcdd53ba269">cross</a>())</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;            <span class="comment">// for beams not already considered cross,</span></div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            <span class="comment">// consider them so here if any elements were moved up</span></div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr1 : b-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>()) {</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                  <span class="comment">// some element moved up?</span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                  <span class="keywordflow">if</span> (cr1-&gt;staffMove() &lt; 0)</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                  }</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;            <span class="comment">// not cross</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            }</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      <span class="comment">// no beam or not first element</span></div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      }</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">//   notTopBeam</span></div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="comment">//    returns true for the first CR of a beam that is cross-staff</span></div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;</div><div class="line"><a name="l03134"></a><span class="lineno"><a class="line" href="namespaceMs.html#a9210a20e1a75146ee5e3102a3bbb9320"> 3134</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a9210a20e1a75146ee5e3102a3bbb9320">notTopBeam</a>(<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr)</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      {</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <a class="code" href="classMs_1_1Beam.html">Beam</a>* b = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordflow">if</span> (b &amp;&amp; b-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>().front() == cr) {</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;            <span class="comment">// beam already considered cross?</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;            <span class="keywordflow">if</span> (b-&gt;<a class="code" href="classMs_1_1Beam.html#ad4f30020049f6fba843ecfcdd53ba269">cross</a>())</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;            <span class="comment">// for beams not already considered cross,</span></div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            <span class="comment">// consider them so here if any elements were moved up</span></div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr1 : b-&gt;<a class="code" href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">elements</a>()) {</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                  <span class="comment">// some element moved up?</span></div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                  <span class="keywordflow">if</span> (cr1-&gt;staffMove() &lt; 0)</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                  }</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;            <span class="comment">// not cross</span></div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;            }</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <span class="comment">// no beam or not first element</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      }</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">//   isTopTuplet</span></div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">//    returns true for the first CR of a tuplet that is not cross-staff</span></div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;</div><div class="line"><a name="l03163"></a><span class="lineno"><a class="line" href="namespaceMs.html#a35bfb67e4b99502eb95a081fa7827322"> 3163</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#a35bfb67e4b99502eb95a081fa7827322">isTopTuplet</a>(<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr)</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      {</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      <a class="code" href="classMs_1_1Tuplet.html">Tuplet</a>* t = cr-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>();</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      <span class="keywordflow">if</span> (t &amp;&amp; t-&gt;<a class="code" href="classMs_1_1Tuplet.html#a335f84666bd36e2bca5963785ae9759a">elements</a>().front() == cr) {</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            <span class="comment">// find top level tuplet</span></div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;            <span class="keywordflow">while</span> (t-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>())</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                  t = t-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>();</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;            <span class="comment">// consider tuplet cross if anything moved within it</span></div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            <span class="keywordflow">if</span> (t-&gt;<a class="code" href="classMs_1_1Tuplet.html#a94169cc886372e29583e9d1e69e8f989">cross</a>())</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;            }</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      <span class="comment">// no tuplet or not first element</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      }</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">//   notTopTuplet</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">//    returns true for the first CR of a tuplet that is cross-staff</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;</div><div class="line"><a name="l03186"></a><span class="lineno"><a class="line" href="namespaceMs.html#ad863eb4b91e6fcf0deef7c476cb10d43"> 3186</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceMs.html#ad863eb4b91e6fcf0deef7c476cb10d43">notTopTuplet</a>(<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr)</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      {</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      <a class="code" href="classMs_1_1Tuplet.html">Tuplet</a>* t = cr-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>();</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;      <span class="keywordflow">if</span> (t &amp;&amp; t-&gt;<a class="code" href="classMs_1_1Tuplet.html#a335f84666bd36e2bca5963785ae9759a">elements</a>().front() == cr) {</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;            <span class="comment">// find top level tuplet</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            <span class="keywordflow">while</span> (t-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>())</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;                  t = t-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>();</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;            <span class="comment">// consider tuplet cross if anything moved within it</span></div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;            <span class="keywordflow">if</span> (t-&gt;<a class="code" href="classMs_1_1Tuplet.html#a94169cc886372e29583e9d1e69e8f989">cross</a>())</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;            }</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <span class="comment">// no tuplet or not first element</span></div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      }</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment">//   findLyricsMaxY</span></div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;</div><div class="line"><a name="l03209"></a><span class="lineno"><a class="line" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124"> 3209</a></span>&#160;<span class="keyword">static</span> qreal <a class="code" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">findLyricsMaxY</a>(<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      {</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      qreal yMax = 0.0;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;      <span class="keywordflow">if</span> (!s.<a class="code" href="classMs_1_1Segment.html#a12875266ecd46db59c8ba3a12857c944">isChordRestType</a>())</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;            <span class="keywordflow">return</span> yMax;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      qreal <a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea96401c5dbfbdbed87fdb994c330f4b2e">lyricsMinTopDistance</a> = s.<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea96401c5dbfbdbed87fdb994c330f4b2e">Sid::lyricsMinTopDistance</a>);</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s.<a class="code" href="classMs_1_1Segment.html#a9adaf3b1b191b949ca562d891c4c5a49">cr</a>(staffIdx * VOICES + voice);</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;            <span class="keywordflow">if</span> (cr &amp;&amp; !cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>().empty()) {</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                  <a class="code" href="classMs_1_1SkylineLine.html">SkylineLine</a> sk(<span class="keyword">true</span>);</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                        <span class="keywordflow">if</span> (l-&gt;autoplace() &amp;&amp; l-&gt;placeBelow()) {</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                              qreal yOff = l-&gt;offset().y();</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                              QPointF offset = l-&gt;pos() + cr-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s.<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s.<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>();</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                              QRectF r = l-&gt;bbox().translated(offset);</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                              r.translate(0.0, -yOff);</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                              sk.<a class="code" href="classMs_1_1SkylineLine.html#a770f1e2838daffe1f51ecfac9ed938f5">add</a>(r.x(), r.top(), r.width());</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;                              }</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                        }</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                  <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* ss = s.<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Measure.html#a9c4de13b592b3e0cc6a2398641da99ed">system</a>()-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(staffIdx);</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                        <span class="keywordflow">if</span> (l-&gt;autoplace() &amp;&amp; l-&gt;placeBelow()) {</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                              qreal y = ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#a75b885f52eeb5c5a0c5e6a1a0ccbb4dd">south</a>().<a class="code" href="classMs_1_1SkylineLine.html#a0c9480d415b3880be30d1efac46c0e04">minDistance</a>(sk);</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                              <span class="keywordflow">if</span> (y &gt; -lyricsMinTopDistance)</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                                    yMax = qMax(yMax, y + lyricsMinTopDistance);</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                              }</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                        }</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                  }</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;            }</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <span class="keywordflow">return</span> yMax;</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      }</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment">//   findLyricsMinY</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div><div class="line"><a name="l03248"></a><span class="lineno"><a class="line" href="namespaceMs.html#a298071d9fa87ec9f88dff35fcd1b10af"> 3248</a></span>&#160;<span class="keyword">static</span> qreal <a class="code" href="namespaceMs.html#a298071d9fa87ec9f88dff35fcd1b10af">findLyricsMinY</a>(<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;      {</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      qreal yMin = 0.0;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      <span class="keywordflow">if</span> (!s.<a class="code" href="classMs_1_1Segment.html#a12875266ecd46db59c8ba3a12857c944">isChordRestType</a>())</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;            <span class="keywordflow">return</span> yMin;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      qreal <a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea96401c5dbfbdbed87fdb994c330f4b2e">lyricsMinTopDistance</a> = s.<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea96401c5dbfbdbed87fdb994c330f4b2e">Sid::lyricsMinTopDistance</a>);</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s.<a class="code" href="classMs_1_1Segment.html#a9adaf3b1b191b949ca562d891c4c5a49">cr</a>(staffIdx * VOICES + voice);</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            <span class="keywordflow">if</span> (cr &amp;&amp; !cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>().empty()) {</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                  <a class="code" href="classMs_1_1SkylineLine.html">SkylineLine</a> sk(<span class="keyword">false</span>);</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                        <span class="keywordflow">if</span> (l-&gt;autoplace() &amp;&amp; l-&gt;placeAbove()) {</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                              qreal yOff = l-&gt;offset().y();</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                              QRectF r = l-&gt;bbox().translated(l-&gt;pos() + cr-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s.<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s.<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>());</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                              r.translate(0.0, -yOff);</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                              sk.<a class="code" href="classMs_1_1SkylineLine.html#a770f1e2838daffe1f51ecfac9ed938f5">add</a>(r.x(), r.bottom(), r.width());</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                              }</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                        }</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                  <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* ss = s.<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Measure.html#a9c4de13b592b3e0cc6a2398641da99ed">system</a>()-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(staffIdx);</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                        <span class="keywordflow">if</span> (l-&gt;autoplace() &amp;&amp; l-&gt;placeAbove()) {</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                              qreal y = sk.<a class="code" href="classMs_1_1SkylineLine.html#a0c9480d415b3880be30d1efac46c0e04">minDistance</a>(ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#a13325c30212ec913c5da8f9b7a5368a8">north</a>());</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                              <span class="keywordflow">if</span> (y &gt; -lyricsMinTopDistance)</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                                    yMin = qMin(yMin, -y - lyricsMinTopDistance);</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;                              }</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;                        }</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;                  }</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            }</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keywordflow">return</span> yMin;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      }</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;</div><div class="line"><a name="l03280"></a><span class="lineno"><a class="line" href="namespaceMs.html#a5107fd6632d299441268f5d14d38ca05"> 3280</a></span>&#160;<span class="keyword">static</span> qreal <a class="code" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">findLyricsMaxY</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      {</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      qreal yMax = 0.0;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>())</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;            yMax = qMax(yMax, <a class="code" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">findLyricsMaxY</a>(s, staffIdx));</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      <span class="keywordflow">return</span> yMax;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;      }</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;</div><div class="line"><a name="l03288"></a><span class="lineno"><a class="line" href="namespaceMs.html#a5b6714f08a9213fa49e1e6392f2debb9"> 3288</a></span>&#160;<span class="keyword">static</span> qreal <a class="code" href="namespaceMs.html#a298071d9fa87ec9f88dff35fcd1b10af">findLyricsMinY</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      {</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      qreal yMin = 0.0;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>())</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;            yMin = qMin(yMin, <a class="code" href="namespaceMs.html#a298071d9fa87ec9f88dff35fcd1b10af">findLyricsMinY</a>(s, staffIdx));</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="keywordflow">return</span> yMin;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      }</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">//   applyLyricsMax</span></div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;</div><div class="line"><a name="l03300"></a><span class="lineno"><a class="line" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6"> 3300</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">applyLyricsMax</a>(<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, qreal yMax)</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      {</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      <span class="keywordflow">if</span> (!s.<a class="code" href="classMs_1_1Segment.html#a12875266ecd46db59c8ba3a12857c944">isChordRestType</a>())</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <a class="code" href="classMs_1_1Skyline.html">Skyline</a>&amp; sk = s.<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Measure.html#a9c4de13b592b3e0cc6a2398641da99ed">system</a>()-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(staffIdx)-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>();</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s.<a class="code" href="classMs_1_1Segment.html#a9adaf3b1b191b949ca562d891c4c5a49">cr</a>(staffIdx * VOICES + voice);</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;            <span class="keywordflow">if</span> (cr &amp;&amp; !cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>().empty()) {</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                  qreal <a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea233a910dde3c26b67cfe1cabb3b17d3a">lyricsMinBottomDistance</a> = s.<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea233a910dde3c26b67cfe1cabb3b17d3a">Sid::lyricsMinBottomDistance</a>);</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                        <span class="keywordflow">if</span> (l-&gt;autoplace() &amp;&amp; l-&gt;placeBelow()) {</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                              l-&gt;rypos() += yMax - l-&gt;propertyDefault(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9">Pid::OFFSET</a>).toPointF().y();</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;                              <span class="keywordflow">if</span> (l-&gt;addToSkyline()) {</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                                    QPointF offset = l-&gt;pos() + cr-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s.<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s.<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>();</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;                                    sk.<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(l-&gt;bbox().translated(offset).adjusted(0.0, 0.0, 0.0, lyricsMinBottomDistance));</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                                    }</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                              }</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;                        }</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                  }</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;            }</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      }</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;</div><div class="line"><a name="l03322"></a><span class="lineno"><a class="line" href="namespaceMs.html#ad5ef58e4709cfaf49132b86bcdd2ee1f"> 3322</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">applyLyricsMax</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, qreal yMax)</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      {</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>())</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            <a class="code" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">applyLyricsMax</a>(s, staffIdx, yMax);</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      }</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="comment">//   applyLyricsMin</span></div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"><a class="line" href="namespaceMs.html#a23d18a6c7a9dff2536e0535c9f5167bd"> 3332</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a23d18a6c7a9dff2536e0535c9f5167bd">applyLyricsMin</a>(<a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, qreal yMin)</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      {</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <a class="code" href="classMs_1_1Skyline.html">Skyline</a>&amp; sk = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#aaa704d32c5e4253d54d722276f507e2d">measure</a>()-&gt;<a class="code" href="classMs_1_1Measure.html#a9c4de13b592b3e0cc6a2398641da99ed">system</a>()-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(staffIdx)-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>();</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;            <span class="keywordflow">if</span> (l-&gt;autoplace() &amp;&amp; l-&gt;placeAbove()) {</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                  l-&gt;rypos() += yMin - l-&gt;propertyDefault(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9">Pid::OFFSET</a>).toPointF().y();</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                  <span class="keywordflow">if</span> (l-&gt;addToSkyline()) {</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                        QPointF offset = l-&gt;pos() + cr-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">segment</a>()-&gt;<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>();</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                        sk.<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(l-&gt;bbox().translated(offset));</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                        }</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                  }</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;            }</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;      }</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div><div class="line"><a name="l03346"></a><span class="lineno"><a class="line" href="namespaceMs.html#ac414a12fc230d3f435ef927b0787d8cb"> 3346</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a23d18a6c7a9dff2536e0535c9f5167bd">applyLyricsMin</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m, <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, qreal yMin)</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      {</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;            <span class="keywordflow">if</span> (s.isChordRestType()) {</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                        <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s.cr(staffIdx * VOICES + voice);</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                        <span class="keywordflow">if</span> (cr)</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                              <a class="code" href="namespaceMs.html#a23d18a6c7a9dff2536e0535c9f5167bd">applyLyricsMin</a>(cr, staffIdx, yMin);</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                        }</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                  }</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;            }</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      }</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="comment">//   restoreBeams</span></div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"><a class="line" href="namespaceMs.html#a828b7d077638066c078fd12c2e34aa14"> 3363</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a828b7d077638066c078fd12c2e34aa14">restoreBeams</a>(<a class="code" href="classMs_1_1Measure.html">Measure</a>* m)</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      {</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">SegmentType::ChordRest</a>)) {</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;elist()) {</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                  <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isChordRest()) {</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                        <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a410467a129f146b200e237377e2a695c">isTopBeam</a>(cr)) {</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                              <a class="code" href="classMs_1_1Beam.html">Beam</a>* b = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                              b-&gt;<a class="code" href="classMs_1_1Beam.html#ac2c76daf5a9dc4c3cc0f366a394ab4d6">layout</a>();</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;                              b-&gt;<a class="code" href="classMs_1_1Beam.html#a7735446d0fd3fbe4fecb1a6ab149c146">addSkyline</a>(m-&gt;<a class="code" href="classMs_1_1Measure.html#a9c4de13b592b3e0cc6a2398641da99ed">system</a>()-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(b-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>())-&gt;skyline());</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                              }</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                        }</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                  }</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            }</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;      }</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment">//   layoutLyrics</span></div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="comment">//    vertical align lyrics</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;</div><div class="line"><a name="l03386"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a6a5f3aed4895d192dfe62c82bf654e12"> 3386</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a6a5f3aed4895d192dfe62c82bf654e12">Score::layoutLyrics</a>(<a class="code" href="classMs_1_1System.html">System</a>* system)</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;      {</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      std::vector&lt;int&gt; visibleStaves;</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = system-&gt;<a class="code" href="classMs_1_1System.html#a7d2a3a40bb9f87be831540f0258e95df">firstVisibleStaff</a>(); <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = system-&gt;<a class="code" href="classMs_1_1System.html#a2c3bd9ec57fc55b441188dc2d6f21eea">nextVisibleStaff</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>))</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            visibleStaves.push_back(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      <span class="comment">//int nAbove[nstaves()];</span></div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      std::vector&lt;int&gt; VnAbove(<a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>());</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> : visibleStaves) {</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            VnAbove[<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>] = 0;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                  <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                        <span class="keywordflow">if</span> (s.isChordRestType()) {</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                                    <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s.cr(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * VOICES + voice);</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                                    <span class="keywordflow">if</span> (cr) {</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                                          <span class="keywordtype">int</span> nA = 0;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                                          <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>()) {</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                                                <span class="comment">// user adjusted offset can possibly change placement</span></div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                                                <span class="keywordflow">if</span> (l-&gt;offsetChanged() != <a class="code" href="namespaceMs.html#a48cf14669801f9b0080847f8d7902e5bab50339a10e1de285ac99d4c3990b8693">OffsetChange::NONE</a>) {</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                                                      <a class="code" href="namespaceMs.html#a5340e53ea850ac4e67c071825916e469">Placement</a> p = l-&gt;<a class="code" href="classMs_1_1Element.html#a951493711a51487f7f3c1786703b1a20">placement</a>();</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                                                      l-&gt;rebaseOffset();</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                                                      <span class="keywordflow">if</span> (l-&gt;placement() != p) {</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                                                            l-&gt;undoResetProperty(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655ade5719c2dfdeb16392d208bee8e76229">Pid::AUTOPLACE</a>);</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                                                            <span class="comment">//l-&gt;undoResetProperty(Pid::OFFSET);</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                                                            <span class="comment">//l-&gt;layout();</span></div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                                                            }</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                                                      }</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                                                l-&gt;setOffsetChanged(<span class="keyword">false</span>);</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                                                <span class="keywordflow">if</span> (l-&gt;placeAbove())</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                                                      ++nA;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                                                }</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                                          VnAbove[<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>] = qMax(VnAbove[<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>], nA);</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;                                          }</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                                    }</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                              }</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                        }</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                  }</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            }</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> : visibleStaves) {</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                  <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                        <span class="keywordflow">if</span> (s.isChordRestType()) {</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> voice = 0; voice &lt; <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>; ++voice) {</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                                    <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = s.cr(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * VOICES + voice);</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                                    <span class="keywordflow">if</span> (cr) {</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                                          <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Lyrics.html">Lyrics</a>* l : cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">lyrics</a>())</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                                                l-&gt;layout2(VnAbove[<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>]);</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                                          }</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                                    }</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                              }</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                        }</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                  }</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;            }</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      <a class="code" href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18">VerticalAlignRange</a> ar = <a class="code" href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18">VerticalAlignRange</a>(<a class="code" href="classMs_1_1Score.html#a979a12736465161f2e680cd26df8c0a3">styleI</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea0bd7c72185a0b785f4457db05401330c">Sid::autoplaceVerticalAlignRange</a>));</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      <span class="keywordflow">switch</span> (ar) {</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18a84e4213ee54478574ea15a166ea10152">VerticalAlignRange::MEASURE</a>:</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                        <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> : visibleStaves) {</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                              qreal yMax = <a class="code" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">findLyricsMaxY</a>(m, <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                              <a class="code" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">applyLyricsMax</a>(m, <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, yMax);</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                              }</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                        }</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18afa177138f94a7ea01f549b1aa7893d03">VerticalAlignRange::SYSTEM</a>:</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> : visibleStaves) {</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                        qreal yMax = 0.0;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                        qreal yMin = 0.0;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;                              <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                              yMax = qMax&lt;qreal&gt;(yMax, <a class="code" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">findLyricsMaxY</a>(toMeasure(mb), <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>));</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                              yMin = qMin(yMin, <a class="code" href="namespaceMs.html#a298071d9fa87ec9f88dff35fcd1b10af">findLyricsMinY</a>(toMeasure(mb), <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>));</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;                              }</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;                              <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                              <a class="code" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">applyLyricsMax</a>(toMeasure(mb), <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, yMax);</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;                              <a class="code" href="namespaceMs.html#a23d18a6c7a9dff2536e0535c9f5167bd">applyLyricsMin</a>(toMeasure(mb), <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, yMin);</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;                              }</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;                        }</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18a49f1f9beb48e7b006a35b2377403bea8">VerticalAlignRange::SEGMENT</a>:</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                        <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> : visibleStaves) {</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;                              <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;                                    qreal yMax = <a class="code" href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">findLyricsMaxY</a>(s, <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;                                    <a class="code" href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">applyLyricsMax</a>(s, <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>, yMax);</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                                    }</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                              }</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                        }</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            }</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      }</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment">//   layoutTies</span></div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;</div><div class="line"><a name="l03501"></a><span class="lineno"><a class="line" href="namespaceMs.html#a312ec8a39e6d4053d8f84c23b86ceaec"> 3501</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a312ec8a39e6d4053d8f84c23b86ceaec">layoutTies</a>(<a class="code" href="classMs_1_1Chord.html">Chord</a>* ch, <a class="code" href="classMs_1_1System.html">System</a>* system, <span class="keyword">const</span> <a class="code" href="classMs_1_1Fraction.html">Fraction</a>&amp; stick)</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      {</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* <a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a> = system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(ch-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>());</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;      <span class="keywordflow">if</span> (!staff-&gt;<a class="code" href="classMs_1_1SysStaff.html#a15edb8450b4cbf7ec4c20591804def65">show</a>())</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Note.html">Note</a>* note : ch-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>()) {</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;            <a class="code" href="classMs_1_1Tie.html">Tie</a>* t = note-&gt;tieFor();</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;            <span class="keywordflow">if</span> (t) {</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;                  <a class="code" href="classMs_1_1TieSegment.html">TieSegment</a>* ts = t-&gt;<a class="code" href="classMs_1_1Tie.html#acf72f934562e0b3b45f9e8984d0dd970">layoutFor</a>(system);</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                  <span class="keywordflow">if</span> (ts &amp;&amp; ts-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                        staff-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(ts-&gt;<a class="code" href="classMs_1_1SlurTieSegment.html#afabd534baeefa0cfef3c7ff829fd8ad0">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(ts-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                  }</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;            t = note-&gt;tieBack();</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            <span class="keywordflow">if</span> (t) {</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                  <span class="keywordflow">if</span> (t-&gt;<a class="code" href="classMs_1_1Tie.html#acdcb6924221b29a0e3d6ae3fa109aa14">startNote</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">tick</a>() &lt; stick) {</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;                        <a class="code" href="classMs_1_1TieSegment.html">TieSegment</a>* ts = t-&gt;<a class="code" href="classMs_1_1Tie.html#a81e11c00ff2b76f3472303560c12d0a5">layoutBack</a>(system);</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                        <span class="keywordflow">if</span> (ts &amp;&amp; ts-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                              staff-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(ts-&gt;<a class="code" href="classMs_1_1SlurTieSegment.html#afabd534baeefa0cfef3c7ff829fd8ad0">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(ts-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                        }</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                  }</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;            }</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      }</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment">//   layoutHarmonies</span></div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;</div><div class="line"><a name="l03528"></a><span class="lineno"><a class="line" href="namespaceMs.html#a130aa9f1611e42fc06a6eaee6d78da2d"> 3528</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a130aa9f1611e42fc06a6eaee6d78da2d">layoutHarmonies</a>(<span class="keyword">const</span> std::vector&lt;Segment*&gt;&amp; sl)</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;      {</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isHarmony()) {</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                        <a class="code" href="classMs_1_1Harmony.html">Harmony</a>* h = toHarmony(e);</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                        <span class="comment">// For chord symbols that coincide with a chord or rest,</span></div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                        <span class="comment">// a partial layout can also happen (if needed) during ChordRest layout</span></div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                        <span class="comment">// in order to calculate a bbox and allocate its shape to the ChordRest.</span></div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                        <span class="comment">// But that layout (if it happens at all) does not do autoplace,</span></div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                        <span class="comment">// so we need the full layout here.</span></div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                        h-&gt;<a class="code" href="classMs_1_1Harmony.html#af11c09bece9d4ec0420aea90748cacef">layout</a>();</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                        h-&gt;<a class="code" href="classMs_1_1Element.html#ab5518cc652f95d5d64ddd2bd7bfc6f6b">autoplaceSegmentElement</a>();</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                        }</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;                  }</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            }</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      }</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="comment">//   alignHarmonies</span></div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div><div class="line"><a name="l03550"></a><span class="lineno"><a class="line" href="namespaceMs.html#a39873f2b64993a8c6b6754e3a78a4bf1"> 3550</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a39873f2b64993a8c6b6754e3a78a4bf1">alignHarmonies</a>(<span class="keyword">const</span> <a class="code" href="classMs_1_1System.html">System</a>* system, <span class="keyword">const</span> std::vector&lt;Segment*&gt;&amp; sl, <span class="keywordtype">bool</span> harmony, <span class="keyword">const</span> qreal maxShiftAbove, <span class="keyword">const</span> qreal maxShiftBelow)</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;      {</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <span class="comment">// Help class.</span></div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      <span class="comment">// Contains harmonies/fretboard per segment.</span></div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <span class="keyword">class </span>HarmonyList : <span class="keyword">public</span> QList&lt;Element*&gt; {</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            QMap&lt;const Segment*, QList&lt;Element*&gt;&gt; elements;</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;            QList&lt;Element*&gt; modified;</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            <a class="code" href="classMs_1_1Element.html">Element</a>* getReferenceElement(<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s, <span class="keywordtype">bool</span> above, <span class="keywordtype">bool</span> visible)<span class="keyword"> const</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="keyword">                  </span>{</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                  <span class="comment">// Returns the reference element for aligning.</span></div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                  <span class="comment">// When a segments contains multiple harmonies/fretboard, the lowest placed</span></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                  <span class="comment">// element (for placement above, otherwise the highest placed element) is</span></div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                  <span class="comment">// used for alignment.</span></div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;                  <a class="code" href="classMs_1_1Element.html">Element</a>* element { <span class="keyword">nullptr</span> };</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : elements[s]) {</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;                        <span class="comment">// Only chord symbols have styled offset, fretboards don&#39;t.</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                        <span class="keywordflow">if</span> (!e-&gt;autoplace() || (e-&gt;isHarmony() &amp;&amp; !e-&gt;isStyled(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9">Pid::OFFSET</a>)) || (visible &amp;&amp; !e-&gt;visible()))</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                        <span class="keywordflow">if</span> (!element) {</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                              element = e;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;                              }</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                              <span class="keywordflow">if</span> ((e-&gt;placeAbove() &amp;&amp;  above &amp;&amp; (element-&gt;y() &lt; e-&gt;y())) ||</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                                  (e-&gt;placeBelow() &amp;&amp; !above &amp;&amp; (element-&gt;y() &gt; e-&gt;y())))</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                                    element = e;</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;                              }</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                         }</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                  <span class="keywordflow">return</span> element;</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;                  }</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;         <span class="keyword">public</span>:</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            HarmonyList()</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                  {</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                  elements.clear();</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                  modified.clear();</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                  }</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;            <span class="keywordtype">void</span> append(<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s, <a class="code" href="classMs_1_1Element.html">Element</a>* e)</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                  {</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                  elements[s].append(e);</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                  }</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;            qreal getReferenceHeight(<span class="keywordtype">bool</span> above)<span class="keyword"> const</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;<span class="keyword">                  </span>{</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                  <span class="comment">// The reference height is the height of</span></div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                  <span class="comment">//    the lowest element if placed above</span></div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                  <span class="comment">// or</span></div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;                  <span class="comment">//    the highest element if placed below.</span></div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;                  <span class="keywordtype">bool</span> <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a> { <span class="keyword">true</span> };</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                  qreal ref { 0.0 };</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : elements.keys()) {</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                        <a class="code" href="classMs_1_1Element.html">Element</a>* e { getReferenceElement(s, above, <span class="keyword">true</span>) };</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                        <span class="keywordflow">if</span> (!e)</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;<a class="code" href="classMs_1_1Element.html#a8ba22391443270db0f91a3164c457d1e">placeAbove</a>() &amp;&amp; above) {</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                              ref = <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a> ? e-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>() : qMin(ref, e-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>());</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                              }</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;<a class="code" href="classMs_1_1Element.html#a50092b502c319cb696998f24fc038695">placeBelow</a>() &amp;&amp; !above) {</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                              ref = <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a> ? e-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>() : qMax(ref, e-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>());</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                              }</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;                        }</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;                  <span class="keywordflow">return</span> ref;</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                  }</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;            <span class="keywordtype">bool</span> align(<span class="keywordtype">bool</span> above, qreal reference, qreal maxShift)</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                  {</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                  <span class="comment">// Align the elements. If a segment contains multiple elements,</span></div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                  <span class="comment">// only the reference elements is used in the algorithm. All other</span></div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                  <span class="comment">// elements will remain their original placement with respect to</span></div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                  <span class="comment">// the reference element.</span></div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                  <span class="keywordtype">bool</span> moved { <span class="keyword">false</span> };</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(reference))</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                        <span class="keywordflow">return</span> moved;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : elements.keys()) {</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                        QList&lt;Element*&gt; handled;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                        <a class="code" href="classMs_1_1Element.html">Element</a>* be = getReferenceElement(s, above, <span class="keyword">false</span>);</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                        <span class="keywordflow">if</span> (!be)</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                              <span class="comment">// If there are only invisible elements, we have to use an invisible</span></div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                              <span class="comment">// element for alignment reference.</span></div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                              be = getReferenceElement(s, above, <span class="keyword">true</span>);</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                        <span class="keywordflow">if</span> (be &amp;&amp; ((above &amp;&amp; (be-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>() &lt; (reference + maxShift))) || ((!above &amp;&amp; (be-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>() &gt; (reference - maxShift)))))) {</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;                              qreal shift = be-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>();</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                              be-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() = reference - be-&gt;<a class="code" href="classMs_1_1Element.html#a8f60347a3bda60cf2db952b9dc6332ab">ryoffset</a>();</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                              shift -= be-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>();</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                              <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : elements[s]) {</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                                    <span class="keywordflow">if</span> ((above &amp;&amp; e-&gt;<a class="code" href="classMs_1_1Element.html#a50092b502c319cb696998f24fc038695">placeBelow</a>()) || (!above &amp;&amp; e-&gt;<a class="code" href="classMs_1_1Element.html#a8ba22391443270db0f91a3164c457d1e">placeAbove</a>()))</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                                    modified.append(e);</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                                    handled.append(e);</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                                    moved = <span class="keyword">true</span>;</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                                    <span class="keywordflow">if</span> (e != be)</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                                          e-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() -= shift;</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                                    }</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                              <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : handled)</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                                    elements[s].removeOne(e);</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                              }</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                        }</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                  <span class="keywordflow">return</span> moved;</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;                  }</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;            <span class="keywordtype">void</span> addToSkyline(<span class="keyword">const</span> <a class="code" href="classMs_1_1System.html">System</a>* system)</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                  {</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : qAsConst(modified)) {</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = toSegment(e-&gt;<a class="code" href="classMs_1_1Element.html#a52b30fdd589beba5b760a561a50ac601">parent</a>());</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* m = <a class="code" href="namespaceMs.html#a0170d0c2acdf047caab45053aec53588">toMeasureBase</a>(s-&gt;<a class="code" href="classMs_1_1Element.html#a52b30fdd589beba5b760a561a50ac601">parent</a>());</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                        system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(e-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>())-&gt;skyline().add(e-&gt;<a class="code" href="classMs_1_1Element.html#ad46a1fa8985b3d3897101b295a7a5d3e">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(e-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + m-&gt;pos()));</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;isFretDiagram()) {</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                              <a class="code" href="classMs_1_1FretDiagram.html">FretDiagram</a>* fd = toFretDiagram(e);</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                              <a class="code" href="classMs_1_1Harmony.html">Harmony</a>* h = fd-&gt;<a class="code" href="classMs_1_1FretDiagram.html#a0a4ebc84b5b1c6295af8ea97a3cac02e">harmony</a>();</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                              <span class="keywordflow">if</span> (h)</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                                    system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(e-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>())-&gt;skyline().add(h-&gt;<a class="code" href="classMs_1_1Element.html#ad46a1fa8985b3d3897101b295a7a5d3e">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(h-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + fd-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + m-&gt;pos()));</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                              <span class="keywordflow">else</span></div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                                    system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(e-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>())-&gt;skyline().add(fd-&gt;<a class="code" href="classMs_1_1Element.html#ad46a1fa8985b3d3897101b295a7a5d3e">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(fd-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + m-&gt;pos()));</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;                              }</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                        }</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;                  }</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            };</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(maxShiftAbove) &amp;&amp; <a class="code" href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">almostZero</a>(maxShiftBelow))</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      <span class="comment">// Collect all fret diagrams and chord symbol and store them per staff.</span></div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;      <span class="comment">// In the same pass, the maximum height is collected.</span></div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      QMap&lt;int, HarmonyList&gt; <a class="code" href="classMs_1_1Score.html#aaa9eed88d78a41f6cef322c1e3b663a8">staves</a>;</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                  <span class="keywordflow">if</span> ((harmony &amp;&amp; e-&gt;isHarmony()) || (!harmony &amp;&amp; e-&gt;isFretDiagram()))</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;                        staves[e-&gt;staffIdx()].append(s, e);</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                  }</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;            }</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx: staves.keys()) {</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;            <span class="comment">// Align the objects.</span></div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;            <span class="comment">// Algorithm:</span></div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;            <span class="comment">//    - Find highest placed harmony/fretdiagram.</span></div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;            <span class="comment">//    - Align all harmony/fretdiagram objects placed between height and height-maxShiftAbove.</span></div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;            <span class="comment">//    - Repeat for all harmony/fretdiagram objects below heigt-maxShiftAbove.</span></div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;            <span class="keywordtype">bool</span> moved { <span class="keyword">true</span> };</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;            <span class="keywordtype">int</span> pass { 0 };</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;            <span class="keywordflow">while</span> (moved &amp;&amp; (pass++ &lt; 10)) {</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                  moved = <span class="keyword">false</span>;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                  moved |= staves[idx].align(<span class="keyword">true</span>, staves[idx].getReferenceHeight(<span class="keyword">true</span>), maxShiftAbove);</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;                  moved |= staves[idx].align(<span class="keyword">false</span>, staves[idx].getReferenceHeight(<span class="keyword">false</span>), maxShiftBelow);</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                  }</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;            <span class="comment">// Add all aligned objects to the sky line.</span></div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;            staves[idx].addToSkyline(system);</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;            }</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      }</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<span class="comment">//   processLines</span></div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;</div><div class="line"><a name="l03709"></a><span class="lineno"><a class="line" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e"> 3709</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(<a class="code" href="classMs_1_1System.html">System</a>* system, std::vector&lt;Spanner*&gt; lines, <span class="keywordtype">bool</span> align)</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      {</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      std::vector&lt;SpannerSegment*&gt; segments;</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Spanner.html">Spanner</a>* sp : lines) {</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;            <a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss = sp-&gt;layoutSystem(system);     <span class="comment">// create/layout spanner segment for this system</span></div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;            <span class="keywordflow">if</span> (ss-&gt;<a class="code" href="classMs_1_1Element.html#a36da6a07a74436d96c739f7134873eda">autoplace</a>())</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;                  segments.push_back(ss);</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;            }</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;      <span class="keywordflow">if</span> (align &amp;&amp; segments.size() &gt; 1) {</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a> = system-&gt;<a class="code" href="classMs_1_1System.html#a436845d5d0032348dfe5f9618d12cb0c">staves</a>()-&gt;size();</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;            constexpr qreal minY = -1000000.0;</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;            <span class="keyword">const</span> qreal defaultY = segments[0]-&gt;rypos();</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;            std::vector&lt;qreal&gt; y(nstaves, minY);</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss : segments) {</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                  <span class="keywordflow">if</span> (ss-&gt;visible()) {</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                        qreal&amp; staffY = y[ss-&gt;staffIdx()];</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                        staffY = qMax(staffY, ss-&gt;rypos());</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                        }</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;                  }</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss : segments) {</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                  <span class="keywordflow">if</span> (!ss-&gt;isStyled(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9">Pid::OFFSET</a>))</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;                  <span class="keyword">const</span> qreal staffY = y[ss-&gt;staffIdx()];</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;                  <span class="keywordflow">if</span> (staffY &gt; minY)</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                        ss-&gt;rypos() = staffY;</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                        ss-&gt;rypos() = defaultY;</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                  }</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;            }</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;      <span class="comment">// add shapes to skyline</span></div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss : segments) {</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;            <span class="keywordflow">if</span> (ss-&gt;addToSkyline())</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;                  system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(ss-&gt;staffIdx())-&gt;skyline().add(ss-&gt;shape().translated(ss-&gt;pos()));</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;            }</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;      }</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="comment">//   collectSystem</span></div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;</div><div class="line"><a name="l03754"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a393fe76e521cb4f1be1d6ab526b64bdf"> 3754</a></span>&#160;<a class="code" href="classMs_1_1System.html">System</a>* <a class="code" href="classMs_1_1Score.html#a393fe76e521cb4f1be1d6ab526b64bdf">Score::collectSystem</a>(<a class="code" href="structMs_1_1LayoutContext.html">LayoutContext</a>&amp; lc)</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      {</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      <span class="keywordflow">if</span> (!lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      <span class="keyword">const</span> <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* <a class="code" href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">measure</a>  = <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.empty() ? 0 : <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.back()-&gt;measures().back();</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      <span class="keywordflow">if</span> (measure)</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;            measure = measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a7990eccc3ffa4f1e133b730e2bcba46b">findPotentialSectionBreak</a>();</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      <span class="keywordflow">if</span> (measure) {</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a>        = measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>() &amp;&amp; <a class="code" href="classMs_1_1Score.html#a0169fb17fae5207d537cb8f2c3a3951f">_layoutMode</a> != <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6">LayoutMode::FLOAT</a>;</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a4ce269915101a420df2d17c7082ec9d8">firstSystemIndent</a>  = lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a> &amp;&amp; measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>()-&gt;<a class="code" href="classMs_1_1LayoutBreak.html#aa955f1ea366e08738cdde0cc4362a3ad">firstSystemIdentation</a>() &amp;&amp; <a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea322eea03da4654d479967cb87170853d">Sid::enableIndentationOnFirstSystem</a>);</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a1f36066aac6e0601246d56816129b7e7">startWithLongNames</a> = lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a> &amp;&amp; measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>()-&gt;<a class="code" href="classMs_1_1LayoutBreak.html#a8e4a14b94f7c6e0fd0b1fd6cd44bc2dd">startWithLongNames</a>();</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;            }</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      <a class="code" href="classMs_1_1System.html">System</a>* system = <a class="code" href="classMs_1_1Score.html#a864ad984e2922bc06edd59dd0ac9a889">getNextSystem</a>(lc);</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> lcmTick = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>();</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      system-&gt;<a class="code" href="classMs_1_1System.html#ad3f579b57f4da0e51e0201418ccdbd10">setInstrumentNames</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#a1f36066aac6e0601246d56816129b7e7">startWithLongNames</a>, lcmTick);</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      qreal minWidth    = 0;</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      qreal layoutSystemMinWidth = 0;</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">firstMeasure</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      <span class="keywordtype">bool</span> createHeader = <span class="keyword">false</span>;</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      qreal systemWidth = <a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead80edba277a8f1ab117e9c42036187c8">Sid::pagePrintableWidth</a>) * <a class="code" href="namespaceMs.html#ab7904232a877db2441531871cf3f5108">DPI</a>;</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      system-&gt;<a class="code" href="classMs_1_1Element.html#ae3346b5a7ad5893674afc28c9b0877ec">setWidth</a>(systemWidth);</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      <span class="comment">// save state of measure</span></div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      qreal curWidth = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;      <span class="keywordtype">bool</span> curHeader = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1Element.html#abb3880878a2f2826b253d5e0e14b32b6">header</a>();</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      <span class="keywordtype">bool</span> curTrailer = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1Element.html#a868f0f5663dd1d7422c19700e070a4a6">trailer</a>();</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      <span class="keywordflow">while</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>) {    <span class="comment">// collect measure for system</span></div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* oldSystem = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a0e9a0473e5ed4cc38a1dead12bf4c2f3">system</a>();</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;            system-&gt;<a class="code" href="classMs_1_1System.html#a0d7f809a91a9458cea81a2ab84f42532">appendMeasure</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;            qreal ww  = 0;      <span class="comment">// width of current measure</span></div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;            <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isMeasure()) {</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                  <span class="keywordflow">if</span> (firstMeasure) {</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;                        layoutSystemMinWidth = minWidth;</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                        system-&gt;<a class="code" href="classMs_1_1System.html#a3e4c82785c6f5a878ae8ce6f80f145da">layoutSystem</a>(minWidth, lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a>, lc.<a class="code" href="structMs_1_1LayoutContext.html#a4ce269915101a420df2d17c7082ec9d8">firstSystemIndent</a>);</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                        minWidth += system-&gt;<a class="code" href="classMs_1_1System.html#ad440df7f5d01eb8f57f7752a96a4a780">leftMargin</a>();</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;                        <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>()) {</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                              <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">SegmentType::StartRepeatBarLine</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;                              <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">enabled</a>())</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                                    s-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;                              }</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;                        m-&gt;<a class="code" href="classMs_1_1Measure.html#ac7e0eb9cc9bfb9d619f2cb52ba6f2ea8">addSystemHeader</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a>);</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;                        firstMeasure = <span class="keyword">false</span>;</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;                        createHeader = <span class="keyword">false</span>;</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                        }</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;                        <span class="keywordflow">if</span> (createHeader) {</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                              m-&gt;<a class="code" href="classMs_1_1Measure.html#ac7e0eb9cc9bfb9d619f2cb52ba6f2ea8">addSystemHeader</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                              createHeader = <span class="keyword">false</span>;</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                              }</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1Element.html#abb3880878a2f2826b253d5e0e14b32b6">header</a>())</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                              m-&gt;<a class="code" href="classMs_1_1Measure.html#a90caa02f9c7dfbb0b6f8e96134c29257">removeSystemHeader</a>();</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                        }</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                  m-&gt;<a class="code" href="classMs_1_1Measure.html#aa910bff7edd9435bd775b373f6010b34">createEndBarLines</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                  m-&gt;<a class="code" href="classMs_1_1Measure.html#a260e48485af749a75d5e763700e13010">addSystemTrailer</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>());</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                  m-&gt;<a class="code" href="classMs_1_1Measure.html#ac829548f174316a6275ff01600254da8">computeMinWidth</a>();</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                  ww = m-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                  }</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isHBox()) {</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4c0c387416b42decef16b9f25d2b935f">computeMinWidth</a>();</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                  ww = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                  createHeader = toHBox(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>)-&gt;createSystemHeader();</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                  }</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                  <span class="comment">// vbox:</span></div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                  <a class="code" href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de">getNextMeasure</a>(lc);</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                  system-&gt;<a class="code" href="classMs_1_1System.html#a50176508633e0790e3569239bf671d62">layout2</a>();   <span class="comment">// compute staff distances</span></div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                  <span class="keywordflow">return</span> system;</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                  }</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;            <span class="comment">// check if lc.curMeasure fits, remove if not</span></div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;            <span class="comment">// collect at least one measure and the break</span></div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;            <span class="keywordtype">bool</span> doBreak = (system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().size() &gt; 1) &amp;&amp; ((minWidth + ww) &gt; systemWidth);</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;            <span class="keywordflow">if</span> (doBreak) {</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                  <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ac8216e757cdc34ebc9a840900e040edf">noBreak</a>() &amp;&amp; system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().size() &gt; 2) {</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;                        <span class="comment">// remove last two measures</span></div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                        <span class="comment">// TODO: check more measures for noBreak()</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                        system-&gt;<a class="code" href="classMs_1_1System.html#a9a7bd4171fa032493f708064078a0913">removeLastMeasure</a>();</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                        system-&gt;<a class="code" href="classMs_1_1System.html#a9a7bd4171fa032493f708064078a0913">removeLastMeasure</a>();</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a650e991868e0532ab8f5cfa4e8c7d86e">setSystem</a>(oldSystem);</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a650e991868e0532ab8f5cfa4e8c7d86e">setSystem</a>(oldSystem);</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>  = lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>();</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;                        }</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ac8216e757cdc34ebc9a840900e040edf">noBreak</a>()) {</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;                        <span class="comment">// remove last measure</span></div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;                        system-&gt;<a class="code" href="classMs_1_1System.html#a9a7bd4171fa032493f708064078a0913">removeLastMeasure</a>();</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a650e991868e0532ab8f5cfa4e8c7d86e">setSystem</a>(oldSystem);</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                        }</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                  }</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;            <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> &amp;&amp; lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;isMeasure() &amp;&amp; lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a0e9a0473e5ed4cc38a1dead12bf4c2f3">system</a>() == system) {</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                  <span class="comment">//</span></div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;                  <span class="comment">// now we know that the previous measure is not the last</span></div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;                  <span class="comment">// measure in the system and we finally can create the end barline for it</span></div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;                  <span class="comment">// TODO: if lc.curMeasure is a frame, removing the trailer may be premature</span></div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                  <span class="comment">// but merely skipping this code isn&#39;t good enough,</span></div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;                  <span class="comment">// we need to find the right time to re-enable the trailer,</span></div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                  <span class="comment">// since it seems to be disabled somewhere else</span></div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                  <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1Element.html#a868f0f5663dd1d7422c19700e070a4a6">trailer</a>()) {</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                        qreal ow = m-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                        m-&gt;<a class="code" href="classMs_1_1Measure.html#a95d953121aa2ea9b6db91e2b147fed50">removeSystemTrailer</a>();</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                        minWidth += m-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>() - ow;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                        }</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                  <span class="comment">// if the prev measure is an end repeat and the cur measure</span></div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;                  <span class="comment">// is an repeat, the createEndBarLines() created an start-end repeat barline</span></div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;                  <span class="comment">// and we can remove the start repeat barline of the current barline</span></div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                  <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isMeasure()) {</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* m1 = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;                        <span class="keywordflow">if</span> (m1-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>()) {</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;                              <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m1-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">SegmentType::StartRepeatBarLine</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;                              <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">enabled</a>()) {</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;                                    s-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;                                    m1-&gt;<a class="code" href="classMs_1_1Measure.html#ac829548f174316a6275ff01600254da8">computeMinWidth</a>();</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;                                    ww = m1-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                                    }</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                              }</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;                        }</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                  <span class="comment">// TODO: we actually still don&#39;t know for sure</span></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                  <span class="comment">// if this will be the last true measure of the system or not</span></div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                  <span class="comment">// since the lc.curMeasure may be a frame</span></div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                  <span class="comment">// but at this point we have no choice but to assume it isn&#39;t</span></div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;                  <span class="comment">// since we don&#39;t know yet if another true measure will fit</span></div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;                  <span class="comment">// worst that happens is we don&#39;t get the automatic double bar before a courtesy key signature</span></div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;                  minWidth += m-&gt;<a class="code" href="classMs_1_1Measure.html#aa910bff7edd9435bd775b373f6010b34">createEndBarLines</a>(<span class="keyword">false</span>);    <span class="comment">// create final barLine</span></div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;                  }</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;            <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;            <span class="keywordtype">bool</span> lineBreak  = <span class="keyword">false</span>;</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classMs_1_1Score.html#a0169fb17fae5207d537cb8f2c3a3951f">_layoutMode</a>) {</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1ba22311203d44b308bd2d607cdc2dcb72c">LayoutMode::PAGE</a>:</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bafa177138f94a7ea01f549b1aa7893d03">LayoutMode::SYSTEM</a>:</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;                        lineBreak = mb-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6c58c83a689bd9d8caa462ab3559b176">pageBreak</a>() || mb-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ad4153b0dbfe2fb2a229fd93a45c71f7b">lineBreak</a>() || mb-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>();</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6">LayoutMode::FLOAT</a>:</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1ba17b8ef2c330f1430e00c9de5469fc7e7">LayoutMode::LINE</a>:</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;                        lineBreak = <span class="keyword">false</span>;</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;                  }</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;            <span class="comment">// preserve state of next measure (which is about to become current measure)</span></div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;            <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>) {</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;                  <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* nmb = lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>;</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;                  <span class="keywordflow">if</span> (nmb-&gt;isMeasure() &amp;&amp; <a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea83a473e523160149b1f60621fcba0b5b">Sid::createMultiMeasureRests</a>)) {</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* nm = toMeasure(nmb);</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                        <span class="keywordflow">if</span> (nm-&gt;<a class="code" href="classMs_1_1Measure.html#a9491f66d4e4c82e05aaea063d3654ac8">hasMMRest</a>())</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;                              nmb = nm-&gt;<a class="code" href="classMs_1_1Measure.html#a9109c2c9621f0cc9ecd86afcae54afe8">mmRest</a>();</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                        }</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                  curWidth = nmb-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                  curHeader = nmb-&gt;<a class="code" href="classMs_1_1Element.html#abb3880878a2f2826b253d5e0e14b32b6">header</a>();</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                  curTrailer = nmb-&gt;<a class="code" href="classMs_1_1Element.html#a868f0f5663dd1d7422c19700e070a4a6">trailer</a>();</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                  }</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;            <a class="code" href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de">getNextMeasure</a>(lc);</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;            minWidth += ww;</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;            <span class="comment">// ElementType nt = lc.curMeasure ? lc.curMeasure-&gt;type() : ElementType::INVALID;</span></div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;            mb = lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;            <span class="keywordtype">bool</span> tooWide = <span class="keyword">false</span>; <span class="comment">// minWidth + minMeasureWidth &gt; systemWidth;  // TODO: noBreak</span></div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;            <span class="keywordflow">if</span> (lineBreak || !mb || mb-&gt;isVBox() || mb-&gt;isTBox() || mb-&gt;isFBox() || tooWide)</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;            }</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">endTick</a> &lt; lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>()) {</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;            <span class="comment">// we&#39;ve processed the entire range</span></div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            <span class="comment">// but we need to continue layout until we reach a system whose last measure is the same as previous layout</span></div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;            <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> == lc.<a class="code" href="structMs_1_1LayoutContext.html#a7e8b4ba56f18cb041803394a6cf5128a">systemOldMeasure</a>) {</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                  <span class="comment">// this system ends in the same place as the previous layout</span></div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                  <span class="comment">// ok to stop</span></div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                  <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a> &amp;&amp; lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>-&gt;isMeasure()) {</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                        <span class="comment">// we may have previously processed first measure of next system</span></div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                        <span class="comment">// so now we must restore it to its original state</span></div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a>);</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                        <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">repeatStart</a>()) {</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                              <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">findSegmentR</a>(<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">SegmentType::StartRepeatBarLine</a>, <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1));</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                              <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">enabled</a>())</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                                    s-&gt;<a class="code" href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">setEnabled</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                              }</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;                        <span class="comment">// TODO: use findPotentialSectionBreak here to handle breaks on frames correctly?</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;                        <span class="keywordtype">bool</span> firstSystem = lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>() &amp;&amp; <a class="code" href="classMs_1_1Score.html#a0169fb17fae5207d537cb8f2c3a3951f">_layoutMode</a> != <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6">LayoutMode::FLOAT</a>;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                        <span class="keywordflow">if</span> (curHeader)</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                              m-&gt;<a class="code" href="classMs_1_1Measure.html#ac7e0eb9cc9bfb9d619f2cb52ba6f2ea8">addSystemHeader</a>(firstSystem);</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                              m-&gt;<a class="code" href="classMs_1_1Measure.html#a90caa02f9c7dfbb0b6f8e96134c29257">removeSystemHeader</a>();</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                        <span class="keywordflow">if</span> (curTrailer)</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                              m-&gt;<a class="code" href="classMs_1_1Measure.html#a260e48485af749a75d5e763700e13010">addSystemTrailer</a>(m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>());</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                              m-&gt;<a class="code" href="classMs_1_1Measure.html#a95d953121aa2ea9b6db91e2b147fed50">removeSystemTrailer</a>();</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                        m-&gt;<a class="code" href="classMs_1_1Measure.html#ac829548f174316a6275ff01600254da8">computeMinWidth</a>();</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                        m-&gt;<a class="code" href="classMs_1_1Measure.html#a979df7753ae3d039720198643f865f56">stretchMeasure</a>(curWidth);</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                        <a class="code" href="namespaceMs.html#a828b7d077638066c078fd12c2e34aa14">restoreBeams</a>(m);</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                        }</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a024756cf326cb9c76731aab5f4b152a6">rangeDone</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                  }</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;            }</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      <span class="comment">// now we have a complete set of measures for this system</span></div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <span class="comment">// prevMeasure is the last measure in the system</span></div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> &amp;&amp; lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>-&gt;isMeasure()) {</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;            <a class="code" href="namespaceMs.html#aa80fcdcc05a733b5f5503f5ebac3913e">breakCrossMeasureBeams</a>(toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>));</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;            qreal w = toMeasure(lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a>)-&gt;createEndBarLines(<span class="keyword">true</span>);</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            minWidth += w;</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;            }</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      <a class="code" href="classMs_1_1Score.html#aeb406ae3e71511fd168057f3f5b22bb9">hideEmptyStaves</a>(system, lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a>);</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      <span class="comment">// Relayout system decorations to reuse space properly for</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      <span class="comment">// hidden staves&#39; instrument names or other hidden elements.</span></div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      minWidth -= system-&gt;<a class="code" href="classMs_1_1System.html#ad440df7f5d01eb8f57f7752a96a4a780">leftMargin</a>();</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      system-&gt;<a class="code" href="classMs_1_1System.html#a3e4c82785c6f5a878ae8ce6f80f145da">layoutSystem</a>(layoutSystemMinWidth, lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a>, lc.<a class="code" href="structMs_1_1LayoutContext.html#a4ce269915101a420df2d17c7082ec9d8">firstSystemIndent</a>);</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      minWidth += system-&gt;<a class="code" href="classMs_1_1System.html#ad440df7f5d01eb8f57f7752a96a4a780">leftMargin</a>();</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;      <span class="comment">//-------------------------------------------------------</span></div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      <span class="comment">//    add system trailer if needed</span></div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;      <span class="comment">//    (cautionary time/key signatures etc)</span></div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      <span class="comment">//-------------------------------------------------------</span></div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;      <a class="code" href="classMs_1_1Measure.html">Measure</a>* lm  = system-&gt;<a class="code" href="classMs_1_1System.html#aca7cbaa5dba797868bab81428164e673">lastMeasure</a>();</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      <span class="keywordflow">if</span> (lm) {</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;            <a class="code" href="classMs_1_1Measure.html">Measure</a>* nm = lm-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">nextMeasure</a>();</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;            <span class="keywordflow">if</span> (nm) {</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                  qreal w = lm-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                  lm-&gt;<a class="code" href="classMs_1_1Measure.html#a260e48485af749a75d5e763700e13010">addSystemTrailer</a>(nm);</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                  <span class="keywordflow">if</span> (lm-&gt;<a class="code" href="classMs_1_1Element.html#a868f0f5663dd1d7422c19700e070a4a6">trailer</a>())</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                        lm-&gt;<a class="code" href="classMs_1_1Measure.html#ac829548f174316a6275ff01600254da8">computeMinWidth</a>();</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                  minWidth += lm-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>() - w;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                  }</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;            }</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;      <span class="comment">// stretch incomplete row</span></div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      qreal rest;</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1MScore.html#a0df5f1a470654ab4cd89e148f2d6f14f">MScore::noHorizontalStretch</a>)</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;            rest = 0;</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;            qreal mw          = system-&gt;<a class="code" href="classMs_1_1System.html#ad440df7f5d01eb8f57f7752a96a4a780">leftMargin</a>();      <span class="comment">// DEBUG</span></div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;            qreal totalWeight = 0.0;</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                  <span class="keywordflow">if</span> (mb-&gt;isHBox()) {</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                        mw += mb-&gt;width();</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                        }</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mb-&gt;isMeasure()) {</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                        <a class="code" href="classMs_1_1Measure.html">Measure</a>* m  = toMeasure(mb);</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;                        mw          += m-&gt;<a class="code" href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">width</a>();               <span class="comment">// measures are stretched already with basicStretch()</span></div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;                        <span class="keywordtype">int</span> weight   = m-&gt;<a class="code" href="classMs_1_1Measure.html#aec5e17c92d990fc2b60e77225552fd1c">layoutWeight</a>();</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;                        totalWeight += weight * m-&gt;<a class="code" href="classMs_1_1Measure.html#ae941c476b82dd103f64991ee3fff131f">basicStretch</a>();</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;                        }</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;                  }</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;            <span class="keywordflow">if</span> (!qFuzzyCompare(mw, minWidth))</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                  qDebug(<span class="stringliteral">&quot;==layoutSystem %6d old %.1f new %.1f&quot;</span>, system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().front()-&gt;tick().ticks(), minWidth, mw);</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;            rest = systemWidth - minWidth;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;            <span class="comment">// don’t stretch last system row, if accumulated minWidth is &lt;= lastSystemFillLimit</span></div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;            <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">curMeasure</a> == 0 &amp;&amp; ((minWidth / systemWidth) &lt;= <a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaab98622c976c49f95db66b4525f10789">Sid::lastSystemFillLimit</a>))) {</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;                  <span class="keywordflow">if</span> (minWidth &gt; rest)</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;                        rest = rest * .5;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;                        rest = minWidth;</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                  }</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;            rest /= totalWeight;</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;            }</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;      QPointF <a class="code" href="classMs_1_1Score.html#a79b3e923044c67ce26c45dd20f22d849">pos</a>;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      firstMeasure = <span class="keyword">true</span>;</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;      <span class="keywordtype">bool</span> createBrackets = <span class="keyword">false</span>;</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;            qreal ww = mb-&gt;width();</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;            <span class="keywordflow">if</span> (mb-&gt;isMeasure()) {</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;                  <span class="keywordflow">if</span> (firstMeasure) {</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;                        pos.rx() += system-&gt;<a class="code" href="classMs_1_1System.html#ad440df7f5d01eb8f57f7752a96a4a780">leftMargin</a>();</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;                        firstMeasure = <span class="keyword">false</span>;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;                        }</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;                  mb-&gt;setPos(pos);</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                  qreal stretch = m-&gt;<a class="code" href="classMs_1_1Measure.html#ae941c476b82dd103f64991ee3fff131f">basicStretch</a>();</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;                  <span class="keywordtype">int</span> weight = m-&gt;<a class="code" href="classMs_1_1Measure.html#aec5e17c92d990fc2b60e77225552fd1c">layoutWeight</a>();</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                  ww  += rest * weight * stretch;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                  m-&gt;<a class="code" href="classMs_1_1Measure.html#a979df7753ae3d039720198643f865f56">stretchMeasure</a>(ww);</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                  m-&gt;<a class="code" href="classMs_1_1Measure.html#a4a1ae88c341d451822e9c710fffdba10">layoutStaffLines</a>();</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;                  <span class="keywordflow">if</span> (createBrackets) {</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                        system-&gt;<a class="code" href="classMs_1_1System.html#a2837b53e5e5172c8e7fe77a2fc634e41">addBrackets</a>(toMeasure(mb));</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                        createBrackets = <span class="keyword">false</span>;</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                        }</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                  }</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mb-&gt;isHBox()) {</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;                  mb-&gt;setPos(pos + QPointF(toHBox(mb)-&gt;topGap(), 0.0));</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;                  mb-&gt;layout();</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;                  createBrackets = toHBox(mb)-&gt;createSystemHeader();</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;                  }</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mb-&gt;isVBox())</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                  mb-&gt;setPos(pos);</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;            pos.rx() += ww;</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;            }</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      system-&gt;<a class="code" href="classMs_1_1Element.html#ae3346b5a7ad5893674afc28c9b0877ec">setWidth</a>(pos.x());</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;      <a class="code" href="classMs_1_1Score.html#aed4bf9dbb6034a370cc1222ff676204e">layoutSystemElements</a>(system, lc);</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;      system-&gt;<a class="code" href="classMs_1_1System.html#a50176508633e0790e3569239bf671d62">layout2</a>();   <span class="comment">// compute staff distances</span></div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;      <span class="comment">// TODO: now that the code at the top of this function does this same backwards search,</span></div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;      <span class="comment">// we might be able to eliminate this block</span></div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;      <span class="comment">// but, lc might be used elsewhere so we need to be careful</span></div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="preprocessor">#if 1</span></div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      measure = system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().back();</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;      <span class="keywordflow">if</span> (measure)</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;            measure = measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a7990eccc3ffa4f1e133b730e2bcba46b">findPotentialSectionBreak</a>();</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;      <span class="keywordflow">if</span> (measure) {</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a>        = measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">sectionBreak</a>() &amp;&amp; <a class="code" href="classMs_1_1Score.html#a0169fb17fae5207d537cb8f2c3a3951f">_layoutMode</a> != <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6">LayoutMode::FLOAT</a>;</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a4ce269915101a420df2d17c7082ec9d8">firstSystemIndent</a>  = lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a> &amp;&amp; measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>()-&gt;<a class="code" href="classMs_1_1LayoutBreak.html#aa955f1ea366e08738cdde0cc4362a3ad">firstSystemIdentation</a>() &amp;&amp; <a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea322eea03da4654d479967cb87170853d">Sid::enableIndentationOnFirstSystem</a>);</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a1f36066aac6e0601246d56816129b7e7">startWithLongNames</a> = lc.<a class="code" href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">firstSystem</a> &amp;&amp; measure-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>()-&gt;<a class="code" href="classMs_1_1LayoutBreak.html#a8e4a14b94f7c6e0fd0b1fd6cd44bc2dd">startWithLongNames</a>();</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;            }</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      <span class="keywordflow">return</span> system;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      }</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="comment">//   layoutSystemElements</span></div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div><div class="line"><a name="l04090"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#aed4bf9dbb6034a370cc1222ff676204e"> 4090</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#aed4bf9dbb6034a370cc1222ff676204e">Score::layoutSystemElements</a>(<a class="code" href="classMs_1_1System.html">System</a>* system, <a class="code" href="structMs_1_1LayoutContext.html">LayoutContext</a>&amp; lc)</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;      {</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      <span class="comment">//    create cr segment list to speed up computations</span></div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;      std::vector&lt;Segment*&gt; sl;</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;            <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;            <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;            m-&gt;<a class="code" href="classMs_1_1Measure.html#a6b47e5546f64b548040f03aed658a179">layoutMeasureNumber</a>();</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;            m-&gt;<a class="code" href="classMs_1_1Measure.html#a54ce7041fcfd559145860e47490bff0a">layoutMMRestRange</a>();</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;            <span class="comment">// in continuous view, entire score is one system</span></div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;            <span class="comment">// but we only need to process the range</span></div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a7e623a06766698ff471836eac2f3fa57">lineMode</a>() &amp;&amp; (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() &lt; lc.<a class="code" href="structMs_1_1LayoutContext.html#a19322e850e35356fc301b735ed3900c8">startTick</a> || m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() &gt; lc.<a class="code" href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">endTick</a>))</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(); s; s = s-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>()) {</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                  <span class="keywordflow">if</span> (s-&gt;isChordRestType() || !s-&gt;annotations().empty())</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;                        sl.push_back(s);</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                  }</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;            }</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      <span class="comment">// layout beams</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;      <span class="comment">//  Needs to be done before creating skylines as stem lengths</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;      <span class="comment">//  may change.</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;elist()) {</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;                  <span class="keywordflow">if</span> (!e || !e-&gt;isChordRest() || !<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(e-&gt;staffIdx())-&gt;show()) {</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;                        <span class="comment">// the beam and its system may still be referenced when selecting all,</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                        <span class="comment">// even if the staff is invisible. The old system is invalid and does cause problems in #284012</span></div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                        <span class="keywordflow">if</span> (e &amp;&amp; e-&gt;isChordRest() &amp;&amp; !<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(e-&gt;staffIdx())-&gt;show() &amp;&amp; <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e)-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>())</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;                              <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e)-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>()-&gt;<a class="code" href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">setParent</a>(<span class="keyword">nullptr</span>);</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                        }</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;                  <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                  <span class="comment">// layout beam</span></div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a410467a129f146b200e237377e2a695c">isTopBeam</a>(cr)) {</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                        <a class="code" href="classMs_1_1Beam.html">Beam</a>* b = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                        b-&gt;<a class="code" href="classMs_1_1Beam.html#ac2c76daf5a9dc4c3cc0f366a394ab4d6">layout</a>();</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                        }</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                  }</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;            }</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      <span class="comment">//    create skylines</span></div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;            <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a>* ss = system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;            <a class="code" href="classMs_1_1Skyline.html">Skyline</a>&amp; skyline = ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>();</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;            skyline.<a class="code" href="classMs_1_1Skyline.html#a3c189e0748d2d449f71a264e284ab21b">clear</a>();</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                  <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                  <a class="code" href="classMs_1_1MeasureNumber.html">MeasureNumber</a>* mno = m-&gt;<a class="code" href="classMs_1_1Measure.html#ae8a8d5cae3cb7386cd6012953ab92573">noText</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;                  <a class="code" href="classMs_1_1MMRestRange.html">MMRestRange</a>* mmrr  = m-&gt;<a class="code" href="classMs_1_1Measure.html#a45c227344f847388a341fbdda6efe978">mmRangeText</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;                  <span class="comment">// no need to build skyline outside of range in continuous view</span></div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a7e623a06766698ff471836eac2f3fa57">lineMode</a>() &amp;&amp; (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() &lt; lc.<a class="code" href="structMs_1_1LayoutContext.html#a19322e850e35356fc301b735ed3900c8">startTick</a> || m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>() &gt; lc.<a class="code" href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">endTick</a>))</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                  <span class="keywordflow">if</span> (mno &amp;&amp; mno-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                        ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(mno-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().translated(m-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + mno-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                  <span class="keywordflow">if</span> (mmrr &amp;&amp; mmrr-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                        ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(mmrr-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().translated(m-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + mmrr-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;                  <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1Measure.html#ac872216bf9760613e1f059f8531be5ad">staffLines</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;                        ss-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(m-&gt;<a class="code" href="classMs_1_1Measure.html#ac872216bf9760613e1f059f8531be5ad">staffLines</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().translated(m-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>&amp; s : m-&gt;<a class="code" href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">segments</a>()) {</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                        <span class="keywordflow">if</span> (!s.enabled() || s.isTimeSigType())       <span class="comment">// hack: ignore time signatures</span></div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;                        QPointF p(s.pos() + m-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>());</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;                        <span class="keywordflow">if</span> (s.segmentType() &amp; (<a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aa82364cc325a1dcba2361dbc4531c0ac">SegmentType::BarLine</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d">SegmentType::EndBarLine</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">SegmentType::StartRepeatBarLine</a> | <a class="code" href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a99d2eb8b30f0aa252f5382705006fa78">SegmentType::BeginBarLine</a>)) {</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;                              <a class="code" href="classMs_1_1BarLine.html">BarLine</a>* bl = toBarLine(s.element(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>));</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;                              <span class="keywordflow">if</span> (bl &amp;&amp; bl-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>()) {</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;                                    QRectF r = bl-&gt;<a class="code" href="classMs_1_1BarLine.html#a315de2de22b2736e597f2b008619d7cc">layoutRect</a>();</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;                                    skyline.<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(r.translated(bl-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + p));</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                                    }</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                              }</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                        <span class="keywordflow">else</span> {</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                              <span class="keywordtype">int</span> strack = <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> * <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                              <span class="keywordtype">int</span> etrack = strack + <a class="code" href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a>;</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                              <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s.elist()) {</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                                    <span class="keywordflow">if</span> (!e)</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;                                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                                    <span class="keywordtype">int</span> effectiveTrack = e-&gt;vStaffIdx() * VOICES + e-&gt;voice();</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                                    <span class="keywordflow">if</span> (effectiveTrack &lt; strack || effectiveTrack &gt;= etrack)</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;                                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;                                    <span class="comment">// clear layout for chord-based fingerings</span></div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;                                    <span class="comment">// do this before adding chord to skyline</span></div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;                                    <span class="keywordflow">if</span> (e-&gt;isChord()) {</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;                                          <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(e);</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;                                          std::list&lt;Note*&gt; notes;</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;                                          <span class="keywordflow">for</span> (<span class="keyword">auto</span> gc : c-&gt;<a class="code" href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">graceNotes</a>()) {</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;                                                <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : gc-&gt;notes())</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;                                                      notes.push_back(n);</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;                                                }</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                                          <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : c-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>())</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;                                                notes.push_back(n);</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                                          <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Note.html">Note</a>* note : notes) {</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;                                                <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* en : note-&gt;el()) {</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                                                      <span class="keywordflow">if</span> (en-&gt;isFingering()) {</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                                                            <a class="code" href="classMs_1_1Fingering.html">Fingering</a>* f = toFingering(en);</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;                                                            <span class="keywordflow">if</span> (f-&gt;<a class="code" href="classMs_1_1Fingering.html#ab204d8fc9e7842c1798326888039c13f">layoutType</a>() == <a class="code" href="namespaceMs.html#a2c92ce0204176ede1ab86e2f44ae6b9ea45d886b842022787183a308e0200d336">ElementType::CHORD</a>) {</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                                                                  f-&gt;<a class="code" href="classMs_1_1Element.html#a2a2ce2358cc23529d8f038a940062e62">setPos</a>(QPointF());</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                                                                  f-&gt;<a class="code" href="classMs_1_1Element.html#abe5c0aa8e74388b2b6b336dfec469a35">setbbox</a>(QRectF());</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                                                                  }</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                                                            }</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;                                                      }</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                                                }</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                                          }</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                                    <span class="comment">// add element to skyline</span></div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                                    <span class="keywordflow">if</span> (e-&gt;addToSkyline())</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                                          skyline.<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(e-&gt;shape().translated(e-&gt;pos() + p));</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                    <span class="comment">// add tremolo to skyline</span></div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                                    <span class="keywordflow">if</span> (e-&gt;isChord() &amp;&amp; toChord(e)-&gt;tremolo()) {</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                                          <a class="code" href="classMs_1_1Tremolo.html">Tremolo</a>* t = toChord(e)-&gt;tremolo();</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                                          <a class="code" href="classMs_1_1Chord.html">Chord</a>* c1 = t-&gt;<a class="code" href="classMs_1_1Tremolo.html#af3fbc117c926f4bc9bd5f0ee3e8ad478">chord1</a>();</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                                          <a class="code" href="classMs_1_1Chord.html">Chord</a>* c2 = t-&gt;<a class="code" href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">chord2</a>();</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                                          <span class="keywordflow">if</span> (!t-&gt;<a class="code" href="classMs_1_1Tremolo.html#a7e98943cb86fb69bc5e59024f3d880fd">twoNotes</a>() || (c1 &amp;&amp; !c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() &amp;&amp; c2 &amp;&amp; !c2-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>())) {</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                                                <span class="keywordflow">if</span> (t-&gt;<a class="code" href="classMs_1_1Tremolo.html#a1abc92c0d4a32a0fc905da22dac303d9">chord</a>() == e &amp;&amp; t-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                                                      skyline.<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(t-&gt;<a class="code" href="classMs_1_1Element.html#ad46a1fa8985b3d3897101b295a7a5d3e">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(t-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + e-&gt;pos() + p));</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                                                }</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                                          }</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                                    }</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                              }</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                        }</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                  }</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;            }</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;      <span class="comment">// layout fingerings, add beams to skylines</span></div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;            std::set&lt;int&gt; recreateShapes;</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;elist()) {</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                  <span class="keywordflow">if</span> (!e || !e-&gt;isChordRest() || !<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(e-&gt;staffIdx())-&gt;show())</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                  <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;                  <span class="comment">// add beam to skyline</span></div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a410467a129f146b200e237377e2a695c">isTopBeam</a>(cr)) {</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;                        <a class="code" href="classMs_1_1Beam.html">Beam</a>* b = cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>();</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;                        b-&gt;<a class="code" href="classMs_1_1Beam.html#a7735446d0fd3fbe4fecb1a6ab149c146">addSkyline</a>(system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(b-&gt;<a class="code" href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">staffIdx</a>())-&gt;skyline());</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;                        }</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                  <span class="comment">// layout chord-based fingerings</span></div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isChord()) {</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                        <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(e);</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;                        std::list&lt;Note*&gt; notes;</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">auto</span> gc : c-&gt;<a class="code" href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">graceNotes</a>()) {</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;                              <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : gc-&gt;notes())</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;                                    notes.push_back(n);</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;                              }</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : c-&gt;<a class="code" href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">notes</a>())</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                              notes.push_back(n);</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                        std::list&lt;Fingering*&gt; fingerings;</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Note.html">Note</a>* note : notes) {</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                              <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* el : note-&gt;el()) {</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;                                    <span class="keywordflow">if</span> (el-&gt;isFingering()) {</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;                                          <a class="code" href="classMs_1_1Fingering.html">Fingering</a>* f = toFingering(el);</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;                                          <span class="keywordflow">if</span> (f-&gt;<a class="code" href="classMs_1_1Fingering.html#ab204d8fc9e7842c1798326888039c13f">layoutType</a>() == <a class="code" href="namespaceMs.html#a2c92ce0204176ede1ab86e2f44ae6b9ea45d886b842022787183a308e0200d336">ElementType::CHORD</a>) {</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;                                                <span class="keywordflow">if</span> (f-&gt;<a class="code" href="classMs_1_1Element.html#a8ba22391443270db0f91a3164c457d1e">placeAbove</a>())</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                                                      fingerings.push_back(f);</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                                                <span class="keywordflow">else</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                                                      fingerings.push_front(f);</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                                                }</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;                                          }</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;                                    }</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;                              }</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Fingering.html">Fingering</a>* f : fingerings) {</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;                              f-&gt;layout();</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;                              <span class="keywordflow">if</span> (f-&gt;addToSkyline()) {</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                                    <a class="code" href="classMs_1_1Note.html">Note</a>* n = f-&gt;note();</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;                                    QRectF r = f-&gt;<a class="code" href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">bbox</a>().translated(f-&gt;pos() + n-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + n-&gt;<a class="code" href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">chord</a>()-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + s-&gt;pos() + s-&gt;measure()-&gt;pos());</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                                    system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(f-&gt;note()-&gt;chord()-&gt;vStaffIdx())-&gt;skyline().add(r);</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                                    }</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                              recreateShapes.insert(f-&gt;staffIdx());</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;                              }</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;                        }</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;                  }</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> : recreateShapes)</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                  s-&gt;createShape(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>);</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;            }</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;      <span class="comment">// layout articulations</span></div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;elist()) {</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                  <span class="keywordflow">if</span> (!e || !e-&gt;isChordRest() || !<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(e-&gt;staffIdx())-&gt;show())</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                  <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                  <span class="comment">// articulations</span></div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                  <span class="keywordflow">if</span> (cr-&gt;isChord()) {</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;                        <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(cr);</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                        c-&gt;<a class="code" href="classMs_1_1Chord.html#a085dc30a4daa69c394cd0031221d33dc">layoutArticulations</a>();</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                        c-&gt;<a class="code" href="classMs_1_1Chord.html#a7a2b6622bd7c71f0960ec67403093f7c">layoutArticulations2</a>();</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                        }</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                  }</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;            }</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      <span class="comment">// layout tuplets</span></div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;elist()) {</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;                  <span class="keywordflow">if</span> (!e || !e-&gt;isChordRest() || !<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(e-&gt;staffIdx())-&gt;show())</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                  <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="namespaceMs.html#a35bfb67e4b99502eb95a081fa7827322">isTopTuplet</a>(cr))</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                  <a class="code" href="classMs_1_1DurationElement.html">DurationElement</a>* de = cr;</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                  <span class="keywordflow">while</span> (de-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>() &amp;&amp; de-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>()-&gt;<a class="code" href="classMs_1_1Tuplet.html#a335f84666bd36e2bca5963785ae9759a">elements</a>().front() == de) {</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                        <a class="code" href="classMs_1_1Tuplet.html">Tuplet</a>* t = de-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>();</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;                        t-&gt;<a class="code" href="classMs_1_1Tuplet.html#a4926540c91f806d69f5b56be91301c7c">layout</a>();</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                        de = t;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                        }</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                  }</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;            }</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      <span class="comment">// Drumline sticking</span></div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isSticking())</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;                        e-&gt;<a class="code" href="classMs_1_1Tuplet.html#a4926540c91f806d69f5b56be91301c7c">layout</a>();</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;                  }</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;            }</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;      <span class="comment">// layout slurs</span></div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;      <span class="keywordtype">bool</span> useRange = <span class="keyword">false</span>;  <span class="comment">// TODO: lineMode();</span></div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> stick = useRange ? lc.<a class="code" href="structMs_1_1LayoutContext.html#a19322e850e35356fc301b735ed3900c8">startTick</a> : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().front()-&gt;tick();</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> etick = useRange ? lc.<a class="code" href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">endTick</a> : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().back()-&gt;endTick();</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      <span class="keyword">auto</span> spanners = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#aec3ae8afe6d74337ccdaf50a735f4c92">spannerMap</a>().<a class="code" href="classMs_1_1SpannerMap.html#a50d0c4abc63052ad825a4c48cc72dbd3">findOverlapping</a>(stick.<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>(), etick.<a class="code" href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">ticks</a>());</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      std::vector&lt;Spanner*&gt; <a class="code" href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">spanner</a>;</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> interval : spanners) {</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            <a class="code" href="classMs_1_1Spanner.html">Spanner</a>* sp = interval.value;</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;            sp-&gt;<a class="code" href="classMs_1_1Spanner.html#ae142fe51440f8deeec1e5a4844042714">computeStartElement</a>();</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;            sp-&gt;<a class="code" href="classMs_1_1Spanner.html#a5fc082bf786fe24117dc3bdce289a7fe">computeEndElement</a>();</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#acd8aacbbce632709b24bc9554ffe976a">processedSpanners</a>.insert(sp);</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;            <span class="keywordflow">if</span> (sp-&gt;<a class="code" href="classMs_1_1Spanner.html#a825bfba09be9b0598940b854ba494312">tick</a>() &lt; etick &amp;&amp; sp-&gt;<a class="code" href="classMs_1_1Spanner.html#affc33cb9d3e419eb2c5a52ecb9e44736">tick2</a>() &gt;= stick) {</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;                  <span class="keywordflow">if</span> (sp-&gt;isSlur()) {</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;                        <span class="comment">// skip cross-staff slurs</span></div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;                        <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* scr = sp-&gt;<a class="code" href="classMs_1_1Spanner.html#a55786c568edbcf9796d5be5971f8eb12">startCR</a>();</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;                        <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* ecr = sp-&gt;<a class="code" href="classMs_1_1Spanner.html#ad6858aab488742d20c542d35ac7bf7f1">endCR</a>();</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;                        <span class="keywordtype">int</span> idx = sp-&gt;<a class="code" href="classMs_1_1Element.html#ad1e0d3968ecafec4140aac087bd8fd99">vStaffIdx</a>();</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;                        <span class="keywordflow">if</span> (scr &amp;&amp; ecr &amp;&amp; (scr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a7b344ea7b12893001b693d782d19a081">vStaffIdx</a>() != idx || ecr-&gt;<a class="code" href="classMs_1_1ChordRest.html#a7b344ea7b12893001b693d782d19a081">vStaffIdx</a>() != idx))</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;                              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                        spanner.push_back(sp);</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;                        }</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;                  }</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;            }</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(system, spanner, <span class="keyword">false</span>);</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : spanner) {</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;            <a class="code" href="classMs_1_1Slur.html">Slur</a>* slur = toSlur(s);</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* scr = s-&gt;startCR();</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;            <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* ecr = s-&gt;endCR();</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;            <span class="keywordflow">if</span> (scr &amp;&amp; scr-&gt;isChord())</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                  toChord(scr)-&gt;layoutArticulations3(slur);</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;            <span class="keywordflow">if</span> (ecr &amp;&amp; ecr-&gt;isChord())</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                  toChord(ecr)-&gt;layoutArticulations3(slur);</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;            }</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;      std::vector&lt;Dynamic*&gt; dynamics;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;elist()) {</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                  <span class="keywordflow">if</span> (!e)</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isChord()) {</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;                        <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(e);</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Chord.html">Chord</a>* ch : c-&gt;<a class="code" href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">graceNotes</a>())</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                              <a class="code" href="namespaceMs.html#a312ec8a39e6d4053d8f84c23b86ceaec">layoutTies</a>(ch, system, stick);</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                        <a class="code" href="namespaceMs.html#a312ec8a39e6d4053d8f84c23b86ceaec">layoutTies</a>(c, system, stick);</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                        }</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                  }</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isDynamic()) {</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;                        <a class="code" href="classMs_1_1Dynamic.html">Dynamic</a>* d = toDynamic(e);</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;                        d-&gt;<a class="code" href="classMs_1_1Dynamic.html#ae87cc1992bd580193735cf22e05fdeea">layout</a>();</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;                        <span class="keywordflow">if</span> (d-&gt;<a class="code" href="classMs_1_1Element.html#a36da6a07a74436d96c739f7134873eda">autoplace</a>()) {</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;                              d-&gt;<a class="code" href="classMs_1_1Element.html#ab5518cc652f95d5d64ddd2bd7bfc6f6b">autoplaceSegmentElement</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;                              dynamics.push_back(d);</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;                              }</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                        }</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;isFiguredBass()) {</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                        e-&gt;autoplaceSegmentElement();</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                        }</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                  }</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;            }</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      <span class="comment">// add dynamics shape to skyline</span></div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Dynamic.html">Dynamic</a>* d : dynamics) {</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;            <span class="keywordflow">if</span> (!d-&gt;addToSkyline())</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;            <span class="keywordtype">int</span> si = d-&gt;staffIdx();</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;            <a class="code" href="classMs_1_1Segment.html">Segment</a>* s = d-&gt;segment();</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;            <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = s-&gt;<a class="code" href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">measure</a>();</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;            system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(si)-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(d-&gt;shape().translated(d-&gt;pos() + s-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>() + m-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;            }</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      <span class="comment">// layout SpannerSegments for current system</span></div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      <span class="comment">// ottavas, pedals, voltas are collected here, but layouted later</span></div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      spanner.clear();</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      std::vector&lt;Spanner*&gt; hairpins;</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;      std::vector&lt;Spanner*&gt; ottavas;</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      std::vector&lt;Spanner*&gt; pedal;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;      std::vector&lt;Spanner*&gt; voltas;</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> interval : spanners) {</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;            <a class="code" href="classMs_1_1Spanner.html">Spanner</a>* sp = interval.value;</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;            <span class="keywordflow">if</span> (sp-&gt;<a class="code" href="classMs_1_1Spanner.html#a825bfba09be9b0598940b854ba494312">tick</a>() &lt; etick &amp;&amp; sp-&gt;<a class="code" href="classMs_1_1Spanner.html#affc33cb9d3e419eb2c5a52ecb9e44736">tick2</a>() &gt; stick) {</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;                  <span class="keywordflow">if</span> (sp-&gt;isOttava())</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                        ottavas.push_back(sp);</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sp-&gt;isPedal())</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;                        pedal.push_back(sp);</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sp-&gt;isVolta())</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                        voltas.push_back(sp);</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sp-&gt;isHairpin())</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;                        hairpins.push_back(sp);</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!sp-&gt;isSlur() &amp;&amp; !sp-&gt;isVolta())    <span class="comment">// slurs are already</span></div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                        spanner.push_back(sp);</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;                  }</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;            }</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;      <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(system, hairpins, <span class="keyword">false</span>);</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;      <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(system, spanner, <span class="keyword">false</span>);</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;      <span class="comment">// Fermata, TremoloBar</span></div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isFermata() || e-&gt;isTremoloBar())</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;                  }</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;            }</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;      <span class="comment">// Ottava, Pedal</span></div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;      <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(system, ottavas, <span class="keyword">false</span>);</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(system, pedal,   <span class="keyword">true</span>);</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <span class="comment">// Lyric</span></div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      <a class="code" href="classMs_1_1Score.html#a6a5f3aed4895d192dfe62c82bf654e12">layoutLyrics</a>(system);</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      <span class="comment">// here are lyrics dashes and melisma</span></div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Spanner.html">Spanner</a>* sp : <a class="code" href="classMs_1_1Score.html#a089fc60c82e4545af67d42ef3f805e15">_unmanagedSpanner</a>) {</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;            <span class="keywordflow">if</span> (sp-&gt;tick() &gt;= etick || sp-&gt;tick2() &lt;= stick)</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;            sp-&gt;layoutSystem(system);</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;            }</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;      <span class="comment">// We need to known if we have FretDiagrams in the system to decide when to layout the Harmonies</span></div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      <span class="keywordtype">bool</span> hasFretDiagram = <span class="keyword">false</span>;</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isFretDiagram()) {</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;                        hasFretDiagram = <span class="keyword">true</span>;</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;                        }</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;                  }</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;            <span class="keywordflow">if</span> (hasFretDiagram)</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;            }</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;      <span class="comment">// Harmony, 1st place</span></div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;      <span class="comment">// If we have FretDiagrams, we want the Harmony above this and</span></div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;      <span class="comment">// above the volta, therefore we delay the layout.</span></div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;      <span class="keywordflow">if</span> (!hasFretDiagram) {</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;            <a class="code" href="namespaceMs.html#a130aa9f1611e42fc06a6eaee6d78da2d">layoutHarmonies</a>(sl);</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;            <a class="code" href="namespaceMs.html#a39873f2b64993a8c6b6754e3a78a4bf1">alignHarmonies</a>(system, sl, <span class="keyword">true</span>, <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaad8449ae5f63b8b3de90b8912c0266da">Sid::maxChordShiftAbove</a>), <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaeb0392e5088cc5879c0ee75a930b762c">Sid::maxChordShiftBelow</a>));</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;            }</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      <span class="comment">// StaffText, InstrumentChange</span></div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isStaffText() || e-&gt;isSystemText() || e-&gt;isInstrumentChange())</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                  }</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;            }</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      <span class="comment">// Jump, Marker</span></div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : system-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>()) {</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;            <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;            <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0832f1270b77762f3c12758fe22c3c2">el</a>()) {</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isJump() || e-&gt;isMarker())</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                  }</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;            }</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;      <span class="comment">// TempoText</span></div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isTempoText())</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                  }</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;            }</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      <span class="comment">// layout Voltas for current system</span></div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      <a class="code" href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">processLines</a>(system, voltas, <span class="keyword">false</span>);</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;      <span class="comment">// vertical align volta segments</span></div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> = 0; <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a> &lt; <a class="code" href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">nstaves</a>(); ++<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>) {</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;            std::vector&lt;SpannerSegment*&gt; voltaSegments;</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss : system-&gt;<a class="code" href="classMs_1_1System.html#a146014b5067b0027c6163b3d2e5d8b07">spannerSegments</a>()) {</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                  <span class="keywordflow">if</span> (ss-&gt;isVoltaSegment() &amp;&amp; ss-&gt;staffIdx() == <a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;                        voltaSegments.push_back(ss);</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                  }</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;            <span class="keywordflow">while</span> (!voltaSegments.empty()) {</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;                  <span class="comment">// we assume voltas are sorted left to right (by tick values)</span></div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;                  qreal y = 0;</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;                  <span class="keywordtype">int</span> idx = 0;</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;                  <a class="code" href="classMs_1_1Volta.html">Volta</a>* prevVolta = 0;</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss : voltaSegments) {</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;                        <a class="code" href="classMs_1_1Volta.html">Volta</a>* volta = toVolta(ss-&gt;spanner());</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                        <span class="keywordflow">if</span> (prevVolta &amp;&amp; prevVolta != volta) {</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                              <span class="comment">// check if volta is adjacent to prevVolta</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;                              <span class="keywordflow">if</span> (prevVolta-&gt;<a class="code" href="classMs_1_1Spanner.html#affc33cb9d3e419eb2c5a52ecb9e44736">tick2</a>() != volta-&gt;<a class="code" href="classMs_1_1Spanner.html#a825bfba09be9b0598940b854ba494312">tick</a>())</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                              }</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;                        y = qMin(y, ss-&gt;rypos());</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;                        ++idx;</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;                        prevVolta = volta;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;                        }</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; idx; ++i) {</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;                        <a class="code" href="classMs_1_1SpannerSegment.html">SpannerSegment</a>* ss = voltaSegments[i];</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;                        <span class="keywordflow">if</span> (ss-&gt;<a class="code" href="classMs_1_1Element.html#a36da6a07a74436d96c739f7134873eda">autoplace</a>() &amp;&amp; ss-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a4d0de3ac9401da46c32ed8becb9d496b">isStyled</a>(<a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9">Pid::OFFSET</a>))</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                              ss-&gt;<a class="code" href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">rypos</a>() = y;</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                        <span class="keywordflow">if</span> (ss-&gt;<a class="code" href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">addToSkyline</a>())</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                              system-&gt;<a class="code" href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">staff</a>(<a class="code" href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">staffIdx</a>)-&gt;<a class="code" href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">skyline</a>().<a class="code" href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">add</a>(ss-&gt;<a class="code" href="classMs_1_1Element.html#ad46a1fa8985b3d3897101b295a7a5d3e">shape</a>().<a class="code" href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">translated</a>(ss-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>()));</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                        }</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;                  voltaSegments.erase(voltaSegments.begin(), voltaSegments.begin() + idx);</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                  }</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;            }</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;      <span class="comment">// FretDiagram</span></div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;      <span class="keywordflow">if</span> (hasFretDiagram) {</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                        <span class="keywordflow">if</span> (e-&gt;isFretDiagram())</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;                              e-&gt;layout();</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                        }</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;                  }</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;            <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;            <span class="comment">// Harmony, 2nd place</span></div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;            <span class="comment">// We have FretDiagrams, we want the Harmony above this and</span></div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;            <span class="comment">// above the volta.</span></div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;            <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;            <a class="code" href="namespaceMs.html#a130aa9f1611e42fc06a6eaee6d78da2d">layoutHarmonies</a>(sl);</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;            <a class="code" href="namespaceMs.html#a39873f2b64993a8c6b6754e3a78a4bf1">alignHarmonies</a>(system, sl, <span class="keyword">false</span>, <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea9df5023b8ec3a00dc282eece7e144532">Sid::maxFretShiftAbove</a>), <a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea653c5686d0c5d0fa899597d72eebbd0d">Sid::maxFretShiftBelow</a>));</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;            }</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;      <span class="comment">// RehearsalMark</span></div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isRehearsalMark())</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;                  }</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            }</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      <span class="comment">// Image</span></div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;      <span class="comment">//-------------------------------------------------------------</span></div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classMs_1_1Segment.html">Segment</a>* s : sl) {</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* e : s-&gt;annotations()) {</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                  <span class="keywordflow">if</span> (e-&gt;isImage())</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;                        e-&gt;layout();</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;                  }</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;            }</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;      }</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="comment">//   collectPage</span></div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;</div><div class="line"><a name="l04628"></a><span class="lineno"><a class="line" href="structMs_1_1LayoutContext.html#a930ae8dc2a6af49471c7d2a8860d7411"> 4628</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structMs_1_1LayoutContext.html#a930ae8dc2a6af49471c7d2a8860d7411">LayoutContext::collectPage</a>()</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;      {</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      <span class="keyword">const</span> qreal slb = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea8840c6da2e66f5ee18c4b1aa2c354fd1">Sid::staffLowerBorder</a>);</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;      <span class="keywordtype">bool</span> breakPages = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a48d54ab45d94e4ef6a420f94d2612f18">layoutMode</a>() != <a class="code" href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bafa177138f94a7ea01f549b1aa7893d03">LayoutMode::SYSTEM</a>;</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      qreal ey        = page-&gt;height() - page-&gt;bm();</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      qreal y         = 0.0;</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <a class="code" href="classMs_1_1System.html">System</a>* nextSystem = 0;</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;      <span class="keywordtype">int</span> systemIdx = -1;</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;      <span class="comment">// re-calculate positions for systems before current</span></div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;      <span class="comment">// (they may have been filled on previous layout)</span></div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;      <span class="keywordtype">int</span> pSystems = page-&gt;systems().size();</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;      <span class="keywordflow">if</span> (pSystems &gt; 0) {</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;            page-&gt;system(0)-&gt;<a class="code" href="classMs_1_1System.html#a3b676ebb68b3b2389539204b0e92a6fc">restoreLayout2</a>();</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;            y = page-&gt;system(0)-&gt;y() + page-&gt;system(0)-&gt;height();</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;            }</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;             y = page-&gt;tm();</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;            }</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; pSystems; ++i) {</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* cs = page-&gt;system(i);</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* ps = page-&gt;system(i - 1);</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;            qreal <a class="code" href="namespaceMs.html#a9506eedd97d44c482010b77e53a72b18">distance</a> = ps-&gt;<a class="code" href="classMs_1_1System.html#a1ca675ae448b1850c924d042b3f39691">minDistance</a>(cs);</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;            y += <a class="code" href="namespaceMs.html#a9506eedd97d44c482010b77e53a72b18">distance</a>;</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            cs-&gt;<a class="code" href="classMs_1_1Element.html#a2a2ce2358cc23529d8f038a940062e62">setPos</a>(page-&gt;lm(), y);</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;            cs-&gt;<a class="code" href="classMs_1_1System.html#a3b676ebb68b3b2389539204b0e92a6fc">restoreLayout2</a>();</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;            y += cs-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>();</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;            }</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0;;++k) {</div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;            <span class="comment">// calculate distance to previous system</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;            qreal <a class="code" href="namespaceMs.html#a9506eedd97d44c482010b77e53a72b18">distance</a>;</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;            <span class="keywordflow">if</span> (prevSystem)</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;                  distance = prevSystem-&gt;minDistance(curSystem);</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;                  <span class="comment">// this is the first system on page</span></div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                  <span class="keywordflow">if</span> (curSystem-&gt;vbox())</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                        distance = 0.0;</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                        distance = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea82fd8fc6a45f49d26bf6dd221e4d27f1">Sid::staffUpperBorder</a>);</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;                        <span class="keywordtype">bool</span> fixedDistance = <span class="keyword">false</span>;</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                        <span class="comment">// TODO: curSystem-&gt;spacerDistance(true)</span></div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : curSystem-&gt;measures()) {</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;                              <span class="keywordflow">if</span> (mb-&gt;isMeasure()) {</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;                                    <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;                                    <a class="code" href="classMs_1_1Spacer.html">Spacer</a>* sp = m-&gt;<a class="code" href="classMs_1_1Measure.html#a22789a30661e49d958abc30c0dce71ee">vspacerUp</a>(0);       <span class="comment">// TODO: first visible?</span></div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                                    <span class="keywordflow">if</span> (sp) {</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;                                          <span class="keywordflow">if</span> (sp-&gt;<a class="code" href="classMs_1_1Spacer.html#a3ffe335bf95ba8e36cdc3c1dbb67ff36">spacerType</a>() == <a class="code" href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655ac6e6dc18b53b4c2681394b9d8aefcec7">SpacerType::FIXED</a>) {</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;                                                distance = sp-&gt;<a class="code" href="classMs_1_1Spacer.html#a78bf0f34478639535d9ef1a11b12d37c">gap</a>();</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                                                fixedDistance = <span class="keyword">true</span>;</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;                                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;                                                }</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;                                          <span class="keywordflow">else</span></div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;                                                distance = qMax(distance, sp-&gt;<a class="code" href="classMs_1_1Spacer.html#a78bf0f34478639535d9ef1a11b12d37c">gap</a>());</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;                                          }</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;<span class="comment">//TODO::ws                                    distance = qMax(distance, -m-&gt;staffShape(0).top());</span></div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;                                    }</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;                              }</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;                        <span class="keywordflow">if</span> (!fixedDistance)</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;                              distance = qMax(distance, curSystem-&gt;minTop());</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                        }</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                  }</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;<span class="comment">//TODO-ws ??</span></div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;<span class="comment">//          distance += score-&gt;staves().front()-&gt;userDist();</span></div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;            y += <a class="code" href="namespaceMs.html#a9506eedd97d44c482010b77e53a72b18">distance</a>;</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;            curSystem-&gt;setPos(page-&gt;lm(), y);</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;            curSystem-&gt;restoreLayout2();</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;            page-&gt;appendSystem(curSystem);</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;            y += curSystem-&gt;height();</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;            <span class="comment">//  check for page break or if next system will fit on page</span></div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;            <span class="keywordtype">bool</span> collected = <span class="keyword">false</span>;</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;            <span class="keywordflow">if</span> (rangeDone) {</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                  <span class="comment">// take next system unchanged</span></div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                  <span class="keywordflow">if</span> (systemIdx &gt; 0) {</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;                        nextSystem = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>().value(systemIdx++);</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                        <span class="keywordflow">if</span> (!nextSystem) {</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;                              <span class="comment">// TODO: handle next movement</span></div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                              }</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;                        }</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                  <span class="keywordflow">else</span> {</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;                        nextSystem = systemList.empty() ? 0 : systemList.takeFirst();</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;                        <span class="keywordflow">if</span> (nextSystem)</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;                              <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>().append(nextSystem);</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a8eddd82040d61bffb0d863d6f26270d6">isMaster</a>()) {</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                              <a class="code" href="classMs_1_1MasterScore.html">MasterScore</a>* ms = <span class="keyword">static_cast&lt;</span><a class="code" href="classMs_1_1MasterScore.html">MasterScore</a>*<span class="keyword">&gt;</span>(<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>)-&gt;next();</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;                              <span class="keywordflow">if</span> (ms) {</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;                                    <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>     = ms;</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;                                    systemIdx = 0;</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;                                    nextSystem = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>().value(systemIdx++);</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;                                    }</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;                              }</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;                        }</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;                  }</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;                  nextSystem = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a393fe76e521cb4f1be1d6ab526b64bdf">collectSystem</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;                  <span class="keywordflow">if</span> (nextSystem)</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;                        collected = <span class="keyword">true</span>;</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;                  <span class="keywordflow">if</span> (!nextSystem &amp;&amp; <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a8eddd82040d61bffb0d863d6f26270d6">isMaster</a>()) {</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;                        <a class="code" href="classMs_1_1MasterScore.html">MasterScore</a>* ms = <span class="keyword">static_cast&lt;</span><a class="code" href="classMs_1_1MasterScore.html">MasterScore</a>*<span class="keyword">&gt;</span>(<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>)-&gt;next();</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                        <span class="keywordflow">if</span> (ms) {</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;                              <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a> = ms;</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;                              QList&lt;System*&gt;&amp; <a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a> = ms-&gt;<a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>();</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;                              <span class="keywordflow">if</span> (systems.empty() || systems.front()-&gt;measures().empty()) {</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;                                    systemList         = <a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>;</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;                                    systems.clear();</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;                                    measureNo          = 0;</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;                                    startWithLongNames = <span class="keyword">true</span>;</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;                                    firstSystem        = <span class="keyword">true</span>;</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;                                    <a class="code" href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a>               = <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1);</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;                                    <a class="code" href="classMs_1_1Score.html#af4327a46d184dd4b515364038eb51f5f">prevMeasure</a>        = 0;</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;                                    curMeasure         = 0;</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;                                    <a class="code" href="classMs_1_1Score.html#a854e949646c089e0e195db4798642d1e">nextMeasure</a>        = ms-&gt;<a class="code" href="classMs_1_1Score.html#ab2347f55630666c0a3e699b6c91bbf80">measures</a>()-&gt;<a class="code" href="classMs_1_1MeasureBaseList.html#a55f35e1782bf231894ba35e6c595851e">first</a>();</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                                    ms-&gt;<a class="code" href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de">getNextMeasure</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                                    nextSystem         = ms-&gt;<a class="code" href="classMs_1_1Score.html#a393fe76e521cb4f1be1d6ab526b64bdf">collectSystem</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                                    ms-&gt;<a class="code" href="classMs_1_1Score.html#a8cce5e6de5f0a4b9a16aa1b3e6aef7b6">setScoreFont</a>(<a class="code" href="classMs_1_1ScoreFont.html#a3961745e9d8ad69188ec511dc7f9b21f">ScoreFont::fontFactory</a>(ms-&gt;<a class="code" href="classMs_1_1Score.html#a58cc5b8055aed00a47b0097718a6f560">styleSt</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea88e2a676fbe7a0e18f9c7de14d37ad35">Sid::MusicalSymbolFont</a>)));</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                                    ms-&gt;<a class="code" href="classMs_1_1Score.html#a35ebcb1cff57477d55fc1dc9bc8508c0">setNoteHeadWidth</a>(ms-&gt;<a class="code" href="classMs_1_1Score.html#a6b28dcc84bca9dab3f01ee993d301285">scoreFont</a>()-&gt;<a class="code" href="classMs_1_1ScoreFont.html#a76981900d57807ccce490f1f25dfa31e">width</a>(<a class="code" href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794aeab244836adffdeef9573f36a3baba75">SymId::noteheadBlack</a>, ms-&gt;<a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>() / <a class="code" href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">SPATIUM20</a>));</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;                                    }</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                              <span class="keywordflow">else</span> {</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;                                    rangeDone = <span class="keyword">true</span>;</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                                    systemIdx = 0;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;                                    nextSystem = <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>().value(systemIdx++);</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                                    }</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                              }</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                        }</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                  }</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;            prevSystem = curSystem;</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;            Q_ASSERT(curSystem != nextSystem);</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;            curSystem  = nextSystem;</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;            <span class="keywordtype">bool</span> breakPage = !curSystem || (breakPages &amp;&amp; prevSystem-&gt;pageBreak());</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;            <span class="keywordflow">if</span> (!breakPage) {</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                  qreal dist = prevSystem-&gt;<a class="code" href="classMs_1_1System.html#a1ca675ae448b1850c924d042b3f39691">minDistance</a>(curSystem) + curSystem-&gt;height();</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;                  <a class="code" href="classMs_1_1Box.html">Box</a>* vbox = curSystem-&gt;vbox();</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                  <span class="keywordflow">if</span> (vbox) {</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;                        dist += vbox-&gt;<a class="code" href="classMs_1_1Box.html#a61505cf85e9ba90249879d0392febf10">bottomGap</a>();</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;                        }</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!prevSystem-&gt;hasFixedDownDistance()) {</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;                        qreal margin = qMax(curSystem-&gt;minBottom(), curSystem-&gt;spacerDistance(<span class="keyword">false</span>));</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;                        dist += qMax(margin, slb);</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                        }</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;                  breakPage = (y + dist) &gt;= ey &amp;&amp; breakPages;</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                  }</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;            <span class="keywordflow">if</span> (breakPage) {</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                  qreal dist = qMax(prevSystem-&gt;minBottom(), prevSystem-&gt;spacerDistance(<span class="keyword">false</span>));</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;                  dist = qMax(dist, slb);</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;                  <a class="code" href="namespaceMs.html#aea8cb39fcc02e1ea400e11bbdd037198">layoutPage</a>(page, ey - (y + dist));</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                  <span class="comment">// if we collected a system we cannot fit onto this page,</span></div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;                  <span class="comment">// we need to collect next page in order to correctly set system positions</span></div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;                  <span class="keywordflow">if</span> (collected)</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;                        pageOldMeasure = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                  }</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;            }</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> stick = <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(-1,1);</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1System.html">System</a>* s : page-&gt;systems()) {</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;            <a class="code" href="classMs_1_1Score.html">Score</a>* currentScore = s-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>();</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb : s-&gt;measures()) {</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                  <span class="keywordflow">if</span> (!mb-&gt;isMeasure())</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                  <a class="code" href="classMs_1_1Measure.html">Measure</a>* m = toMeasure(mb);</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                  <span class="keywordflow">if</span> (stick == <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(-1,1))</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                        stick = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>();</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> track = 0; track &lt; currentScore-&gt;<a class="code" href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">ntracks</a>(); ++track) {</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Segment.html">Segment</a>* segment = m-&gt;<a class="code" href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">first</a>(); segment; segment = segment-&gt;<a class="code" href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">next</a>()) {</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                              <a class="code" href="classMs_1_1Element.html">Element</a>* e = segment-&gt;element(track);</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                              <span class="keywordflow">if</span> (!e)</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                              <span class="keywordflow">if</span> (e-&gt;<a class="code" href="classMs_1_1ScoreElement.html#accef1c91df491a43c54e70474deea60c">isChordRest</a>()) {</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                                    <span class="keywordflow">if</span> (!currentScore-&gt;<a class="code" href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">staff</a>(<a class="code" href="namespaceMs.html#ae665d4585b944f2ec91a33a5c89732bd">track2staff</a>(track))-&gt;<a class="code" href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">show</a>())</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;                                    <a class="code" href="classMs_1_1ChordRest.html">ChordRest</a>* cr = <a class="code" href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">toChordRest</a>(e);</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#a9210a20e1a75146ee5e3102a3bbb9320">notTopBeam</a>(cr))                 <span class="comment">// layout cross staff beams</span></div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                                          cr-&gt;<a class="code" href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">beam</a>()-&gt;<a class="code" href="classMs_1_1Beam.html#ac2c76daf5a9dc4c3cc0f366a394ab4d6">layout</a>();</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="namespaceMs.html#ad863eb4b91e6fcf0deef7c476cb10d43">notTopTuplet</a>(cr)) {</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                                          <span class="comment">// fix layout of tuplets</span></div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                                          <a class="code" href="classMs_1_1DurationElement.html">DurationElement</a>* de = cr;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                                          <span class="keywordflow">while</span> (de-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>() &amp;&amp; de-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>()-&gt;<a class="code" href="classMs_1_1Tuplet.html#a335f84666bd36e2bca5963785ae9759a">elements</a>().front() == de) {</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;                                                <a class="code" href="classMs_1_1Tuplet.html">Tuplet</a>* t = de-&gt;<a class="code" href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">tuplet</a>();</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                                                t-&gt;<a class="code" href="classMs_1_1Tuplet.html#a4926540c91f806d69f5b56be91301c7c">layout</a>();</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                                                de = t;</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                                                }</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                                          }</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                                    <span class="keywordflow">if</span> (cr-&gt;isChord()) {</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;                                          <a class="code" href="classMs_1_1Chord.html">Chord</a>* c = toChord(cr);</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;                                          <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Chord.html">Chord</a>* cc : c-&gt;<a class="code" href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">graceNotes</a>()) {</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                                                <span class="keywordflow">if</span> (cc-&gt;beam() &amp;&amp; cc-&gt;beam()-&gt;elements().front() == cc)</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;                                                      cc-&gt;beam()-&gt;layout();</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;                                                cc-&gt;layoutSpanners();</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;                                                <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Element.html">Element</a>* element : cc-&gt;el()) {</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                                                      <span class="keywordflow">if</span> (element-&gt;isSlur())</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;                                                            element-&gt;layout();</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;                                                      }</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;                                                }</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;                                          c-&gt;<a class="code" href="classMs_1_1Chord.html#a83b52654e7177b6ab649f8da843f28a5">layoutArpeggio2</a>();</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;                                          c-&gt;<a class="code" href="classMs_1_1Chord.html#a4d110ef401e1ecf0338442919917224d">layoutSpanners</a>();</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;                                          <span class="keywordflow">if</span> (c-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>()) {</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                                                <a class="code" href="classMs_1_1Tremolo.html">Tremolo</a>* t = c-&gt;<a class="code" href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">tremolo</a>();</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;                                                <a class="code" href="classMs_1_1Chord.html">Chord</a>* c1 = t-&gt;<a class="code" href="classMs_1_1Tremolo.html#af3fbc117c926f4bc9bd5f0ee3e8ad478">chord1</a>();</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;                                                <a class="code" href="classMs_1_1Chord.html">Chord</a>* c2 = t-&gt;<a class="code" href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">chord2</a>();</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;                                                <span class="keywordflow">if</span> (t-&gt;<a class="code" href="classMs_1_1Tremolo.html#a7e98943cb86fb69bc5e59024f3d880fd">twoNotes</a>() &amp;&amp; c1 &amp;&amp; c2 &amp;&amp; (c1-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>() || c2-&gt;<a class="code" href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">staffMove</a>()))</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;                                                      t-&gt;<a class="code" href="classMs_1_1Tremolo.html#adb0e0d60086c88bf8f663bd36c49bbd6">layout</a>();</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;                                                }</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;                                          }</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;                                    }</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;                              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;isBarLine())</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;                                    toBarLine(e)-&gt;layout2();</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;                              }</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                        }</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;                  m-&gt;<a class="code" href="classMs_1_1Measure.html#aedba86af30a033adef26958d92990e67">layout2</a>();</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;                  }</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;            }</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#aaa1757bb614c6949e784e159264949e0">systemMode</a>()) {</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* s = page-&gt;systems().last();</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;            qreal height = s ? s-&gt;<a class="code" href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">pos</a>().y() + s-&gt;<a class="code" href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">height</a>() + s-&gt;<a class="code" href="classMs_1_1System.html#aad9535273017c27595ea5aeb0b3baf38">minBottom</a>() : page-&gt;tm();</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;            page-&gt;bbox().setRect(0.0, 0.0, <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#afd4b28e5752dc085c8e0e4203631a1c0">loWidth</a>(), height + page-&gt;bm());</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;            }</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;      page-&gt;rebuildBspTree();</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      }</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="comment">//   doLayout</span></div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="comment">//    do a complete (re-) layout</span></div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;</div><div class="line"><a name="l04865"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a50e6e934be473faa8cc345e9d66b1a7a"> 4865</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a50e6e934be473faa8cc345e9d66b1a7a">Score::doLayout</a>()</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      {</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;      <a class="code" href="classMs_1_1Score.html#a5b7778fe0022d74f748a9150342fe598">doLayoutRange</a>(<a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1), <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(-1,1));</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;      }</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;<span class="comment">//   CmdStateLocker</span></div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;</div><div class="line"><a name="l04874"></a><span class="lineno"><a class="line" href="classMs_1_1CmdStateLocker.html"> 4874</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMs_1_1CmdStateLocker.html">CmdStateLocker</a> {</div><div class="line"><a name="l04875"></a><span class="lineno"><a class="line" href="classMs_1_1CmdStateLocker.html#ac8c472a03b779a7f26984fa582781103"> 4875</a></span>&#160;      <a class="code" href="classMs_1_1Score.html">Score</a>* <a class="code" href="classMs_1_1CmdStateLocker.html#ac8c472a03b779a7f26984fa582781103">score</a>;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l04877"></a><span class="lineno"><a class="line" href="classMs_1_1CmdStateLocker.html#a3d66544b71eabf57e874e2d83fc0197d"> 4877</a></span>&#160;      <a class="code" href="classMs_1_1CmdStateLocker.html#a3d66544b71eabf57e874e2d83fc0197d">CmdStateLocker</a>(<a class="code" href="classMs_1_1Score.html">Score</a>* s) : score(s) { score-&gt;<a class="code" href="classMs_1_1Score.html#a07fa204a412636070028f2b159771574">cmdState</a>().<a class="code" href="classMs_1_1CmdState.html#ad10dd069bac6b880ea5f66d8c5dfb62e">lock</a>(); }</div><div class="line"><a name="l04878"></a><span class="lineno"><a class="line" href="classMs_1_1CmdStateLocker.html#a0e3f9c15a4145645b443959f273715c5"> 4878</a></span>&#160;      <a class="code" href="classMs_1_1CmdStateLocker.html#a0e3f9c15a4145645b443959f273715c5">~CmdStateLocker</a>() { score-&gt;<a class="code" href="classMs_1_1Score.html#a07fa204a412636070028f2b159771574">cmdState</a>().<a class="code" href="classMs_1_1CmdState.html#afedeca0fc328649e13f18d948e0fabb2">unlock</a>(); }</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;      };</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;<span class="comment">//   doLayoutRange</span></div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;</div><div class="line"><a name="l04885"></a><span class="lineno"><a class="line" href="classMs_1_1Score.html#a5b7778fe0022d74f748a9150342fe598"> 4885</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1Score.html#a5b7778fe0022d74f748a9150342fe598">Score::doLayoutRange</a>(<span class="keyword">const</span> <a class="code" href="classMs_1_1Fraction.html">Fraction</a>&amp; st, <span class="keyword">const</span> <a class="code" href="classMs_1_1Fraction.html">Fraction</a>&amp; et)</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;      {</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;      <a class="code" href="classMs_1_1CmdStateLocker.html">CmdStateLocker</a> cmdStateLocker(<span class="keyword">this</span>);</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;      <a class="code" href="structMs_1_1LayoutContext.html">LayoutContext</a> lc(<span class="keyword">this</span>);</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> stick(st);</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;      <a class="code" href="classMs_1_1Fraction.html">Fraction</a> etick(et);</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;      Q_ASSERT(!(stick == <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(-1,1) &amp;&amp; etick == <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(-1,1)));</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classMs_1_1Score.html#a9a782ad57ba6f6f813a9caff2992df92">last</a>() || (<a class="code" href="classMs_1_1Score.html#a7e623a06766698ff471836eac2f3fa57">lineMode</a>() &amp;&amp; !<a class="code" href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">firstMeasure</a>())) {</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;            qDebug(<span class="stringliteral">&quot;empty score&quot;</span>);</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;            qDeleteAll(<a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>);</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;            <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.clear();</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;            qDeleteAll(<a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>());</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;            <a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>().clear();</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#ac53ba577f2fb5d2c0884a0d02c628a48">getNextPage</a>();</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;            }</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;<span class="comment">//      if (!_systems.isEmpty())</span></div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<span class="comment">//            return;</span></div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      <span class="keywordtype">bool</span> layoutAll = stick &lt;= Fraction(0,1) &amp;&amp; (etick &lt; Fraction(0,1) || etick &gt;= <a class="code" href="classMs_1_1Score.html#aac5cfbf34cbd22da196fd31944a260da">masterScore</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a9a782ad57ba6f6f813a9caff2992df92">last</a>()-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>());</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="keywordflow">if</span> (stick &lt; <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1))</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;            stick = <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1);</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      <span class="keywordflow">if</span> (etick &lt; <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1))</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;            etick = <a class="code" href="classMs_1_1Score.html#a9a782ad57ba6f6f813a9caff2992df92">last</a>()-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">endTick</a>();</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">endTick</a>     = etick;</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;      <a class="code" href="classMs_1_1Score.html#ac325e3d1dc5f2586dffaa79ef0f6950b">_scoreFont</a>     = <a class="code" href="classMs_1_1ScoreFont.html#a3961745e9d8ad69188ec511dc7f9b21f">ScoreFont::fontFactory</a>(<a class="code" href="classMs_1_1Score.html#a69bb5a25e3e1c714788540ce57f92a71">style</a>().value(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea88e2a676fbe7a0e18f9c7de14d37ad35">Sid::MusicalSymbolFont</a>).<a class="code" href="namespaceMs.html#a1f1eab3fe8ae544f6c20be2d2a39582a">toString</a>());</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;      <a class="code" href="classMs_1_1Score.html#a68245eebd2b78df8fce9ce35c05d98e1">_noteHeadWidth</a> = <a class="code" href="classMs_1_1Score.html#ac325e3d1dc5f2586dffaa79ef0f6950b">_scoreFont</a>-&gt;<a class="code" href="classMs_1_1ScoreFont.html#a76981900d57807ccce490f1f25dfa31e">width</a>(<a class="code" href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794aeab244836adffdeef9573f36a3baba75">SymId::noteheadBlack</a>, <a class="code" href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">spatium</a>() / <a class="code" href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">SPATIUM20</a>);</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a07fa204a412636070028f2b159771574">cmdState</a>().layoutFlags &amp; <a class="code" href="namespaceMs.html#ae95dea350de4a3014dbcbcfe9a6a75dcaf83dad84a4844ef191d4fccb09bb9a02">LayoutFlag::REBUILD_MIDI_MAPPING</a>) {</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a8eddd82040d61bffb0d863d6f26270d6">isMaster</a>())</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                  <a class="code" href="classMs_1_1Score.html#aac5cfbf34cbd22da196fd31944a260da">masterScore</a>()-&gt;<a class="code" href="classMs_1_1MasterScore.html#af8411000a9edcc95127359d6858ca24b">rebuildMidiMapping</a>();</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;            }</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a07fa204a412636070028f2b159771574">cmdState</a>().layoutFlags &amp; <a class="code" href="namespaceMs.html#ae95dea350de4a3014dbcbcfe9a6a75dcafe617927f45d26bbaf17fc0e288066f8">LayoutFlag::FIX_PITCH_VELO</a>)</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;            <a class="code" href="classMs_1_1Score.html#a282d4f8bfc6261d114cb945980f2a78e">updateVelo</a>();</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="preprocessor">#if 0 // TODO: needed? It was introduced in ab9774ec4098512068b8ef708167d9aa6e702c50</span></div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a07fa204a412636070028f2b159771574">cmdState</a>().layoutFlags &amp; <a class="code" href="namespaceMs.html#ae95dea350de4a3014dbcbcfe9a6a75dcaf6adb53735dfab8f94c96875ce053396">LayoutFlag::PLAY_EVENTS</a>)</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;            <a class="code" href="classMs_1_1Score.html#a238e845d7b6a1e04230d35934cd00a74">createPlayEvents</a>();</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;      <span class="comment">//    initialize layout context lc</span></div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;      <span class="comment">//---------------------------------------------------</span></div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;      <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* m = <a class="code" href="classMs_1_1Score.html#a2a4668572b1873f13d9ebb34c87d872b">tick2measure</a>(stick);</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;      <span class="keywordflow">if</span> (m == 0)</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;            m = <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a>();</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;      <span class="comment">// start layout one measure earlier to handle clefs and cautionary elements</span></div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#aea0559270e2119a753eb51f4b031098e">prevMeasureMM</a>())</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;            m = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#aea0559270e2119a753eb51f4b031098e">prevMeasureMM</a>();</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">prev</a>())</div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;            m = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">prev</a>();</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;      <span class="keywordflow">while</span> (!m-&gt;isMeasure() &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">prev</a>())</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;            m = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">prev</a>();</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;      <span class="comment">// if the first measure of the score is part of a multi measure rest</span></div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;      <span class="comment">// m-&gt;system() will return a nullptr. We need to find the multi measure</span></div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;      <span class="comment">// rest which replaces the measure range</span></div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;      <span class="keywordflow">if</span> (!m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a0e9a0473e5ed4cc38a1dead12bf4c2f3">system</a>() &amp;&amp; m-&gt;isMeasure() &amp;&amp; toMeasure(m)-&gt;hasMMRest()) {</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;            qDebug(<span class="stringliteral">&quot;  don’t start with mmrest&quot;</span>);</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;            m = toMeasure(m)-&gt;mmRest();</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;            }</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;<span class="comment">//      qDebug(&quot;start &lt;%s&gt; tick %d, system %p&quot;, m-&gt;name(), m-&gt;tick(), m-&gt;system());</span></div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1Score.html#a7e623a06766698ff471836eac2f3fa57">lineMode</a>()) {</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> = 0;</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = m;     <span class="comment">//_showVBox ? first() : firstMeasure();</span></div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a19322e850e35356fc301b735ed3900c8">startTick</a>   = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>();</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;            <a class="code" href="classMs_1_1Score.html#ad11a10ab9b39230445e7faefa8270208">layoutLinear</a>(layoutAll, lc);</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;            }</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      <span class="keywordflow">if</span> (!layoutAll &amp;&amp; m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a0e9a0473e5ed4cc38a1dead12bf4c2f3">system</a>()) {</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;            <a class="code" href="classMs_1_1System.html">System</a>* system  = m-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a0e9a0473e5ed4cc38a1dead12bf4c2f3">system</a>();</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;            <span class="keywordtype">int</span> systemIndex = <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.indexOf(system);</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a23a16ac12220dcac28a0d4fbf0f03e8b">page</a>         = system-&gt;<a class="code" href="classMs_1_1System.html#a57af65dafb20c1282ea78ba3d74725a0">page</a>();</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a2beb5c0e7b78ee4366089341237b7b61">curPage</a>      = <a class="code" href="classMs_1_1Score.html#a89471772ad4e890e3e4f38f2c67e6318">pageIdx</a>(lc.<a class="code" href="structMs_1_1LayoutContext.html#a23a16ac12220dcac28a0d4fbf0f03e8b">page</a>);</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;            <span class="keywordflow">if</span> (lc.<a class="code" href="structMs_1_1LayoutContext.html#a2beb5c0e7b78ee4366089341237b7b61">curPage</a> == -1)</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a2beb5c0e7b78ee4366089341237b7b61">curPage</a> = 0;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a5fb0640e02f8bfd3f1a383e7a4052250">curSystem</a>   = system;</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#add8b93fda5fa1fedd7e5e29759ce6d97">systemList</a>  = <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.mid(systemIndex);</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;            <span class="keywordflow">if</span> (systemIndex == 0)</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ? <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a>() : <a class="code" href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">firstMeasure</a>();</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;                  <a class="code" href="classMs_1_1System.html">System</a>* prevSystem = <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>[systemIndex-1];</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = prevSystem-&gt;<a class="code" href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">measures</a>().back()-&gt;next();</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;                  }</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;            <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.erase(<a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.begin() + systemIndex, <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.end());</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;            <span class="keywordflow">if</span> (!lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>()) {</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">measureNo</a> = 0;</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">tick</a>      = <a class="code" href="classMs_1_1Fraction.html">Fraction</a>(0,1);</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                  }</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb = lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">prev</a>();</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;                  <span class="keywordflow">if</span> (mb)</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                        mb-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a7990eccc3ffa4f1e133b730e2bcba46b">findPotentialSectionBreak</a>();</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                  <a class="code" href="classMs_1_1LayoutBreak.html">LayoutBreak</a>* sectionBreak = mb-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">sectionBreakElement</a>();</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;                  <span class="comment">// TODO: also use mb in else clause here?</span></div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;                  <span class="comment">// probably not, only actual measures have meaningful numbers</span></div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                  <span class="keywordflow">if</span> (sectionBreak &amp;&amp; sectionBreak-&gt;<a class="code" href="classMs_1_1LayoutBreak.html#a160b67956d9b958c49cfd08b81b55868">startWithMeasureOne</a>())</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">measureNo</a> = 0;</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;                        lc.<a class="code" href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">measureNo</a> = lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>()-&gt;<a class="code" href="classMs_1_1MeasureBase.html#ab0624346b77edaab4269b9eb2523a225">no</a>()                     <span class="comment">// will be adjusted later with respect</span></div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;                                       + (lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">prevMeasure</a>()-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a01e69b6f8d32b6eb8f28bdf9ed370f56">irregular</a>() ? 0 : 1); <span class="comment">// to the user-defined offset.</span></div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                  lc.<a class="code" href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">tick</a>      = lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a>-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">tick</a>();</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;                  }</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;            }</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;<span class="comment">//  qDebug(&quot;layoutAll, systems %p %d&quot;, &amp;_systems, int(_systems.size()));</span></div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;            <span class="comment">//lc.measureNo   = 0;</span></div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;            <span class="comment">//lc.tick        = 0;</span></div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;            <span class="comment">// qDeleteAll(_systems);</span></div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;            <span class="comment">// _systems.clear();</span></div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;                  <span class="comment">// lc.systemList  = _systems;</span></div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;                  <span class="comment">// _systems.clear();</span></div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1System.html">System</a>* s : qAsConst(<a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>)) {</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Bracket.html">Bracket</a>* b : s-&gt;brackets()) {</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;                        <span class="keywordflow">if</span> (b-&gt;selected()) {</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;                              <a class="code" href="classMs_1_1Score.html#a5744ecf49cbfa1095aa28c9041b18f47">_selection</a>.<a class="code" href="classMs_1_1Selection.html#a4e5346c014b21425ba2ef41c0274930b">remove</a>(b);</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;                              <a class="code" href="classMs_1_1Score.html#ac7157fd475a0865b1b319270eff75571">setSelectionChanged</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;                              }</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;                        }</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;<span class="comment">//                  for (SpannerSegment* ss : s-&gt;spannerSegments())</span></div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;<span class="comment">//                        ss-&gt;setParent(0);</span></div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;                  s-&gt;setParent(<span class="keyword">nullptr</span>);</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;                  }</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* mb = <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a>(); mb; mb = mb-&gt;<a class="code" href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">next</a>()) {</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;                  mb-&gt;setSystem(0);</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;                  <span class="keywordflow">if</span> (mb-&gt;isMeasure() &amp;&amp; toMeasure(mb)-&gt;mmRest())</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;                        toMeasure(mb)-&gt;mmRest()-&gt;setSystem(0);</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;                  }</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;            qDeleteAll(<a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>);</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;            <a class="code" href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">_systems</a>.clear();</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;            qDeleteAll(<a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>());</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;            <a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>().clear();</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;            lc.<a class="code" href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">nextMeasure</a> = <a class="code" href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">_showVBox</a> ? <a class="code" href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">first</a>() : <a class="code" href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">firstMeasure</a>();</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;            }</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">prevMeasure</a> = 0;</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;      <a class="code" href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de">getNextMeasure</a>(lc);</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#a5fb0640e02f8bfd3f1a383e7a4052250">curSystem</a> = <a class="code" href="classMs_1_1Score.html#a393fe76e521cb4f1be1d6ab526b64bdf">collectSystem</a>(lc);</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      lc.<a class="code" href="structMs_1_1LayoutContext.html#a8343c23d70b61fe4572e2adef6330667">layout</a>();</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      }</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;<span class="comment">//   layout</span></div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;</div><div class="line"><a name="l05042"></a><span class="lineno"><a class="line" href="structMs_1_1LayoutContext.html#a8343c23d70b61fe4572e2adef6330667"> 5042</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structMs_1_1LayoutContext.html#a8343c23d70b61fe4572e2adef6330667">LayoutContext::layout</a>()</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      {</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;      <a class="code" href="classMs_1_1MeasureBase.html">MeasureBase</a>* lmb;</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;      <span class="keywordflow">do</span> {</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            getNextPage();</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;            collectPage();</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;            <span class="keywordflow">if</span> (page &amp;&amp; !page-&gt;systems().isEmpty())</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                  lmb = page-&gt;systems().back()-&gt;measures().back();</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;                  lmb = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;            <span class="comment">// we can stop collecting pages when:</span></div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;            <span class="comment">// 1) we reach the end of score (curSystem is nullptr)</span></div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;            <span class="comment">// or</span></div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;            <span class="comment">// 2) we have fully processed the range and reached a point of stability:</span></div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;            <span class="comment">//    a) we have completed layout for the range (rangeDone is true)</span></div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;            <span class="comment">//    b) we haven&#39;t collected a system that will need to go on the next page</span></div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;            <span class="comment">//    c) this page ends with the same measure as the previous layout</span></div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;            <span class="comment">//    pageOldMeasure will be last measure from previous layout if range was completed on or before this page</span></div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;            <span class="comment">//    it will be nullptr if this page was never laid out or if we collected a system for next page</span></div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;            } <span class="keywordflow">while</span> (curSystem &amp;&amp; !(rangeDone &amp;&amp; lmb == pageOldMeasure));</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;            <span class="comment">// &amp;&amp; page-&gt;system(0)-&gt;measures().back()-&gt;tick() &gt; endTick // FIXME: perhaps the first measure was meant? Or last system?</span></div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;      <span class="keywordflow">if</span> (!curSystem) {</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;            <span class="comment">// The end of the score. The remaining systems are not needed...</span></div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;            qDeleteAll(systemList);</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;            systemList.clear();</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;            <span class="comment">// ...and the remaining pages too</span></div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a291718ca12053bd8e663a8fcd756bd6b">npages</a>() &gt; curPage)</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;                  <span class="keyword">delete</span> <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">pages</a>().takeLast();</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;            }</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;            <a class="code" href="classMs_1_1Page.html">Page</a>* p = curSystem-&gt;page();</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;            <span class="keywordflow">if</span> (p &amp;&amp; (p != page))</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;                  p-&gt;<a class="code" href="classMs_1_1Page.html#adb26ac04b2bb7c6d3c1d7f61d361daa1">rebuildBspTree</a>();</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;            }</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;      <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">systems</a>().append(systemList);     <span class="comment">// TODO</span></div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;      }</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;<span class="comment">//   LayoutContext::LayoutContext</span></div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;</div><div class="line"><a name="l05086"></a><span class="lineno"><a class="line" href="structMs_1_1LayoutContext.html#a2d24aa5a3e7f51fc53311c360e19bd19"> 5086</a></span>&#160;<a class="code" href="structMs_1_1LayoutContext.html#a2d24aa5a3e7f51fc53311c360e19bd19">LayoutContext::LayoutContext</a>(<a class="code" href="classMs_1_1Score.html">Score</a>* s)</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;      : <a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>(s)</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;      {</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;      <a class="code" href="structMs_1_1LayoutContext.html#a4ce269915101a420df2d17c7082ec9d8">firstSystemIndent</a> = <a class="code" href="structMs_1_1LayoutContext.html#ae22472cdd1ee2864eb9e971e7950ae16">score</a> &amp;&amp; <a class="code" href="structMs_1_1LayoutContext.html#ae22472cdd1ee2864eb9e971e7950ae16">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">styleB</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea322eea03da4654d479967cb87170853d">Sid::enableIndentationOnFirstSystem</a>);</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;      }</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;<span class="comment">//   LayoutContext::~LayoutContext</span></div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;</div><div class="line"><a name="l05096"></a><span class="lineno"><a class="line" href="structMs_1_1LayoutContext.html#a5983fb61fbf461b8496f10c1bf766076"> 5096</a></span>&#160;<a class="code" href="structMs_1_1LayoutContext.html#a5983fb61fbf461b8496f10c1bf766076">LayoutContext::~LayoutContext</a>()</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      {</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1Spanner.html">Spanner</a>* s : <a class="code" href="structMs_1_1LayoutContext.html#acd8aacbbce632709b24bc9554ffe976a">processedSpanners</a>)</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;            s-&gt;layoutSystemsDone();</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1MuseScoreView.html">MuseScoreView</a>* v : <a class="code" href="structMs_1_1LayoutContext.html#ae22472cdd1ee2864eb9e971e7950ae16">score</a>-&gt;<a class="code" href="classMs_1_1Score.html#aab97c3e32db9ffed7379a1f71716cd59">getViewer</a>())</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;            v-&gt;layoutChanged();</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;      }</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;<span class="comment">//   VerticalStretchData</span></div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;</div><div class="line"><a name="l05109"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a84e88d404c58dce3fe624b35a2f9b3ce"> 5109</a></span>&#160;<a class="code" href="classMs_1_1VerticalGapData.html#a84e88d404c58dce3fe624b35a2f9b3ce">VerticalGapData::VerticalGapData</a>(<span class="keywordtype">bool</span> first, <a class="code" href="classMs_1_1System.html">System</a> *sys, <a class="code" href="classMs_1_1Staff.html">Staff</a> *st, <a class="code" href="classMs_1_1SysStaff.html">SysStaff</a> *sst, <span class="keyword">const</span> <a class="code" href="classMs_1_1Spacer.html">Spacer</a>* spacer, qreal y)</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;      : _fixedHeight(first), system(sys), sysStaff(sst), staff(st)</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      {</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a>) {</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;            <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea82fd8fc6a45f49d26bf6dd221e4d27f1">Sid::staffUpperBorder</a>);</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;            <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a>;</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;            }</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;            <span class="keywordflow">if</span> (spacer) {</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                  <a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                  <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> = spacer-&gt;<a class="code" href="classMs_1_1Spacer.html#a78bf0f34478639535d9ef1a11b12d37c">gap</a>();</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;                  <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a>;</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;                  }</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                  <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">y</a>() + (<a class="code" href="classMs_1_1VerticalGapData.html#af4bf38122d09df51e5ca36694c6aeeb5">sysStaff</a> ? <a class="code" href="classMs_1_1VerticalGapData.html#af4bf38122d09df51e5ca36694c6aeeb5">sysStaff</a>-&gt;<a class="code" href="classMs_1_1SysStaff.html#aee9868a0f2bc566af571f4fd377d6741">y</a>() : 0.0) - y;</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;                  <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea7ea1b7b4c06c2be22b149d20656ab584">Sid::maxStaffSpread</a>);</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;                  }</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;            }</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;      }</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;<span class="comment">//   updateFactor</span></div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div><div class="line"><a name="l05133"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a62c727cafda7869be00be9821f2d7045"> 5133</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#a62c727cafda7869be00be9821f2d7045">VerticalGapData::updateFactor</a>(qreal <a class="code" href="classMs_1_1VerticalGapData.html#a580438281cd8680a99047ceb42e5b15f">factor</a>)</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;      {</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a>)</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;      qreal f = qMax(factor, <a class="code" href="classMs_1_1VerticalGapData.html#a9cdd100c2ccfdab5d60251bc99e72f09">_factor</a>);</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> *= <a class="code" href="classMs_1_1VerticalGapData.html#a9cdd100c2ccfdab5d60251bc99e72f09">_factor</a> / f;</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a9cdd100c2ccfdab5d60251bc99e72f09">_factor</a> = f;</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      }</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;<span class="comment">//   addSpaceBetweenSections</span></div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;</div><div class="line"><a name="l05146"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a7a6a0cffa1ec2e82a7ae63937688e97f"> 5146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#a7a6a0cffa1ec2e82a7ae63937688e97f">VerticalGapData::addSpaceBetweenSections</a>()</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      {</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a62c727cafda7869be00be9821f2d7045">updateFactor</a>(<a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eacb21bc44055692398df9983b7bc3ac64">Sid::spreadSystem</a>));</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a>)</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;            <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> = qMax(<a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a>, <a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea45c529cd6bc7ad4c83459ff564827d1b">Sid::maxSystemSpread</a>));</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;      }</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;<span class="comment">//   addSpaceAroundVBox</span></div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;</div><div class="line"><a name="l05157"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a429b1f1b6240aec75c46b7aab08c8b1f"> 5157</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#a429b1f1b6240aec75c46b7aab08c8b1f">VerticalGapData::addSpaceAroundVBox</a>(<span class="keywordtype">bool</span> above)</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;      {</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a9cdd100c2ccfdab5d60251bc99e72f09">_factor</a> = 1.0;</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;      <span class="keyword">const</span> <a class="code" href="classMs_1_1Score.html">Score</a>* score { <a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>() };</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> = above ? score-&gt;styleP(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea73f11722d4ae05ede496ac5ba18a5fa8">Sid::frameSystemDistance</a>) : score-&gt;styleP(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea9b35e5c268673498b969e7a02828c388">Sid::systemFrameDistance</a>);</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a>;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;      }</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;<span class="comment">//   addSpaceAroundNormalBracket</span></div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;</div><div class="line"><a name="l05170"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a7dd8ea76bec4d8ff3103b7bd9b441596"> 5170</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#a7dd8ea76bec4d8ff3103b7bd9b441596">VerticalGapData::addSpaceAroundNormalBracket</a>()</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;      {</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a62c727cafda7869be00be9821f2d7045">updateFactor</a>(<a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea7c4235db39ed54025b0557b483c3ae41">Sid::spreadSquareBracket</a>));</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;      }</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;<span class="comment">//   addSpaceAroundCurlyBracket</span></div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;</div><div class="line"><a name="l05179"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a2504e5f861dd1f31323c9da26a3234c8"> 5179</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#a2504e5f861dd1f31323c9da26a3234c8">VerticalGapData::addSpaceAroundCurlyBracket</a>()</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;      {</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a62c727cafda7869be00be9821f2d7045">updateFactor</a>(<a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">styleD</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea3ae74bfbfbf3806a04ffe3999ed4a9dc">Sid::spreadCurlyBracket</a>));</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;      }</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;<span class="comment">//   insideCurlyBracket</span></div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;</div><div class="line"><a name="l05188"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#aa4067fe8548ee70fb5f9a8e09bdd8c7f"> 5188</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#aa4067fe8548ee70fb5f9a8e09bdd8c7f">VerticalGapData::insideCurlyBracket</a>()</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;      {</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">system</a>-&gt;<a class="code" href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">score</a>()-&gt;<a class="code" href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">styleP</a>(<a class="code" href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eae236b885a4014354180ec82383499db5">Sid::maxAkkoladeDistance</a>);</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      }</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;<span class="comment">//   factor</span></div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;</div><div class="line"><a name="l05197"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a580438281cd8680a99047ceb42e5b15f"> 5197</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapData.html#a580438281cd8680a99047ceb42e5b15f">VerticalGapData::factor</a>()<span class="keyword"> const</span></div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classMs_1_1VerticalGapData.html#a9cdd100c2ccfdab5d60251bc99e72f09">_factor</a>;</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;      }</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;<span class="comment">//   spacing</span></div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;<span class="comment">//    return normalised spacing</span></div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;</div><div class="line"><a name="l05207"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a7f1aac07a7684cca8723ee1ccc5b7788"> 5207</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapData.html#a7f1aac07a7684cca8723ee1ccc5b7788">VerticalGapData::spacing</a>()<span class="keyword"> const</span></div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> + <a class="code" href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">_addedNormalisedSpace</a>;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;      }</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;<span class="comment">//   addedSpace</span></div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;</div><div class="line"><a name="l05216"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a3ae65ea04ec39f647d9b7839afc4f186"> 5216</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapData.html#a3ae65ea04ec39f647d9b7839afc4f186">VerticalGapData::actualAddedSpace</a>()<span class="keyword"> const</span></div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">_addedNormalisedSpace</a> * <a class="code" href="classMs_1_1VerticalGapData.html#a580438281cd8680a99047ceb42e5b15f">factor</a>();</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;      }</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;<span class="comment">//   addSpacing</span></div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;</div><div class="line"><a name="l05225"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a9aae800cd73b0dff71aa6f690f77d7fc"> 5225</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapData.html#a9aae800cd73b0dff71aa6f690f77d7fc">VerticalGapData::addSpacing</a>(qreal step)</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;      {</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a>)</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;            <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> &gt;= <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a>)) {</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;            <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> = <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a>;</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;            step = 0.0;</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;            }</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;            qreal newSpacing { <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> + <a class="code" href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">_addedNormalisedSpace</a> + step };</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;            <span class="keywordflow">if</span> ((newSpacing &gt;= <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a>))</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                  step = <a class="code" href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">_maxActualSpacing</a> - <a class="code" href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">_normalisedSpacing</a> - <a class="code" href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">_addedNormalisedSpace</a>;</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;            }</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">_addedNormalisedSpace</a> += step;</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#aad8a6efba52e9f25f3abf75e37483179">_lastStep</a> = step;</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      <span class="keywordflow">return</span> step;</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;      }</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;<span class="comment">//   isFixedHeight</span></div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;</div><div class="line"><a name="l05247"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a3d4e16cf0a0fcc9351b006fdb05d00c9"> 5247</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classMs_1_1VerticalGapData.html#a3d4e16cf0a0fcc9351b006fdb05d00c9">VerticalGapData::isFixedHeight</a>()<span class="keyword"> const</span></div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">_fixedHeight</a>;</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;      }</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;<span class="comment">//   undoLastAddSpacing</span></div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;</div><div class="line"><a name="l05256"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#a68ed1b2711a5a05a1b61b9e42ed93d5b"> 5256</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapData.html#a68ed1b2711a5a05a1b61b9e42ed93d5b">VerticalGapData::undoLastAddSpacing</a>()</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;      {</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">_addedNormalisedSpace</a> -= <a class="code" href="classMs_1_1VerticalGapData.html#aad8a6efba52e9f25f3abf75e37483179">_lastStep</a>;</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#aad8a6efba52e9f25f3abf75e37483179">_lastStep</a> = 0.0;</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;      }</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;<span class="comment">//   addFillSpacing</span></div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;</div><div class="line"><a name="l05266"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapData.html#afe37fe95797d678dcc2fe87714970c70"> 5266</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapData.html#afe37fe95797d678dcc2fe87714970c70">VerticalGapData::addFillSpacing</a>(qreal step, qreal maxFill)</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      {</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      qreal res = <a class="code" href="classMs_1_1VerticalGapData.html#a9aae800cd73b0dff71aa6f690f77d7fc">addSpacing</a>(qMin(maxFill - <a class="code" href="classMs_1_1VerticalGapData.html#a34eca280f3a27e065d2431f12422e867">_fillSpacing</a>, step));</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html#a34eca280f3a27e065d2431f12422e867">_fillSpacing</a> += res;</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      }</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;<span class="comment">//   deleteAll</span></div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;</div><div class="line"><a name="l05277"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapDataList.html#a57072e581d267b61bc0bfa81c2864473"> 5277</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classMs_1_1VerticalGapDataList.html#a57072e581d267b61bc0bfa81c2864473">VerticalGapDataList::deleteAll</a>()</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;      {</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> vsd : *<span class="keyword">this</span>)</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;            <span class="keyword">delete</span> vsd;</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;      }</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="comment">//   sumStretchFactor</span></div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;</div><div class="line"><a name="l05287"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapDataList.html#ad0221acb745b4c68868ce307c8070732"> 5287</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapDataList.html#ad0221acb745b4c68868ce307c8070732">VerticalGapDataList::sumStretchFactor</a>()<span class="keyword"> const</span></div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;      qreal sum { 0.0 };</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vsd : *<span class="keyword">this</span>)</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;            sum += vsd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a580438281cd8680a99047ceb42e5b15f">factor</a>();</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;      <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;      }</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;<span class="comment">//   smallest</span></div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;<span class="comment">//---------------------------------------------------------</span></div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;</div><div class="line"><a name="l05299"></a><span class="lineno"><a class="line" href="classMs_1_1VerticalGapDataList.html#a1a7300a0d3832784cf4b478d6f65bbe2"> 5299</a></span>&#160;qreal <a class="code" href="classMs_1_1VerticalGapDataList.html#a1a7300a0d3832784cf4b478d6f65bbe2">VerticalGapDataList::smallest</a>(qreal <a class="code" href="namespaceMs.html#a10679d0af0c1377db0b8c52cdcc59d58">limit</a>)<span class="keyword"> const</span></div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      <a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vdp { <span class="keyword">nullptr</span> };</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMs_1_1VerticalGapData.html">VerticalGapData</a>* vgd : *<span class="keyword">this</span>) {</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;            <span class="keywordflow">if</span> (vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a3d4e16cf0a0fcc9351b006fdb05d00c9">isFixedHeight</a>())</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;            <span class="keywordflow">if</span> ((qCeil(limit) == qCeil(vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a7f1aac07a7684cca8723ee1ccc5b7788">spacing</a>())))</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;            <span class="keywordflow">if</span> (!vdp || (vgd-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a7f1aac07a7684cca8723ee1ccc5b7788">spacing</a>() &lt;  vdp-&gt;spacing()))</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                  vdp = vgd;</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;            }</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;      <span class="keywordflow">return</span> vdp ? vdp-&gt;<a class="code" href="classMs_1_1VerticalGapData.html#a7f1aac07a7684cca8723ee1ccc5b7788">spacing</a>() : 0.0;</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;      }</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;}</div><div class="ttc" id="classMs_1_1System_html_a9a7bd4171fa032493f708064078a0913"><div class="ttname"><a href="classMs_1_1System.html#a9a7bd4171fa032493f708064078a0913">Ms::System::removeLastMeasure</a></div><div class="ttdeci">void removeLastMeasure()</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00155">system.cpp:155</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_ac05d6d09cbb195e39fa48c5611d08e31"><div class="ttname"><a href="classMs_1_1TimeSig.html#ac05d6d09cbb195e39fa48c5611d08e31">Ms::TimeSig::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8cpp_source.html#l00253">timesig.cpp:253</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_acc471f15d19ad2e742abb8433c071fcb"><div class="ttname"><a href="classMs_1_1Score.html#acc471f15d19ad2e742abb8433c071fcb">Ms::Score::loHeight</a></div><div class="ttdeci">qreal loHeight() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l03687">score.cpp:3687</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a89471772ad4e890e3e4f38f2c67e6318"><div class="ttname"><a href="classMs_1_1Score.html#a89471772ad4e890e3e4f38f2c67e6318">Ms::Score::pageIdx</a></div><div class="ttdeci">virtual int pageIdx(Page *page) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01011">score.h:1011</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_ae9a46df565fa3ece18f101bd3afdb9d2"><div class="ttname"><a href="structMs_1_1AcEl.html#ae9a46df565fa3ece18f101bd3afdb9d2">Ms::AcEl::ascent</a></div><div class="ttdeci">qreal ascent</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00685">layout.cpp:685</a></div></div>
<div class="ttc" id="namespaceMs_html_af1c6d5c887f8bc4c394e7050f483914fa10c4a304905dd48439743b393540ce88"><div class="ttname"><a href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914fa10c4a304905dd48439743b393540ce88">Ms::BarLineType::BROKEN</a></div></div>
<div class="ttc" id="classMs_1_1Stem_html_a27fb7f82d5ae95bb9e619a90ec4e09aa"><div class="ttname"><a href="classMs_1_1Stem.html#a27fb7f82d5ae95bb9e619a90ec4e09aa">Ms::Stem::hookPos</a></div><div class="ttdeci">QPointF hookPos() const</div><div class="ttdef"><b>Definition:</b> <a href="stem_8cpp_source.html#l00402">stem.cpp:402</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a3e4c82785c6f5a878ae8ce6f80f145da"><div class="ttname"><a href="classMs_1_1System.html#a3e4c82785c6f5a878ae8ce6f80f145da">Ms::System::layoutSystem</a></div><div class="ttdeci">void layoutSystem(qreal, const bool isFirstSystem=false, bool firstSystemIndent=false)</div><div class="ttdoc">Layout the System. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00221">system.cpp:221</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a393fe76e521cb4f1be1d6ab526b64bdf"><div class="ttname"><a href="classMs_1_1Score.html#a393fe76e521cb4f1be1d6ab526b64bdf">Ms::Score::collectSystem</a></div><div class="ttdeci">System * collectSystem(LayoutContext &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03754">layout.cpp:3754</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a44dc6d5b22a75152673060bc059acfb9"><div class="ttname"><a href="classMs_1_1Segment.html#a44dc6d5b22a75152673060bc059acfb9">Ms::Segment::measure</a></div><div class="ttdeci">Measure * measure() const</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00130">segment.h:130</a></div></div>
<div class="ttc" id="accidental_8h_html"><div class="ttname"><a href="accidental_8h.html">accidental.h</a></div><div class="ttdoc">Definition of class Accidental. </div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_aa4067fe8548ee70fb5f9a8e09bdd8c7f"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#aa4067fe8548ee70fb5f9a8e09bdd8c7f">Ms::VerticalGapData::insideCurlyBracket</a></div><div class="ttdeci">void insideCurlyBracket()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05188">layout.cpp:5188</a></div></div>
<div class="ttc" id="classMs_1_1Tie_html_a81e11c00ff2b76f3472303560c12d0a5"><div class="ttname"><a href="classMs_1_1Tie.html#a81e11c00ff2b76f3472303560c12d0a5">Ms::Tie::layoutBack</a></div><div class="ttdeci">TieSegment * layoutBack(System *)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8cpp_source.html#l00705">tie.cpp:705</a></div></div>
<div class="ttc" id="namespaceMs_html_a602ef082ffbbe2c4b11e2375cc4aa794ae7f80072156130d537acf825545c10f0"><div class="ttname"><a href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794ae7f80072156130d537acf825545c10f0">Ms::SymId::augmentationDot</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a4f70ed1ad94787f19a5b90c38df3564e"><div class="ttname"><a href="classMs_1_1Note.html#a4f70ed1ad94787f19a5b90c38df3564e">Ms::Note::fixed</a></div><div class="ttdeci">bool fixed() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00369">note.h:369</a></div></div>
<div class="ttc" id="namespaceMs_html_a72e619a51799cbb2ec85aa0a07e8fd18afa177138f94a7ea01f549b1aa7893d03"><div class="ttname"><a href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18afa177138f94a7ea01f549b1aa7893d03">Ms::VerticalAlignRange::SYSTEM</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_ac1fe59b8f92c11fc6b662855fc8d9316"><div class="ttname"><a href="classMs_1_1Note.html#ac1fe59b8f92c11fc6b662855fc8d9316">Ms::Note::chord</a></div><div class="ttdeci">Chord * chord() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00429">note.h:429</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a45c227344f847388a341fbdda6efe978"><div class="ttname"><a href="classMs_1_1Measure.html#a45c227344f847388a341fbdda6efe978">Ms::Measure::mmRangeText</a></div><div class="ttdeci">MMRestRange * mmRangeText(int staffIdx) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00321">measure.cpp:321</a></div></div>
<div class="ttc" id="fermata_8h_html"><div class="ttname"><a href="fermata_8h.html">fermata.h</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eac8e280960e5fa9a7f502d66719e60005"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eac8e280960e5fa9a7f502d66719e60005">Ms::Sid::accidentalNoteDistance</a></div></div>
<div class="ttc" id="measurenumber_8h_html"><div class="ttname"><a href="measurenumber_8h.html">measurenumber.h</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a58cc5b8055aed00a47b0097718a6f560"><div class="ttname"><a href="classMs_1_1Score.html#a58cc5b8055aed00a47b0097718a6f560">Ms::Score::styleSt</a></div><div class="ttdeci">QString styleSt(Sid idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00897">score.h:897</a></div></div>
<div class="ttc" id="classMs_1_1Stem_html_af82b7550b3812ab906901aa32efe0e2b"><div class="ttname"><a href="classMs_1_1Stem.html#af82b7550b3812ab906901aa32efe0e2b">Ms::Stem::setLen</a></div><div class="ttdeci">void setLen(qreal l)</div><div class="ttdef"><b>Definition:</b> <a href="stem_8cpp_source.html#l00131">stem.cpp:131</a></div></div>
<div class="ttc" id="namespaceMs_html_ae665d4585b944f2ec91a33a5c89732bd"><div class="ttname"><a href="namespaceMs.html#ae665d4585b944f2ec91a33a5c89732bd">Ms::track2staff</a></div><div class="ttdeci">int track2staff(int voice)</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00078">mscore.h:78</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894ac9bacf3e6728a92c9bf826c740ae5436"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ac9bacf3e6728a92c9bf826c740ae5436">Ms::SegmentType::KeySig</a></div></div>
<div class="ttc" id="classMs_1_1StemSlash_html_a37b6ee2aae8b5b24018145923df93d86"><div class="ttname"><a href="classMs_1_1StemSlash.html#a37b6ee2aae8b5b24018145923df93d86">Ms::StemSlash::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="stemslash_8cpp_source.html#l00045">stemslash.cpp:45</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a739b42bcabec5855e374b509f74ea815"><div class="ttname"><a href="classMs_1_1Measure.html#a739b42bcabec5855e374b509f74ea815">Ms::Measure::segments</a></div><div class="ttdeci">SegmentList &amp; segments()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00155">measure.h:155</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a4cc362a42bad65483b59d3a8e0df374f"><div class="ttname"><a href="classMs_1_1Element.html#a4cc362a42bad65483b59d3a8e0df374f">Ms::Element::tick</a></div><div class="ttdeci">virtual Fraction tick() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00319">element.cpp:319</a></div></div>
<div class="ttc" id="element_8h_html"><div class="ttname"><a href="element_8h.html">element.h</a></div></div>
<div class="ttc" id="namespaceMs_html_aa0f871cf8181cec31d68d20a39010655a0e367b050268c19d741b999b26536350"><div class="ttname"><a href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a0e367b050268c19d741b999b26536350">Ms::Pid::BARLINE_TYPE</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a5504cca91c6aafce127cf4de5d0e49de"><div class="ttname"><a href="classMs_1_1Score.html#a5504cca91c6aafce127cf4de5d0e49de">Ms::Score::getNextMeasure</a></div><div class="ttdeci">void getNextMeasure(LayoutContext &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02862">layout.cpp:2862</a></div></div>
<div class="ttc" id="classMs_1_1Tie_html_acdcb6924221b29a0e3d6ae3fa109aa14"><div class="ttname"><a href="classMs_1_1Tie.html#acdcb6924221b29a0e3d6ae3fa109aa14">Ms::Tie::startNote</a></div><div class="ttdeci">Note * startNote() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8cpp_source.html#l00770">tie.cpp:770</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a3c5e55d2f2291d5ee433a093c0b1dd04"><div class="ttname"><a href="classMs_1_1Measure.html#a3c5e55d2f2291d5ee433a093c0b1dd04">Ms::Measure::first</a></div><div class="ttdeci">Ms::Segment * first() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00149">measure.h:149</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a0b00b334328d65102dfd1cbe86c9e629"><div class="ttname"><a href="classMs_1_1System.html#a0b00b334328d65102dfd1cbe86c9e629">Ms::System::setDistance</a></div><div class="ttdeci">void setDistance(qreal d)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00200">system.h:200</a></div></div>
<div class="ttc" id="classMs_1_1ScoreElement_html_a4d0de3ac9401da46c32ed8becb9d496b"><div class="ttname"><a href="classMs_1_1ScoreElement.html#a4d0de3ac9401da46c32ed8becb9d496b">Ms::ScoreElement::isStyled</a></div><div class="ttdeci">bool isStyled(Pid pid) const</div><div class="ttdef"><b>Definition:</b> <a href="scoreElement_8cpp_source.html#l00247">scoreElement.cpp:247</a></div></div>
<div class="ttc" id="namespaceMs_html_a4ddd02afd2f797a6a269ddce7466a4d6ac4e0e4e3118472beeb2ae75827450f1f"><div class="ttname"><a href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ac4e0e4e3118472beeb2ae75827450f1f">Ms::Direction::DOWN</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea0bd7c72185a0b785f4457db05401330c"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea0bd7c72185a0b785f4457db05401330c">Ms::Sid::autoplaceVerticalAlignRange</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a260e48485af749a75d5e763700e13010"><div class="ttname"><a href="classMs_1_1Measure.html#a260e48485af749a75d5e763700e13010">Ms::Measure::addSystemTrailer</a></div><div class="ttdeci">void addSystemTrailer(Measure *nm)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04190">measure.cpp:4190</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_adb1ce7a9970f4e47d69a6344eb51aa61"><div class="ttname"><a href="classMs_1_1MeasureBase.html#adb1ce7a9970f4e47d69a6344eb51aa61">Ms::MeasureBase::setTicks</a></div><div class="ttdeci">void setTicks(const Fraction &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00129">measurebase.h:129</a></div></div>
<div class="ttc" id="namespaceMs_html_a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6"><div class="ttname"><a href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bae738c26bf4ce1037fa81b039a915cbf6">Ms::LayoutMode::FLOAT</a></div></div>
<div class="ttc" id="classMs_1_1Accidental_html_a3c4e78a770ad6163c6502551829249d1"><div class="ttname"><a href="classMs_1_1Accidental.html#a3c4e78a770ad6163c6502551829249d1">Ms::Accidental::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="accidental_8cpp_source.html#l00345">accidental.cpp:345</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaab98622c976c49f95db66b4525f10789"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaab98622c976c49f95db66b4525f10789">Ms::Sid::lastSystemFillLimit</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a974c42eccde33cecfe763c8971f50434"><div class="ttname"><a href="classMs_1_1Chord.html#a974c42eccde33cecfe763c8971f50434">Ms::Chord::stem</a></div><div class="ttdeci">Stem * stem() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00136">chord.h:136</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a3d52cb81e00336d49938b6e43e96ead3"><div class="ttname"><a href="classMs_1_1Segment.html#a3d52cb81e00336d49938b6e43e96ead3">Ms::Segment::setDotPosX</a></div><div class="ttdeci">void setDotPosX(int staffIdx, qreal val)</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00183">segment.h:183</a></div></div>
<div class="ttc" id="classMs_1_1KeySig_html_ae86100386edc3a5b7445b4c3d7cee79a"><div class="ttname"><a href="classMs_1_1KeySig.html#ae86100386edc3a5b7445b4c3d7cee79a">Ms::KeySig::showCourtesy</a></div><div class="ttdeci">bool showCourtesy() const</div><div class="ttdef"><b>Definition:</b> <a href="keysig_8h_source.html#l00067">keysig.h:67</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a002bfeb279e714adaff047d623de3fa8"><div class="ttname"><a href="classMs_1_1Chord.html#a002bfeb279e714adaff047d623de3fa8">Ms::Chord::measure</a></div><div class="ttdeci">Measure * measure() const override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l03005">chord.cpp:3005</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eae8ca6eb9d2ba4f6fe3cabadc4719fd1b"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eae8ca6eb9d2ba4f6fe3cabadc4719fd1b">Ms::Sid::ledgerLineWidth</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6fe"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fe">Ms::Beam::Mode</a></div><div class="ttdeci">Mode</div><div class="ttdef"><b>Definition:</b> <a href="beam_8h_source.html#l00073">beam.h:73</a></div></div>
<div class="ttc" id="structMs_1_1Spring_html_ad22ab9409d5f708042ae3ab507af1359"><div class="ttname"><a href="structMs_1_1Spring.html#ad22ab9409d5f708042ae3ab507af1359">Ms::Spring::Spring</a></div><div class="ttdeci">Spring(int i, qreal s, qreal f)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01885">layout.cpp:1885</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a3ae65ea04ec39f647d9b7839afc4f186"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a3ae65ea04ec39f647d9b7839afc4f186">Ms::VerticalGapData::actualAddedSpace</a></div><div class="ttdeci">qreal actualAddedSpace() const</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05216">layout.cpp:5216</a></div></div>
<div class="ttc" id="libmscore_2part_8h_html"><div class="ttname"><a href="libmscore_2part_8h.html">part.h</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a22789a30661e49d958abc30c0dce71ee"><div class="ttname"><a href="classMs_1_1Measure.html#a22789a30661e49d958abc30c0dce71ee">Ms::Measure::vspacerUp</a></div><div class="ttdeci">Spacer * vspacerUp(int staffIdx) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00308">measure.cpp:308</a></div></div>
<div class="ttc" id="structMs_1_1Spring_html_a7e0380cc850bb2909bb576c549c7abce"><div class="ttname"><a href="structMs_1_1Spring.html#a7e0380cc850bb2909bb576c549c7abce">Ms::Spring::stretch</a></div><div class="ttdeci">qreal stretch</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01883">layout.cpp:1883</a></div></div>
<div class="ttc" id="classMs_1_1Clef_html"><div class="ttname"><a href="classMs_1_1Clef.html">Ms::Clef</a></div><div class="ttdoc">Graphic representation of a clef. </div><div class="ttdef"><b>Definition:</b> <a href="clef_8h_source.html#l00132">clef.h:132</a></div></div>
<div class="ttc" id="classMs_1_1SysStaff_html_a15edb8450b4cbf7ec4c20591804def65"><div class="ttname"><a href="classMs_1_1SysStaff.html#a15edb8450b4cbf7ec4c20591804def65">Ms::SysStaff::show</a></div><div class="ttdeci">bool show() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00073">system.h:73</a></div></div>
<div class="ttc" id="classMs_1_1Spacer_html_a3ffe335bf95ba8e36cdc3c1dbb67ff36"><div class="ttname"><a href="classMs_1_1Spacer.html#a3ffe335bf95ba8e36cdc3c1dbb67ff36">Ms::Spacer::spacerType</a></div><div class="ttdeci">SpacerType spacerType() const</div><div class="ttdef"><b>Definition:</b> <a href="spacer_8h_source.html#l00048">spacer.h:48</a></div></div>
<div class="ttc" id="namespaceMs_html_a10679d0af0c1377db0b8c52cdcc59d58"><div class="ttname"><a href="namespaceMs.html#a10679d0af0c1377db0b8c52cdcc59d58">Ms::limit</a></div><div class="ttdeci">static int limit(int val, int min, int max)</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00408">mscore.h:408</a></div></div>
<div class="ttc" id="namespaceMs_html_ae95dea350de4a3014dbcbcfe9a6a75dcaf83dad84a4844ef191d4fccb09bb9a02"><div class="ttname"><a href="namespaceMs.html#ae95dea350de4a3014dbcbcfe9a6a75dcaf83dad84a4844ef191d4fccb09bb9a02">Ms::LayoutFlag::REBUILD_MIDI_MAPPING</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a5983fb61fbf461b8496f10c1bf766076"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a5983fb61fbf461b8496f10c1bf766076">Ms::LayoutContext::~LayoutContext</a></div><div class="ttdeci">~LayoutContext()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05096">layout.cpp:5096</a></div></div>
<div class="ttc" id="glissando_8h_html"><div class="ttname"><a href="glissando_8h.html">glissando.h</a></div></div>
<div class="ttc" id="sig_8h_html"><div class="ttname"><a href="sig_8h.html">sig.h</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a62c727cafda7869be00be9821f2d7045"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a62c727cafda7869be00be9821f2d7045">Ms::VerticalGapData::updateFactor</a></div><div class="ttdeci">void updateFactor(qreal factor)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05133">layout.cpp:5133</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_aa0dc7d37757d65b7df44ce5e102df2f6"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#aa0dc7d37757d65b7df44ce5e102df2f6">Ms::VerticalGapData::system</a></div><div class="ttdeci">System * system</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00040">layout.h:40</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_ab6c2b0280a3c3de384d8a1b6b721e5b6"><div class="ttname"><a href="classMs_1_1Staff.html#ab6c2b0280a3c3de384d8a1b6b721e5b6">Ms::Staff::staffTypeForElement</a></div><div class="ttdeci">const StaffType * staffTypeForElement(const Element *) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01025">staff.cpp:1025</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a817b1bd3c14e6d5e9ba961ccd092e45b"><div class="ttname"><a href="classMs_1_1Measure.html#a817b1bd3c14e6d5e9ba961ccd092e45b">Ms::Measure::add</a></div><div class="ttdeci">void add(Element *) override</div><div class="ttdoc">Add new Element el to Measure. </div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00844">measure.cpp:844</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a089fc60c82e4545af67d42ef3f805e15"><div class="ttname"><a href="classMs_1_1Score.html#a089fc60c82e4545af67d42ef3f805e15">Ms::Score::_unmanagedSpanner</a></div><div class="ttdeci">std::set&lt; Spanner * &gt; _unmanagedSpanner</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00445">score.h:445</a></div></div>
<div class="ttc" id="undo_8h_html"><div class="ttname"><a href="undo_8h.html">undo.h</a></div><div class="ttdoc">Definition of undo-releated classes and structs. </div></div>
<div class="ttc" id="namespaceMs_html_a130aa9f1611e42fc06a6eaee6d78da2d"><div class="ttname"><a href="namespaceMs.html#a130aa9f1611e42fc06a6eaee6d78da2d">Ms::layoutHarmonies</a></div><div class="ttdeci">void layoutHarmonies(const std::vector&lt; Segment *&gt; &amp;sl)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03528">layout.cpp:3528</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a722c73034ff13507a1336593e6af9567"><div class="ttname"><a href="classMs_1_1Chord.html#a722c73034ff13507a1336593e6af9567">Ms::Chord::stemDirection</a></div><div class="ttdeci">Direction stemDirection() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00110">chord.h:110</a></div></div>
<div class="ttc" id="classMs_1_1Note_html"><div class="ttname"><a href="classMs_1_1Note.html">Ms::Note</a></div><div class="ttdoc">Graphic representation of a note. </div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00235">note.h:235</a></div></div>
<div class="ttc" id="classMs_1_1CmdState_html_ad10dd069bac6b880ea5f66d8c5dfb62e"><div class="ttname"><a href="classMs_1_1CmdState.html#ad10dd069bac6b880ea5f66d8c5dfb62e">Ms::CmdState::lock</a></div><div class="ttdeci">void lock()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00305">score.h:305</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a34e17dca66c25cbd046523dc0c1c7978"><div class="ttname"><a href="classMs_1_1ChordRest.html#a34e17dca66c25cbd046523dc0c1c7978">Ms::ChordRest::crossMeasure</a></div><div class="ttdeci">CrossMeasure crossMeasure() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00152">chordrest.h:152</a></div></div>
<div class="ttc" id="namespaceMs_html_a365dcf81941d576fcd006011e32185c5"><div class="ttname"><a href="namespaceMs.html#a365dcf81941d576fcd006011e32185c5">Ms::SpringMap</a></div><div class="ttdeci">std::multimap&lt; qreal, Spring, std::less&lt; qreal &gt; &gt; SpringMap</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01888">layout.cpp:1888</a></div></div>
<div class="ttc" id="classMs_1_1Harmony_html"><div class="ttname"><a href="classMs_1_1Harmony.html">Ms::Harmony</a></div><div class="ttdef"><b>Definition:</b> <a href="harmony_8h_source.html#l00069">harmony.h:69</a></div></div>
<div class="ttc" id="namespaceMs_html_ad645340ae3d26d22eb29ecc4395824a0aa978f79663129bdb1ab765185b15a9b2"><div class="ttname"><a href="namespaceMs.html#ad645340ae3d26d22eb29ecc4395824a0aa978f79663129bdb1ab765185b15a9b2">Ms::AccidentalBracket::BRACE</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_aa3fcf32f0ec0dec0e4b15bc01b6329ec"><div class="ttname"><a href="classMs_1_1Chord.html#aa3fcf32f0ec0dec0e4b15bc01b6329ec">Ms::Chord::mag</a></div><div class="ttdeci">qreal mag() const override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l02983">chord.cpp:2983</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ae612bd158973276baba3df65f1e5d9d4"><div class="ttname"><a href="classMs_1_1Measure.html#ae612bd158973276baba3df65f1e5d9d4">Ms::Measure::moveTicks</a></div><div class="ttdeci">void moveTicks(const Fraction &amp;diff) override</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l01094">measure.cpp:1094</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a6dbe701d1fecb2a897f97acaac59c7ea"><div class="ttname"><a href="classMs_1_1Score.html#a6dbe701d1fecb2a897f97acaac59c7ea">Ms::Score::maxSystemDistance</a></div><div class="ttdeci">qreal maxSystemDistance() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l03479">score.cpp:3479</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a979a12736465161f2e680cd26df8c0a3"><div class="ttname"><a href="classMs_1_1Score.html#a979a12736465161f2e680cd26df8c0a3">Ms::Score::styleI</a></div><div class="ttdeci">int styleI(Sid idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00900">score.h:900</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a79b3e923044c67ce26c45dd20f22d849"><div class="ttname"><a href="classMs_1_1Score.html#a79b3e923044c67ce26c45dd20f22d849">Ms::Score::pos</a></div><div class="ttdeci">Fraction pos()</div><div class="ttdef"><b>Definition:</b> <a href="edit_8cpp_source.html#l00139">edit.cpp:139</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html"><div class="ttname"><a href="classMs_1_1Segment.html">Ms::Segment</a></div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00050">segment.h:50</a></div></div>
<div class="ttc" id="classMs_1_1Skyline_html_a75b885f52eeb5c5a0c5e6a1a0ccbb4dd"><div class="ttname"><a href="classMs_1_1Skyline.html#a75b885f52eeb5c5a0c5e6a1a0ccbb4dd">Ms::Skyline::south</a></div><div class="ttdeci">SkylineLine &amp; south()</div><div class="ttdef"><b>Definition:</b> <a href="skyline_8h_source.html#l00089">skyline.h:89</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eacf91555d502f169a47dcd9db66a88590"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eacf91555d502f169a47dcd9db66a88590">Ms::Sid::graceNoteMag</a></div></div>
<div class="ttc" id="classMs_1_1BarLine_html_a42d506ca189702e276733a14b70f017e"><div class="ttname"><a href="classMs_1_1BarLine.html#a42d506ca189702e276733a14b70f017e">Ms::BarLine::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="barline_8cpp_source.html#l01337">barline.cpp:1337</a></div></div>
<div class="ttc" id="namespaceMs_html_a101ff65a9a9fe8da96154bd6bd3d2d5a"><div class="ttname"><a href="namespaceMs.html#a101ff65a9a9fe8da96154bd6bd3d2d5a">Ms::checkDivider</a></div><div class="ttdeci">static void checkDivider(bool left, System *s, qreal yOffset, bool remove=false)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01522">layout.cpp:1522</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_a6dadfb1b4b373eb11485cc8372cb0edd"><div class="ttname"><a href="classMs_1_1Beam.html#a6dadfb1b4b373eb11485cc8372cb0edd">Ms::Beam::elements</a></div><div class="ttdeci">const QVector&lt; ChordRest * &gt; &amp; elements()</div><div class="ttdef"><b>Definition:</b> <a href="beam_8h_source.html#l00109">beam.h:109</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html"><div class="ttname"><a href="classMs_1_1Measure.html">Ms::Measure</a></div><div class="ttdoc">one measure in a system </div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00066">measure.h:66</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a77eab400665dc934f24de11fc7ac1c4e"><div class="ttname"><a href="classMs_1_1Chord.html#a77eab400665dc934f24de11fc7ac1c4e">Ms::Chord::notes</a></div><div class="ttdeci">std::vector&lt; Note * &gt; &amp; notes()</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00123">chord.h:123</a></div></div>
<div class="ttc" id="classMs_1_1System_html_aad9535273017c27595ea5aeb0b3baf38"><div class="ttname"><a href="classMs_1_1System.html#aad9535273017c27595ea5aeb0b3baf38">Ms::System::minBottom</a></div><div class="ttdeci">qreal minBottom() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01521">system.cpp:1521</a></div></div>
<div class="ttc" id="classMs_1_1Stem_html_a7617f445b0e92b8a90862c7f3df1c682"><div class="ttname"><a href="classMs_1_1Stem.html#a7617f445b0e92b8a90862c7f3df1c682">Ms::Stem::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="stem_8cpp_source.html#l00081">stem.cpp:81</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_aad21335a2a9a90b9d623bbf3d55f747a"><div class="ttname"><a href="classMs_1_1Note.html#aad21335a2a9a90b9d623bbf3d55f747a">Ms::Note::setDotY</a></div><div class="ttdeci">void setDotY(Direction)</div><div class="ttdef"><b>Definition:</b> <a href="note_8cpp_source.html#l01954">note.cpp:1954</a></div></div>
<div class="ttc" id="classMs_1_1Tie_html_a10612faf2ce6ddf3be9f99970df069b8"><div class="ttname"><a href="classMs_1_1Tie.html#a10612faf2ce6ddf3be9f99970df069b8">Ms::Tie::setEndNote</a></div><div class="ttdeci">void setEndNote(Note *note)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8h_source.html#l00071">tie.h:71</a></div></div>
<div class="ttc" id="classMs_1_1ScoreElement_html_accef1c91df491a43c54e70474deea60c"><div class="ttname"><a href="classMs_1_1ScoreElement.html#accef1c91df491a43c54e70474deea60c">Ms::ScoreElement::isChordRest</a></div><div class="ttdeci">bool isChordRest() const</div><div class="ttdef"><b>Definition:</b> <a href="scoreElement_8h_source.html#l00362">scoreElement.h:362</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aaa20fcc0a0a1f86b0b0d859648341c49"><div class="ttname"><a href="classMs_1_1Score.html#aaa20fcc0a0a1f86b0b0d859648341c49">Ms::Score::spatium</a></div><div class="ttdeci">qreal spatium() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00904">score.h:904</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a8343c23d70b61fe4572e2adef6330667"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a8343c23d70b61fe4572e2adef6330667">Ms::LayoutContext::layout</a></div><div class="ttdeci">void layout()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05042">layout.cpp:5042</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a3310b010a17d4f1f2e40edf2d356207d"><div class="ttname"><a href="classMs_1_1Score.html#a3310b010a17d4f1f2e40edf2d356207d">Ms::Score::styleD</a></div><div class="ttdeci">qreal styleD(Sid idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00899">score.h:899</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_abcc300aa27120a1c799aedfa211aec6d"><div class="ttname"><a href="classMs_1_1Measure.html#abcc300aa27120a1c799aedfa211aec6d">Ms::Measure::findChordRest</a></div><div class="ttdeci">ChordRest * findChordRest(Fraction tick, int track)</div><div class="ttdoc">Search for chord or rest at position tick at staff in voice. </div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00731">measure.cpp:731</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea573e8a963f644296eee0dd671585b1ee"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea573e8a963f644296eee0dd671585b1ee">Ms::Sid::crossMeasureValues</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aeb7c90481b6f7672bbbcd3775a2aae7d">Ms::SegmentType::EndBarLine</a></div></div>
<div class="ttc" id="classMs_1_1Element_html"><div class="ttname"><a href="classMs_1_1Element.html">Ms::Element</a></div><div class="ttdoc">Base class of score layout elements. </div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00163">element.h:163</a></div></div>
<div class="ttc" id="classMs_1_1SystemDivider_html_a6b9161958a162319d850b16050e12995"><div class="ttname"><a href="classMs_1_1SystemDivider.html#a6b9161958a162319d850b16050e12995">Ms::SystemDivider::setDividerType</a></div><div class="ttdeci">void setDividerType(Type v)</div><div class="ttdef"><b>Definition:</b> <a href="systemdivider_8cpp_source.html#l00063">systemdivider.cpp:63</a></div></div>
<div class="ttc" id="namespaceMs_html_a9b1fb02f916c554309371c6513550a1bafa177138f94a7ea01f549b1aa7893d03"><div class="ttname"><a href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1bafa177138f94a7ea01f549b1aa7893d03">Ms::LayoutMode::SYSTEM</a></div></div>
<div class="ttc" id="classMs_1_1ScoreFont_html_a76981900d57807ccce490f1f25dfa31e"><div class="ttname"><a href="classMs_1_1ScoreFont.html#a76981900d57807ccce490f1f25dfa31e">Ms::ScoreFont::width</a></div><div class="ttdeci">qreal width(SymId id, qreal mag) const</div><div class="ttdef"><b>Definition:</b> <a href="sym_8h_source.html#l03061">sym.h:3061</a></div></div>
<div class="ttc" id="libmscore_2tie_8h_html"><div class="ttname"><a href="libmscore_2tie_8h.html">tie.h</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ae4c2254a3440f2fb993cee717412fec5"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ae4c2254a3440f2fb993cee717412fec5">Ms::MeasureBase::takeElements</a></div><div class="ttdeci">ElementList takeElements()</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00066">measurebase.cpp:66</a></div></div>
<div class="ttc" id="namespaceMs_html_a4723eaf0d51b78054133d58d1a6935cb"><div class="ttname"><a href="namespaceMs.html#a4723eaf0d51b78054133d58d1a6935cb">Ms::sort</a></div><div class="ttdeci">static void sort(int &amp;r1, int &amp;c1, int &amp;r2, int &amp;c2)</div><div class="ttdoc">swap (r1,c1) with (r2,c2) if they are not sorted </div><div class="ttdef"><b>Definition:</b> <a href="textbase_8cpp_source.html#l00109">textbase.cpp:109</a></div></div>
<div class="ttc" id="classMs_1_1Link_html"><div class="ttname"><a href="classMs_1_1Link.html">Ms::Link</a></div><div class="ttdef"><b>Definition:</b> <a href="undo_8h_source.html#l01289">undo.h:1289</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html"><div class="ttname"><a href="classMs_1_1MeasureBase.html">Ms::MeasureBase</a></div><div class="ttdoc">Virtual base class for Measure, HBox and VBox. </div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00061">measurebase.h:61</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894af69392a2ebed1af02428c867f81fed3f"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894af69392a2ebed1af02428c867f81fed3f">Ms::SegmentType::HeaderClef</a></div></div>
<div class="ttc" id="classMs_1_1CmdStateLocker_html_a3d66544b71eabf57e874e2d83fc0197d"><div class="ttname"><a href="classMs_1_1CmdStateLocker.html#a3d66544b71eabf57e874e2d83fc0197d">Ms::CmdStateLocker::CmdStateLocker</a></div><div class="ttdeci">CmdStateLocker(Score *s)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04877">layout.cpp:4877</a></div></div>
<div class="ttc" id="namespaceMs_html_ab7904232a877db2441531871cf3f5108"><div class="ttname"><a href="namespaceMs.html#ab7904232a877db2441531871cf3f5108">Ms::DPI</a></div><div class="ttdeci">static constexpr qreal DPI</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00090">mscore.h:90</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a5a9584b81bbc6358dbdf54a80de73bbd"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a5a9584b81bbc6358dbdf54a80de73bbd">Ms::LayoutContext::prevMeasure</a></div><div class="ttdeci">MeasureBase * prevMeasure</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00098">layout.h:98</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a2abd8e864fcfe4f972fc807ddd9f0dcc"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a2abd8e864fcfe4f972fc807ddd9f0dcc">Ms::MeasureBase::setRepeatEnd</a></div><div class="ttdeci">void setRepeatEnd(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00150">measurebase.h:150</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a4957f952a3eca95bba93abfe047420bd"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a4957f952a3eca95bba93abfe047420bd">Ms::MeasureBase::tick</a></div><div class="ttdeci">Fraction tick() const override</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00340">measurebase.cpp:340</a></div></div>
<div class="ttc" id="classMs_1_1Spacer_html_a78bf0f34478639535d9ef1a11b12d37c"><div class="ttname"><a href="classMs_1_1Spacer.html#a78bf0f34478639535d9ef1a11b12d37c">Ms::Spacer::gap</a></div><div class="ttdeci">qreal gap() const</div><div class="ttdef"><b>Definition:</b> <a href="spacer_8h_source.html#l00062">spacer.h:62</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a7e7ba0487a1113884ed218ba74c6a7d6"><div class="ttname"><a href="classMs_1_1Element.html#a7e7ba0487a1113884ed218ba74c6a7d6">Ms::Element::voice</a></div><div class="ttdeci">int voice() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00359">element.h:359</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aed4bf9dbb6034a370cc1222ff676204e"><div class="ttname"><a href="classMs_1_1Score.html#aed4bf9dbb6034a370cc1222ff676204e">Ms::Score::layoutSystemElements</a></div><div class="ttdeci">void layoutSystemElements(System *system, LayoutContext &amp;lc)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04090">layout.cpp:4090</a></div></div>
<div class="ttc" id="namespaceMs_html_a1aade98c30b6b900a52b95472fc620ab"><div class="ttname"><a href="namespaceMs.html#a1aade98c30b6b900a52b95472fc620ab">Ms::layoutAccidental</a></div><div class="ttdeci">static QPair&lt; qreal, qreal &gt; layoutAccidental(AcEl *me, AcEl *above, AcEl *below, qreal colOffset, QVector&lt; Note *&gt; &amp;leftNotes, qreal pnd, qreal pd, qreal sp)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00763">layout.cpp:763</a></div></div>
<div class="ttc" id="fingering_8h_html"><div class="ttname"><a href="fingering_8h.html">fingering.h</a></div></div>
<div class="ttc" id="libmscore_2score_8h_html"><div class="ttname"><a href="libmscore_2score_8h.html">score.h</a></div><div class="ttdoc">Definition of Score class. </div></div>
<div class="ttc" id="classMs_1_1Box_html_a61505cf85e9ba90249879d0392febf10"><div class="ttname"><a href="classMs_1_1Box.html#a61505cf85e9ba90249879d0392febf10">Ms::Box::bottomGap</a></div><div class="ttdeci">qreal bottomGap() const</div><div class="ttdef"><b>Definition:</b> <a href="box_8h_source.html#l00083">box.h:83</a></div></div>
<div class="ttc" id="spacer_8h_html"><div class="ttname"><a href="spacer_8h.html">spacer.h</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a23cde3c97359266e2787b107aa0c8cdf"><div class="ttname"><a href="classMs_1_1Segment.html#a23cde3c97359266e2787b107aa0c8cdf">Ms::Segment::tick</a></div><div class="ttdeci">Fraction tick() const override</div><div class="ttdef"><b>Definition:</b> <a href="segment_8cpp_source.html#l00212">segment.cpp:212</a></div></div>
<div class="ttc" id="breath_8h_html"><div class="ttname"><a href="breath_8h.html">breath.h</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a868f0f5663dd1d7422c19700e070a4a6"><div class="ttname"><a href="classMs_1_1Element.html#a868f0f5663dd1d7422c19700e070a4a6">Ms::Element::trailer</a></div><div class="ttdeci">bool trailer() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00441">element.h:441</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a5fb0640e02f8bfd3f1a383e7a4052250"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a5fb0640e02f8bfd3f1a383e7a4052250">Ms::LayoutContext::curSystem</a></div><div class="ttdeci">System * curSystem</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00092">layout.h:92</a></div></div>
<div class="ttc" id="tremolo_8h_html"><div class="ttname"><a href="tremolo_8h.html">tremolo.h</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a024756cf326cb9c76731aab5f4b152a6"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a024756cf326cb9c76731aab5f4b152a6">Ms::LayoutContext::rangeDone</a></div><div class="ttdeci">bool rangeDone</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00096">layout.h:96</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea5b6e0c6863a2e5149eda540e72454a68"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea5b6e0c6863a2e5149eda540e72454a68">Ms::Sid::dotDotDistance</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aeb406ae3e71511fd168057f3f5b22bb9"><div class="ttname"><a href="classMs_1_1Score.html#aeb406ae3e71511fd168057f3f5b22bb9">Ms::Score::hideEmptyStaves</a></div><div class="ttdeci">void hideEmptyStaves(System *system, bool isFirstSystem)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01325">layout.cpp:1325</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_ac65a5e366eda7035626fb167e4a22ff7"><div class="ttname"><a href="classMs_1_1Note.html#ac65a5e366eda7035626fb167e4a22ff7">Ms::Note::line</a></div><div class="ttdeci">int line() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8cpp_source.html#l02358">note.cpp:2358</a></div></div>
<div class="ttc" id="classMs_1_1AddElement_html"><div class="ttname"><a href="classMs_1_1AddElement.html">Ms::AddElement</a></div><div class="ttdef"><b>Definition:</b> <a href="undo_8h_source.html#l00551">undo.h:551</a></div></div>
<div class="ttc" id="classMs_1_1NoteHead_html_a31c343e7e7f09fee0246ef6a1d7a4e87"><div class="ttname"><a href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87">Ms::NoteHead::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00147">note.h:147</a></div></div>
<div class="ttc" id="namespaceMs_html"><div class="ttname"><a href="namespaceMs.html">Ms</a></div><div class="ttdoc">MusicXML export. </div><div class="ttdef"><b>Definition:</b> <a href="aeolus_8cpp_source.html#l00026">aeolus.cpp:26</a></div></div>
<div class="ttc" id="namespaceMs_html_a5340e53ea850ac4e67c071825916e469"><div class="ttname"><a href="namespaceMs.html#a5340e53ea850ac4e67c071825916e469">Ms::Placement</a></div><div class="ttdeci">Placement</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00394">types.h:394</a></div></div>
<div class="ttc" id="namespaceMs_html_a109fc606d9239dddfd029040503d453c"><div class="ttname"><a href="namespaceMs.html#a109fc606d9239dddfd029040503d453c">Ms::validMMRestMeasure</a></div><div class="ttdeci">static bool validMMRestMeasure(Measure *m)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02372">layout.cpp:2372</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a2a4668572b1873f13d9ebb34c87d872b"><div class="ttname"><a href="classMs_1_1Score.html#a2a4668572b1873f13d9ebb34c87d872b">Ms::Score::tick2measure</a></div><div class="ttdeci">Measure * tick2measure(const Fraction &amp;tick) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2utils_8cpp_source.html#l00047">utils.cpp:47</a></div></div>
<div class="ttc" id="layoutbreak_8h_html"><div class="ttname"><a href="layoutbreak_8h.html">layoutbreak.h</a></div></div>
<div class="ttc" id="layout_8cpp_html_ac9c2a6b16ac8e14d25a6387217db3507"><div class="ttname"><a href="layout_8cpp.html#ac9c2a6b16ac8e14d25a6387217db3507">beamModeMid</a></div><div class="ttdeci">#define beamModeMid(a)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01215">layout.cpp:1215</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a7a2b6622bd7c71f0960ec67403093f7c"><div class="ttname"><a href="classMs_1_1Chord.html#a7a2b6622bd7c71f0960ec67403093f7c">Ms::Chord::layoutArticulations2</a></div><div class="ttdeci">void layoutArticulations2()</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l03541">chord.cpp:3541</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ae3346b5a7ad5893674afc28c9b0877ec"><div class="ttname"><a href="classMs_1_1Element.html#ae3346b5a7ad5893674afc28c9b0877ec">Ms::Element::setWidth</a></div><div class="ttdeci">virtual void setWidth(qreal v)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00281">element.h:281</a></div></div>
<div class="ttc" id="namespaceMs_html_a23d18a6c7a9dff2536e0535c9f5167bd"><div class="ttname"><a href="namespaceMs.html#a23d18a6c7a9dff2536e0535c9f5167bd">Ms::applyLyricsMin</a></div><div class="ttdeci">static void applyLyricsMin(ChordRest *cr, int staffIdx, qreal yMin)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03332">layout.cpp:3332</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_af7baa06eeece60df0ae776b5256b2a56"><div class="ttname"><a href="structMs_1_1AcEl.html#af7baa06eeece60df0ae776b5256b2a56">Ms::AcEl::top</a></div><div class="ttdeci">qreal top</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00680">layout.cpp:680</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html_ae142fe51440f8deeec1e5a4844042714"><div class="ttname"><a href="classMs_1_1Spanner.html#ae142fe51440f8deeec1e5a4844042714">Ms::Spanner::computeStartElement</a></div><div class="ttdeci">void computeStartElement()</div><div class="ttdef"><b>Definition:</b> <a href="spanner_8cpp_source.html#l00577">spanner.cpp:577</a></div></div>
<div class="ttc" id="text_8h_html"><div class="ttname"><a href="text_8h.html">text.h</a></div></div>
<div class="ttc" id="classMs_1_1Skyline_html"><div class="ttname"><a href="classMs_1_1Skyline.html">Ms::Skyline</a></div><div class="ttdef"><b>Definition:</b> <a href="skyline_8h_source.html#l00075">skyline.h:75</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a67489cfbd278731da0a5ed2934c7efd6"><div class="ttname"><a href="classMs_1_1Score.html#a67489cfbd278731da0a5ed2934c7efd6">Ms::Score::first</a></div><div class="ttdeci">MeasureBase * first() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00363">measurebase.cpp:363</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html_a55786c568edbcf9796d5be5971f8eb12"><div class="ttname"><a href="classMs_1_1Spanner.html#a55786c568edbcf9796d5be5971f8eb12">Ms::Spanner::startCR</a></div><div class="ttdeci">ChordRest * startCR()</div><div class="ttdef"><b>Definition:</b> <a href="spanner_8cpp_source.html#l00803">spanner.cpp:803</a></div></div>
<div class="ttc" id="namespaceMs_html_a72e619a51799cbb2ec85aa0a07e8fd18"><div class="ttname"><a href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18">Ms::VerticalAlignRange</a></div><div class="ttdeci">VerticalAlignRange</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00122">layout.h:122</a></div></div>
<div class="ttc" id="classMs_1_1SpannerMap_html_a50d0c4abc63052ad825a4c48cc72dbd3"><div class="ttname"><a href="classMs_1_1SpannerMap.html#a50d0c4abc63052ad825a4c48cc72dbd3">Ms::SpannerMap::findOverlapping</a></div><div class="ttdeci">const std::vector&lt; ::Interval&lt; Spanner * &gt; &gt; &amp; findOverlapping(int start, int stop)</div><div class="ttdef"><b>Definition:</b> <a href="spannermap_8cpp_source.html#l00059">spannermap.cpp:59</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_af4327a46d184dd4b515364038eb51f5f"><div class="ttname"><a href="classMs_1_1Score.html#af4327a46d184dd4b515364038eb51f5f">Ms::Score::prevMeasure</a></div><div class="ttdeci">ChordRest * prevMeasure(ChordRest *element, bool mmRest=false)</div><div class="ttdef"><b>Definition:</b> <a href="navigate_8cpp_source.html#l00488">navigate.cpp:488</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a313b101f15dd05bb416d8e29070b4add"><div class="ttname"><a href="classMs_1_1Note.html#a313b101f15dd05bb416d8e29070b4add">Ms::Note::headType</a></div><div class="ttdeci">NoteHead::Type headType() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00351">note.h:351</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aca83bf67143934f224cd28aa7bdb4459"><div class="ttname"><a href="classMs_1_1Measure.html#aca83bf67143934f224cd28aa7bdb4459">Ms::Measure::timesig</a></div><div class="ttdeci">Fraction timesig() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00142">measure.h:142</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_afe552a986cb79260a7776bce05bdb6ff"><div class="ttname"><a href="classMs_1_1Chord.html#afe552a986cb79260a7776bce05bdb6ff">Ms::Chord::graceNotesAfter</a></div><div class="ttdeci">QVector&lt; Chord * &gt; graceNotesAfter() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l03038">chord.cpp:3038</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a64f76d8f29e50d9cb8bfda72fbf62d2c"><div class="ttname"><a href="classMs_1_1Score.html#a64f76d8f29e50d9cb8bfda72fbf62d2c">Ms::Score::styleS</a></div><div class="ttdeci">Spatium styleS(Sid idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00895">score.h:895</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894ab1c94ca2fbc3e78fc30069c8d0f01680"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894ab1c94ca2fbc3e78fc30069c8d0f01680">Ms::SegmentType::All</a></div><div class="ttdoc">Includes all barline types. </div></div>
<div class="ttc" id="classMs_1_1TimeSig_html"><div class="ttname"><a href="classMs_1_1TimeSig.html">Ms::TimeSig</a></div><div class="ttdoc">This class represents a time signature. </div><div class="ttdef"><b>Definition:</b> <a href="timesig_8h_source.html#l00043">timesig.h:43</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaae705a92c3920c285df68ebcc0a5fbbf"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaae705a92c3920c285df68ebcc0a5fbbf">Ms::Sid::dividerRightY</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_aea0559270e2119a753eb51f4b031098e"><div class="ttname"><a href="classMs_1_1MeasureBase.html#aea0559270e2119a753eb51f4b031098e">Ms::MeasureBase::prevMeasureMM</a></div><div class="ttdeci">Ms::Measure * prevMeasureMM() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00240">measurebase.cpp:240</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a7a6a0cffa1ec2e82a7ae63937688e97f"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a7a6a0cffa1ec2e82a7ae63937688e97f">Ms::VerticalGapData::addSpaceBetweenSections</a></div><div class="ttdeci">void addSpaceBetweenSections()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05146">layout.cpp:5146</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea7ea1b7b4c06c2be22b149d20656ab584"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea7ea1b7b4c06c2be22b149d20656ab584">Ms::Sid::maxStaffSpread</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_ac2a6e99264eae0e0fc71e8d97b4ecb06"><div class="ttname"><a href="classMs_1_1Staff.html#ac2a6e99264eae0e0fc71e8d97b4ecb06">Ms::Staff::show</a></div><div class="ttdeci">bool show() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01159">staff.cpp:1159</a></div></div>
<div class="ttc" id="classMs_1_1Accidental_html"><div class="ttname"><a href="classMs_1_1Accidental.html">Ms::Accidental</a></div><div class="ttdef"><b>Definition:</b> <a href="accidental_8h_source.html#l00071">accidental.h:71</a></div></div>
<div class="ttc" id="classMs_1_1Stem_html"><div class="ttname"><a href="classMs_1_1Stem.html">Ms::Stem</a></div><div class="ttdoc">Graphic representation of a note stem. </div><div class="ttdef"><b>Definition:</b> <a href="stem_8h_source.html#l00027">stem.h:27</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_abe5c0aa8e74388b2b6b336dfec469a35"><div class="ttname"><a href="classMs_1_1Element.html#abe5c0aa8e74388b2b6b336dfec469a35">Ms::Element::setbbox</a></div><div class="ttdeci">virtual void setbbox(const QRectF &amp;r) const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00285">element.h:285</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aab97c3e32db9ffed7379a1f71716cd59"><div class="ttname"><a href="classMs_1_1Score.html#aab97c3e32db9ffed7379a1f71716cd59">Ms::Score::getViewer</a></div><div class="ttdeci">const QList&lt; MuseScoreView * &gt; &amp; getViewer() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01110">score.h:1110</a></div></div>
<div class="ttc" id="namespaceMs_html_a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1"><div class="ttname"><a href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6afbaedde498cdead4f2780217646e9ba1">Ms::Direction::UP</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a01e69b6f8d32b6eb8f28bdf9ed370f56"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a01e69b6f8d32b6eb8f28bdf9ed370f56">Ms::MeasureBase::irregular</a></div><div class="ttdeci">bool irregular() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00158">measurebase.h:158</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_aca2b092f2ded9fb7fb4e69c0ac4a054b"><div class="ttname"><a href="classMs_1_1Staff.html#aca2b092f2ded9fb7fb4e69c0ac4a054b">Ms::Staff::idx</a></div><div class="ttdeci">int idx() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l00060">staff.cpp:60</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea73f11722d4ae05ede496ac5ba18a5fa8"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea73f11722d4ae05ede496ac5ba18a5fa8">Ms::Sid::frameSystemDistance</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea418582c858ff61bb5f4855690b7abf0d"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea418582c858ff61bb5f4855690b7abf0d">Ms::Sid::dividerLeftX</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a90caa02f9c7dfbb0b6f8e96134c29257"><div class="ttname"><a href="classMs_1_1Measure.html#a90caa02f9c7dfbb0b6f8e96134c29257">Ms::Measure::removeSystemHeader</a></div><div class="ttdeci">void removeSystemHeader()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04302">measure.cpp:4302</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a9909fe4a0720b7800e1fedcda555444b"><div class="ttname"><a href="classMs_1_1Measure.html#a9909fe4a0720b7800e1fedcda555444b">Ms::Measure::computeTicks</a></div><div class="ttdeci">Fraction computeTicks()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l03612">measure.cpp:3612</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a56dcf6a02946fd9da8b5a255d7ea09d6"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a56dcf6a02946fd9da8b5a255d7ea09d6">Ms::MeasureBase::sectionBreak</a></div><div class="ttdeci">bool sectionBreak() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00167">measurebase.h:167</a></div></div>
<div class="ttc" id="classMs_1_1Clef_html_ab6bf0a0ccc8357db3cc87d213d204811"><div class="ttname"><a href="classMs_1_1Clef.html#ab6bf0a0ccc8357db3cc87d213d204811">Ms::Clef::clefType</a></div><div class="ttdeci">static ClefType clefType(const QString &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="clef_8cpp_source.html#l00348">clef.cpp:348</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aaa1757bb614c6949e784e159264949e0"><div class="ttname"><a href="classMs_1_1Score.html#aaa1757bb614c6949e784e159264949e0">Ms::Score::systemMode</a></div><div class="ttdeci">bool systemMode() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01118">score.h:1118</a></div></div>
<div class="ttc" id="namespaceMs_html_a8a1496edbc37ad47b5c22a3a5edf419d"><div class="ttname"><a href="namespaceMs.html#a8a1496edbc37ad47b5c22a3a5edf419d">Ms::extendedStemLenWithTwoNoteTremolo</a></div><div class="ttdeci">std::pair&lt; qreal, qreal &gt; extendedStemLenWithTwoNoteTremolo(Tremolo *tremolo, qreal stemLen1, qreal stemLen2)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02811">layout.cpp:2811</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aac5cfbf34cbd22da196fd31944a260da"><div class="ttname"><a href="classMs_1_1Score.html#aac5cfbf34cbd22da196fd31944a260da">Ms::Score::masterScore</a></div><div class="ttdeci">MasterScore * masterScore() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01074">score.h:1074</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea3ae74bfbfbf3806a04ffe3999ed4a9dc"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea3ae74bfbfbf3806a04ffe3999ed4a9dc">Ms::Sid::spreadCurlyBracket</a></div></div>
<div class="ttc" id="classMs_1_1LayoutBreak_html_a8e4a14b94f7c6e0fd0b1fd6cd44bc2dd"><div class="ttname"><a href="classMs_1_1LayoutBreak.html#a8e4a14b94f7c6e0fd0b1fd6cd44bc2dd">Ms::LayoutBreak::startWithLongNames</a></div><div class="ttdeci">bool startWithLongNames() const</div><div class="ttdef"><b>Definition:</b> <a href="layoutbreak_8h_source.html#l00070">layoutbreak.h:70</a></div></div>
<div class="ttc" id="classMs_1_1Dynamic_html_ae87cc1992bd580193735cf22e05fdeea"><div class="ttname"><a href="classMs_1_1Dynamic.html#ae87cc1992bd580193735cf22e05fdeea">Ms::Dynamic::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="dynamic_8cpp_source.html#l00269">dynamic.cpp:269</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a7e8b4ba56f18cb041803394a6cf5128a"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a7e8b4ba56f18cb041803394a6cf5128a">Ms::LayoutContext::systemOldMeasure</a></div><div class="ttdeci">MeasureBase * systemOldMeasure</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00094">layout.h:94</a></div></div>
<div class="ttc" id="classMs_1_1SkylineLine_html_a0c9480d415b3880be30d1efac46c0e04"><div class="ttname"><a href="classMs_1_1SkylineLine.html#a0c9480d415b3880be30d1efac46c0e04">Ms::SkylineLine::minDistance</a></div><div class="ttdeci">qreal minDistance(const SkylineLine &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="skyline_8cpp_source.html#l00211">skyline.cpp:211</a></div></div>
<div class="ttc" id="classMs_1_1Tie_html_a9719252bb8e38b88324bdd19ca07f13d"><div class="ttname"><a href="classMs_1_1Tie.html#a9719252bb8e38b88324bdd19ca07f13d">Ms::Tie::endNote</a></div><div class="ttdeci">Note * endNote() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8cpp_source.html#l00780">tie.cpp:780</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_acef2a5afe6db83509657e7fcdb03a08e"><div class="ttname"><a href="classMs_1_1Measure.html#acef2a5afe6db83509657e7fcdb03a08e">Ms::Measure::hasVoices</a></div><div class="ttdeci">bool hasVoices(int staffIdx, Fraction stick, Fraction len) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l02766">measure.cpp:2766</a></div></div>
<div class="ttc" id="classMs_1_1KeySig_html_aaf05171f7463c35873048bf6fa251f2b"><div class="ttname"><a href="classMs_1_1KeySig.html#aaf05171f7463c35873048bf6fa251f2b">Ms::KeySig::isChange</a></div><div class="ttdeci">bool isChange() const</div><div class="ttdef"><b>Definition:</b> <a href="keysig_8cpp_source.html#l00554">keysig.cpp:554</a></div></div>
<div class="ttc" id="timesig_8h_html"><div class="ttname"><a href="timesig_8h.html">timesig.h</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a5744ecf49cbfa1095aa28c9041b18f47"><div class="ttname"><a href="classMs_1_1Score.html#a5744ecf49cbfa1095aa28c9041b18f47">Ms::Score::_selection</a></div><div class="ttdeci">Selection _selection</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00484">score.h:484</a></div></div>
<div class="ttc" id="repeat_8h_html"><div class="ttname"><a href="repeat_8h.html">repeat.h</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a50176508633e0790e3569239bf671d62"><div class="ttname"><a href="classMs_1_1System.html#a50176508633e0790e3569239bf671d62">Ms::System::layout2</a></div><div class="ttdeci">void layout2()</div><div class="ttdoc">Called after Measure layout. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00640">system.cpp:640</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a66a3e42855dec1d88936966d197a0ac0"><div class="ttname"><a href="classMs_1_1Measure.html#a66a3e42855dec1d88936966d197a0ac0">Ms::Measure::findSegment</a></div><div class="ttdeci">Segment * findSegment(SegmentType st, const Fraction &amp;f) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00205">measure.h:205</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a337f76e582585044598cfd507d6f0228"><div class="ttname"><a href="classMs_1_1Measure.html#a337f76e582585044598cfd507d6f0228">Ms::Measure::findSegmentR</a></div><div class="ttdeci">Segment * findSegmentR(SegmentType st, const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00770">measure.cpp:770</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a8ba22391443270db0f91a3164c457d1e"><div class="ttname"><a href="classMs_1_1Element.html#a8ba22391443270db0f91a3164c457d1e">Ms::Element::placeAbove</a></div><div class="ttdeci">bool placeAbove() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00230">element.h:230</a></div></div>
<div class="ttc" id="namespaceMs_html_adcee348b6ab5a4ceefe9c0659daa4dd6"><div class="ttname"><a href="namespaceMs.html#adcee348b6ab5a4ceefe9c0659daa4dd6">Ms::applyLyricsMax</a></div><div class="ttdeci">static void applyLyricsMax(Segment &amp;s, int staffIdx, qreal yMax)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03300">layout.cpp:3300</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eafc0415d5a6fdf38990713e10a6d18ac2"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eafc0415d5a6fdf38990713e10a6d18ac2">Ms::Sid::tremoloStrokeWidth</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a38ee585135744839b5ac1eb26f0da0f5"><div class="ttname"><a href="classMs_1_1Score.html#a38ee585135744839b5ac1eb26f0da0f5">Ms::Score::beamGraceNotes</a></div><div class="ttdeci">void beamGraceNotes(Chord *, bool)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01226">layout.cpp:1226</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a7dd8ea76bec4d8ff3103b7bd9b441596"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a7dd8ea76bec4d8ff3103b7bd9b441596">Ms::VerticalGapData::addSpaceAroundNormalBracket</a></div><div class="ttdeci">void addSpaceAroundNormalBracket()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05170">layout.cpp:5170</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_ac9d042a7decd57dbcea04544594b33c1"><div class="ttname"><a href="classMs_1_1MScore.html#ac9d042a7decd57dbcea04544594b33c1">Ms::MScore::horizontalPageGapEven</a></div><div class="ttdeci">static qreal horizontalPageGapEven</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00385">mscore.h:385</a></div></div>
<div class="ttc" id="classMs_1_1Bracket_html"><div class="ttname"><a href="classMs_1_1Bracket.html">Ms::Bracket</a></div><div class="ttdef"><b>Definition:</b> <a href="bracket_8h_source.html#l00029">bracket.h:29</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_ab3a8ad8d24af861a49c3d6d0112c3bcc"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#ab3a8ad8d24af861a49c3d6d0112c3bcc">Ms::VerticalGapData::_fixedHeight</a></div><div class="ttdeci">bool _fixedHeight</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00030">layout.h:30</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_af0075d4ea77f911abe041be7e7d0762a"><div class="ttname"><a href="classMs_1_1Note.html#af0075d4ea77f911abe041be7e7d0762a">Ms::Note::dotsHidden</a></div><div class="ttdeci">bool dotsHidden() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00443">note.h:443</a></div></div>
<div class="ttc" id="namespaceMs_html_a01be8a28ec7c6f4f367a9318bf93fc71"><div class="ttname"><a href="namespaceMs.html#a01be8a28ec7c6f4f367a9318bf93fc71">Ms::almostZero</a></div><div class="ttdeci">bool almostZero(qreal value)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01558">layout.cpp:1558</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a33b64f9292f5e20eb55a8013e977b722"><div class="ttname"><a href="classMs_1_1Chord.html#a33b64f9292f5e20eb55a8013e977b722">Ms::Chord::computeUp</a></div><div class="ttdeci">void computeUp() override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00876">chord.cpp:876</a></div></div>
<div class="ttc" id="classMs_1_1Clef_html_a2eecb12827da565064dae00af74efa16"><div class="ttname"><a href="classMs_1_1Clef.html#a2eecb12827da565064dae00af74efa16">Ms::Clef::setClefType</a></div><div class="ttdeci">void setClefType(ClefType i)</div><div class="ttdef"><b>Definition:</b> <a href="clef_8cpp_source.html#l00357">clef.cpp:357</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a4c552b7fbbd974800106c2e1edfe8517"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a4c552b7fbbd974800106c2e1edfe8517">Ms::MeasureBase::setNext</a></div><div class="ttdeci">void setNext(MeasureBase *e)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00087">measurebase.h:87</a></div></div>
<div class="ttc" id="namespaceMs_html_aea8cb39fcc02e1ea400e11bbdd037198"><div class="ttname"><a href="namespaceMs.html#aea8cb39fcc02e1ea400e11bbdd037198">Ms::layoutPage</a></div><div class="ttdeci">static void layoutPage(Page *page, qreal restHeight)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01764">layout.cpp:1764</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a0e9a0473e5ed4cc38a1dead12bf4c2f3"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a0e9a0473e5ed4cc38a1dead12bf4c2f3">Ms::MeasureBase::system</a></div><div class="ttdeci">System * system() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00106">measurebase.h:106</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html"><div class="ttname"><a href="classMs_1_1Tremolo.html">Ms::Tremolo</a></div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00039">tremolo.h:39</a></div></div>
<div class="ttc" id="stemslash_8h_html"><div class="ttname"><a href="stemslash_8h.html">stemslash.h</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea5e99b620cdaa454546db9d777cae32a6"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea5e99b620cdaa454546db9d777cae32a6">Ms::Sid::maxPageFillSpread</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a34eca280f3a27e065d2431f12422e867"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a34eca280f3a27e065d2431f12422e867">Ms::VerticalGapData::_fillSpacing</a></div><div class="ttdeci">qreal _fillSpacing</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00035">layout.h:35</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ab6c8d20b57a9c8e72e75684687932777"><div class="ttname"><a href="classMs_1_1Measure.html#ab6c8d20b57a9c8e72e75684687932777">Ms::Measure::undoGetSegment</a></div><div class="ttdeci">Segment * undoGetSegment(SegmentType st, const Fraction &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00206">measure.h:206</a></div></div>
<div class="ttc" id="classMs_1_1MasterScore_html_af8411000a9edcc95127359d6858ca24b"><div class="ttname"><a href="classMs_1_1MasterScore.html#af8411000a9edcc95127359d6858ca24b">Ms::MasterScore::rebuildMidiMapping</a></div><div class="ttdeci">void rebuildMidiMapping()</div><div class="ttdef"><b>Definition:</b> <a href="midimapping_8cpp_source.html#l00025">midimapping.cpp:25</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_acde5406d19a2a8eb5d61d3557f449e58"><div class="ttname"><a href="classMs_1_1Staff.html#acde5406d19a2a8eb5d61d3557f449e58">Ms::Staff::showIfEmpty</a></div><div class="ttdeci">bool showIfEmpty() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8h_source.html#l00173">staff.h:173</a></div></div>
<div class="ttc" id="classMs_1_1Groups_html_a941048b9a1849553fefa03c781b06c65"><div class="ttname"><a href="classMs_1_1Groups.html#a941048b9a1849553fefa03c781b06c65">Ms::Groups::endBeam</a></div><div class="ttdeci">static Beam::Mode endBeam(ChordRest *cr, ChordRest *prev=0)</div><div class="ttdef"><b>Definition:</b> <a href="groups_8cpp_source.html#l00075">groups.cpp:75</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_af813072eba46ad48757444a574d0a01f"><div class="ttname"><a href="classMs_1_1Note.html#af813072eba46ad48757444a574d0a01f">Ms::Note::tpc</a></div><div class="ttdeci">int tpc() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8cpp_source.html#l00803">note.cpp:803</a></div></div>
<div class="ttc" id="classMs_1_1Harmony_html_af11c09bece9d4ec0420aea90748cacef"><div class="ttname"><a href="classMs_1_1Harmony.html#af11c09bece9d4ec0420aea90748cacef">Ms::Harmony::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="harmony_8cpp_source.html#l01334">harmony.cpp:1334</a></div></div>
<div class="ttc" id="classMs_1_1TDuration_html_a123168fe235332a63c716e041fc3ddd5"><div class="ttname"><a href="classMs_1_1TDuration.html#a123168fe235332a63c716e041fc3ddd5">Ms::TDuration::type</a></div><div class="ttdeci">DurationType type() const</div><div class="ttdef"><b>Definition:</b> <a href="durationtype_8h_source.html#l00048">durationtype.h:48</a></div></div>
<div class="ttc" id="classMs_1_1FretDiagram_html_a0a4ebc84b5b1c6295af8ea97a3cac02e"><div class="ttname"><a href="classMs_1_1FretDiagram.html#a0a4ebc84b5b1c6295af8ea97a3cac02e">Ms::FretDiagram::harmony</a></div><div class="ttdeci">Harmony * harmony() const</div><div class="ttdef"><b>Definition:</b> <a href="fret_8h_source.html#l00225">fret.h:225</a></div></div>
<div class="ttc" id="namespaceMs_html_a43546ea8d8f5343ffe26bcdd5d53ef8d"><div class="ttname"><a href="namespaceMs.html#a43546ea8d8f5343ffe26bcdd5d53ef8d">Ms::layoutDrumsetChord</a></div><div class="ttdeci">void layoutDrumsetChord(Chord *c, const Drumset *drumset, const StaffType *st, qreal spatium)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02786">layout.cpp:2786</a></div></div>
<div class="ttc" id="click_8h_html_a23377ea277c7aef62f6cf3c640f7155c"><div class="ttname"><a href="click_8h.html#a23377ea277c7aef62f6cf3c640f7155c">tick</a></div><div class="ttdeci">static const double tick[]</div><div class="ttdef"><b>Definition:</b> <a href="click_8h_source.html#l00525">click.h:525</a></div></div>
<div class="ttc" id="namespaceMs_html_a9b1fb02f916c554309371c6513550a1ba22311203d44b308bd2d607cdc2dcb72c"><div class="ttname"><a href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1ba22311203d44b308bd2d607cdc2dcb72c">Ms::LayoutMode::PAGE</a></div></div>
<div class="ttc" id="classMs_1_1StaffType_html_ae0ffb4991a51dd2715b6a7104f4caca3"><div class="ttname"><a href="classMs_1_1StaffType.html#ae0ffb4991a51dd2715b6a7104f4caca3">Ms::StaffType::stepOffset</a></div><div class="ttdeci">int stepOffset() const</div><div class="ttdef"><b>Definition:</b> <a href="stafftype_8h_source.html#l00292">stafftype.h:292</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a7f1aac07a7684cca8723ee1ccc5b7788"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a7f1aac07a7684cca8723ee1ccc5b7788">Ms::VerticalGapData::spacing</a></div><div class="ttdeci">qreal spacing() const</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05207">layout.cpp:5207</a></div></div>
<div class="ttc" id="classMs_1_1Spatium_html_ab21fa50b8ec92de51fb08a2365770422"><div class="ttname"><a href="classMs_1_1Spatium.html#ab21fa50b8ec92de51fb08a2365770422">Ms::Spatium::val</a></div><div class="ttdeci">constexpr qreal val() const</div><div class="ttdef"><b>Definition:</b> <a href="spatium_8h_source.html#l00032">spatium.h:32</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a772e278641842c27ed84b4234f339e55"><div class="ttname"><a href="classMs_1_1Measure.html#a772e278641842c27ed84b4234f339e55">Ms::Measure::connectTremolo</a></div><div class="ttdeci">void connectTremolo()</div><div class="ttdoc">Connect two-notes tremolo and update duration types for the involved chords. </div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l02627">measure.cpp:2627</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_aad8a6efba52e9f25f3abf75e37483179"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#aad8a6efba52e9f25f3abf75e37483179">Ms::VerticalGapData::_lastStep</a></div><div class="ttdeci">qreal _lastStep</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00036">layout.h:36</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaf2681fbbf073a3545d84861314e6f9d3"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaf2681fbbf073a3545d84861314e6f9d3">Ms::Sid::accidentalDistance</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a8b08d9e9607782a9400c16140e243112"><div class="ttname"><a href="classMs_1_1Measure.html#a8b08d9e9607782a9400c16140e243112">Ms::Measure::checkHeader</a></div><div class="ttdeci">void checkHeader()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04337">measure.cpp:4337</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6feae1f2d5134ed2543d38a0de9751cf75d9"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feae1f2d5134ed2543d38a0de9751cf75d9">Ms::Beam::Mode::AUTO</a></div></div>
<div class="ttc" id="classMs_1_1Tuplet_html_a94169cc886372e29583e9d1e69e8f989"><div class="ttname"><a href="classMs_1_1Tuplet.html#a94169cc886372e29583e9d1e69e8f989">Ms::Tuplet::cross</a></div><div class="ttdeci">bool cross() const</div><div class="ttdef"><b>Definition:</b> <a href="tuplet_8cpp_source.html#l01045">tuplet.cpp:1045</a></div></div>
<div class="ttc" id="classMs_1_1SysStaff_html"><div class="ttname"><a href="classMs_1_1SysStaff.html">Ms::SysStaff</a></div><div class="ttdoc">One staff in a System. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00047">system.h:47</a></div></div>
<div class="ttc" id="namespaceMs_html_a50d463e01faf54d2cebbf7f248888bb6"><div class="ttname"><a href="namespaceMs.html#a50d463e01faf54d2cebbf7f248888bb6">Ms::layoutSegmentElements</a></div><div class="ttdeci">static void layoutSegmentElements(Segment *segment, int startTrack, int endTrack)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00094">layout.cpp:94</a></div></div>
<div class="ttc" id="libmscore_2utils_8h_html"><div class="ttname"><a href="libmscore_2utils_8h.html">utils.h</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a930ae8dc2a6af49471c7d2a8860d7411"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a930ae8dc2a6af49471c7d2a8860d7411">Ms::LayoutContext::collectPage</a></div><div class="ttdeci">void collectPage()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04628">layout.cpp:4628</a></div></div>
<div class="ttc" id="namespaceMs_html_ad863eb4b91e6fcf0deef7c476cb10d43"><div class="ttname"><a href="namespaceMs.html#ad863eb4b91e6fcf0deef7c476cb10d43">Ms::notTopTuplet</a></div><div class="ttdeci">bool notTopTuplet(ChordRest *cr)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03186">layout.cpp:3186</a></div></div>
<div class="ttc" id="classMs_1_1Tuplet_html_a335f84666bd36e2bca5963785ae9759a"><div class="ttname"><a href="classMs_1_1Tuplet.html#a335f84666bd36e2bca5963785ae9759a">Ms::Tuplet::elements</a></div><div class="ttdeci">const std::vector&lt; DurationElement * &gt; &amp; elements() const</div><div class="ttdef"><b>Definition:</b> <a href="tuplet_8h_source.html#l00097">tuplet.h:97</a></div></div>
<div class="ttc" id="namespaceMs_html_a4c0a2128d0477020d4faf110cc01e3aba1e23852820b9154316c7c06e2b7ba051"><div class="ttname"><a href="namespaceMs.html#a4c0a2128d0477020d4faf110cc01e3aba1e23852820b9154316c7c06e2b7ba051">Ms::BracketType::NORMAL</a></div></div>
<div class="ttc" id="namespaceMs_html_a94b50213647d6de824820f47673bd500a21507b40c80068eda19865706fdc2403"><div class="ttname"><a href="namespaceMs.html#a94b50213647d6de824820f47673bd500a21507b40c80068eda19865706fdc2403">Ms::Align::RIGHT</a></div></div>
<div class="ttc" id="classMs_1_1Ambitus_html_a9bce2caa3538a8bc7e03855a70cf9d0e"><div class="ttname"><a href="classMs_1_1Ambitus.html#a9bce2caa3538a8bc7e03855a70cf9d0e">Ms::Ambitus::initFrom</a></div><div class="ttdeci">void initFrom(Ambitus *a)</div><div class="ttdef"><b>Definition:</b> <a href="ambitus_8cpp_source.html#l00071">ambitus.cpp:71</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ac7e0eb9cc9bfb9d619f2cb52ba6f2ea8"><div class="ttname"><a href="classMs_1_1Measure.html#ac7e0eb9cc9bfb9d619f2cb52ba6f2ea8">Ms::Measure::addSystemHeader</a></div><div class="ttdeci">void addSystemHeader(bool firstSystem)</div><div class="ttdoc">Add elements to make this measure suitable as the first measure of a system. </div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04001">measure.cpp:4001</a></div></div>
<div class="ttc" id="systemdivider_8h_html"><div class="ttname"><a href="systemdivider_8h.html">systemdivider.h</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6fea18e48bbdf6d326bd88d3ebb99ad7515d"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea18e48bbdf6d326bd88d3ebb99ad7515d">Ms::Beam::Mode::MID</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_add8b93fda5fa1fedd7e5e29759ce6d97"><div class="ttname"><a href="structMs_1_1LayoutContext.html#add8b93fda5fa1fedd7e5e29759ce6d97">Ms::LayoutContext::systemList</a></div><div class="ttdeci">QList&lt; System * &gt; systemList</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00088">layout.h:88</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a49debb6c28108156c84c4615d9371180"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a49debb6c28108156c84c4615d9371180">Ms::LayoutContext::tick</a></div><div class="ttdeci">Fraction tick</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00086">layout.h:86</a></div></div>
<div class="ttc" id="namespaceMs_html_a298071d9fa87ec9f88dff35fcd1b10af"><div class="ttname"><a href="namespaceMs.html#a298071d9fa87ec9f88dff35fcd1b10af">Ms::findLyricsMinY</a></div><div class="ttdeci">static qreal findLyricsMinY(Segment &amp;s, int staffIdx)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03248">layout.cpp:3248</a></div></div>
<div class="ttc" id="classMs_1_1Box_html"><div class="ttname"><a href="classMs_1_1Box.html">Ms::Box</a></div><div class="ttdoc">virtual base class for frames &quot;boxes&quot; </div><div class="ttdef"><b>Definition:</b> <a href="box_8h_source.html#l00033">box.h:33</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_aa3ab372fd5e04a1563fe8c7581c5aae7"><div class="ttname"><a href="classMs_1_1Note.html#aa3ab372fd5e04a1563fe8c7581c5aae7">Ms::Note::headGroup</a></div><div class="ttdeci">NoteHead::Group headGroup() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00350">note.h:350</a></div></div>
<div class="ttc" id="classMs_1_1SystemDivider_html_a00847d5bb01faa5657fca4d4d87dedf8"><div class="ttname"><a href="classMs_1_1SystemDivider.html#a00847d5bb01faa5657fca4d4d87dedf8">Ms::SystemDivider::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="systemdivider_8cpp_source.html#l00046">systemdivider.cpp:46</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a1a43bbbee320ca145d6bf07f16243837"><div class="ttname"><a href="classMs_1_1Segment.html#a1a43bbbee320ca145d6bf07f16243837">Ms::Segment::add</a></div><div class="ttdeci">void add(Element *) override</div><div class="ttdef"><b>Definition:</b> <a href="segment_8cpp_source.html#l00496">segment.cpp:496</a></div></div>
<div class="ttc" id="structMs_1_1Spring_html_a063e8bc40e6f7f909e42f8098f0f485d"><div class="ttname"><a href="structMs_1_1Spring.html#a063e8bc40e6f7f909e42f8098f0f485d">Ms::Spring::seg</a></div><div class="ttdeci">int seg</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01882">layout.cpp:1882</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a36da6a07a74436d96c739f7134873eda"><div class="ttname"><a href="classMs_1_1Element.html#a36da6a07a74436d96c739f7134873eda">Ms::Element::autoplace</a></div><div class="ttdeci">bool autoplace() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l01223">element.cpp:1223</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ac829548f174316a6275ff01600254da8"><div class="ttname"><a href="classMs_1_1Measure.html#ac829548f174316a6275ff01600254da8">Ms::Measure::computeMinWidth</a></div><div class="ttdeci">void computeMinWidth(Segment *s, qreal x, bool isSystemHeader)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04413">measure.cpp:4413</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a6cab2bc583be79fa27b83390dd48bc7f"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a6cab2bc583be79fa27b83390dd48bc7f">Ms::MeasureBase::ticks</a></div><div class="ttdeci">Fraction ticks() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00128">measurebase.h:128</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a06cc027fe14db0cf896f02931356ae24"><div class="ttname"><a href="classMs_1_1Element.html#a06cc027fe14db0cf896f02931356ae24">Ms::Element::pagePos</a></div><div class="ttdeci">virtual QPointF pagePos() const</div><div class="ttdoc">position in page coordinates </div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00443">element.cpp:443</a></div></div>
<div class="ttc" id="classMs_1_1BracketItem_html"><div class="ttname"><a href="classMs_1_1BracketItem.html">Ms::BracketItem</a></div><div class="ttdef"><b>Definition:</b> <a href="bracketItem_8h_source.html#l00025">bracketItem.h:25</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a68ed1b2711a5a05a1b61b9e42ed93d5b"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a68ed1b2711a5a05a1b61b9e42ed93d5b">Ms::VerticalGapData::undoLastAddSpacing</a></div><div class="ttdeci">void undoLastAddSpacing()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05256">layout.cpp:5256</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a54ce7041fcfd559145860e47490bff0a"><div class="ttname"><a href="classMs_1_1Measure.html#a54ce7041fcfd559145860e47490bff0a">Ms::Measure::layoutMMRestRange</a></div><div class="ttdeci">void layoutMMRestRange()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00603">measure.cpp:603</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ae941c476b82dd103f64991ee3fff131f"><div class="ttname"><a href="classMs_1_1Measure.html#ae941c476b82dd103f64991ee3fff131f">Ms::Measure::basicStretch</a></div><div class="ttdeci">qreal basicStretch() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l03948">measure.cpp:3948</a></div></div>
<div class="ttc" id="page_8h_html"><div class="ttname"><a href="page_8h.html">page.h</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a78fab71d6a88f31deb8477d5022dc743"><div class="ttname"><a href="classMs_1_1Chord.html#a78fab71d6a88f31deb8477d5022dc743">Ms::Chord::stemSlash</a></div><div class="ttdeci">StemSlash * stemSlash() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00143">chord.h:143</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a198572255879b31307ca02b7839c7356"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a198572255879b31307ca02b7839c7356">Ms::MeasureBase::prevMeasure</a></div><div class="ttdeci">Ms::Measure * prevMeasure() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00225">measurebase.cpp:225</a></div></div>
<div class="ttc" id="notedot_8h_html"><div class="ttname"><a href="notedot_8h.html">notedot.h</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_adcd981af2ae9890f31c993050d5f0f25"><div class="ttname"><a href="classMs_1_1Element.html#adcd981af2ae9890f31c993050d5f0f25">Ms::Element::clone</a></div><div class="ttdeci">virtual Q_INVOKABLE Ms::Element * clone() const =0</div></div>
<div class="ttc" id="clef_8h_html"><div class="ttname"><a href="clef_8h.html">clef.h</a></div><div class="ttdoc">Definition of classes Clef. </div></div>
<div class="ttc" id="classMs_1_1Measure_html_a95d953121aa2ea9b6db91e2b147fed50"><div class="ttname"><a href="classMs_1_1Measure.html#a95d953121aa2ea9b6db91e2b147fed50">Ms::Measure::removeSystemTrailer</a></div><div class="ttdeci">void removeSystemTrailer()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04318">measure.cpp:4318</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a49df2a43ee4c87d33b78c60cce70ff4e"><div class="ttname"><a href="classMs_1_1Element.html#a49df2a43ee4c87d33b78c60cce70ff4e">Ms::Element::setMag</a></div><div class="ttdeci">void setMag(qreal val)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00426">element.h:426</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a7cfa9fe3b3082e10b3aafff548af29fc"><div class="ttname"><a href="classMs_1_1Score.html#a7cfa9fe3b3082e10b3aafff548af29fc">Ms::Score::_systems</a></div><div class="ttdeci">QList&lt; System * &gt; _systems</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00451">score.h:451</a></div></div>
<div class="ttc" id="articulation_8h_html"><div class="ttname"><a href="articulation_8h.html">articulation.h</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a365e5013395d4a660672ad8fff61a864"><div class="ttname"><a href="classMs_1_1Score.html#a365e5013395d4a660672ad8fff61a864">Ms::Score::undoRemoveElement</a></div><div class="ttdeci">void undoRemoveElement(Element *element)</div><div class="ttdef"><b>Definition:</b> <a href="edit_8cpp_source.html#l05115">edit.cpp:5115</a></div></div>
<div class="ttc" id="classMs_1_1TDuration_html_aab1a411cf428fcc4244950a88b03ab95"><div class="ttname"><a href="classMs_1_1TDuration.html#aab1a411cf428fcc4244950a88b03ab95">Ms::TDuration::headType</a></div><div class="ttdeci">NoteHead::Type headType() const</div><div class="ttdef"><b>Definition:</b> <a href="durationtype_8cpp_source.html#l00163">durationtype.cpp:163</a></div></div>
<div class="ttc" id="namespaceMs_html_a580f85ffcff35b12462cbfb60a8728b7"><div class="ttname"><a href="namespaceMs.html#a580f85ffcff35b12462cbfb60a8728b7">Ms::toChordRest</a></div><div class="ttdeci">static ChordRest * toChordRest(ScoreElement *e)</div><div class="ttdef"><b>Definition:</b> <a href="scoreElement_8h_source.html#l00427">scoreElement.h:427</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_a4a728f9ca94208b1b67962318eea1317"><div class="ttname"><a href="classMs_1_1MScore.html#a4a728f9ca94208b1b67962318eea1317">Ms::MScore::noVerticalStretch</a></div><div class="ttdeci">static bool noVerticalStretch</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00357">mscore.h:357</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ac02bb72ce68df75fc38ee2c1222de735"><div class="ttname"><a href="classMs_1_1Score.html#ac02bb72ce68df75fc38ee2c1222de735">Ms::Score::_mscVersion</a></div><div class="ttdeci">int _mscVersion</div><div class="ttdoc">version of current loading *.msc file </div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00478">score.h:478</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ad01cda9f6017d09c9fb9305de18e9310"><div class="ttname"><a href="classMs_1_1Element.html#ad01cda9f6017d09c9fb9305de18e9310">Ms::Element::mag</a></div><div class="ttdeci">virtual qreal mag() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00425">element.h:425</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea9b35e5c268673498b969e7a02828c388"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea9b35e5c268673498b969e7a02828c388">Ms::Sid::systemFrameDistance</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_ad0aede93707644473a04a23666e6a2f1"><div class="ttname"><a href="classMs_1_1ChordRest.html#ad0aede93707644473a04a23666e6a2f1">Ms::ChordRest::lyrics</a></div><div class="ttdeci">const std::vector&lt; Lyrics * &gt; &amp; lyrics() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00137">chordrest.h:137</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a07fa204a412636070028f2b159771574"><div class="ttname"><a href="classMs_1_1Score.html#a07fa204a412636070028f2b159771574">Ms::Score::cmdState</a></div><div class="ttdeci">virtual CmdState &amp; cmdState()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01475">score.h:1475</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a7990eccc3ffa4f1e133b730e2bcba46b"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a7990eccc3ffa4f1e133b730e2bcba46b">Ms::MeasureBase::findPotentialSectionBreak</a></div><div class="ttdeci">const MeasureBase * findPotentialSectionBreak() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00265">measurebase.cpp:265</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a19157e811d0d2a0e3c94dc844039ba2f"><div class="ttname"><a href="classMs_1_1Element.html#a19157e811d0d2a0e3c94dc844039ba2f">Ms::Element::pos</a></div><div class="ttdeci">virtual const QPointF pos() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00243">element.h:243</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a68245eebd2b78df8fce9ce35c05d98e1"><div class="ttname"><a href="classMs_1_1Score.html#a68245eebd2b78df8fce9ce35c05d98e1">Ms::Score::_noteHeadWidth</a></div><div class="ttdeci">qreal _noteHeadWidth</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00489">score.h:489</a></div></div>
<div class="ttc" id="classMs_1_1NoteHead_html_a31c343e7e7f09fee0246ef6a1d7a4e87a78a046aa91d9f18cd0b36fe918e74db1"><div class="ttname"><a href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a78a046aa91d9f18cd0b36fe918e74db1">Ms::NoteHead::Type::HEAD_WHOLE</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_adbcd81f12f80859fdaf2ca1bd24d23d1"><div class="ttname"><a href="classMs_1_1Element.html#adbcd81f12f80859fdaf2ca1bd24d23d1">Ms::Element::enabled</a></div><div class="ttdeci">bool enabled() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00455">element.h:455</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ead544010bf5b65ef3708e600ed4585df6"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead544010bf5b65ef3708e600ed4585df6">Ms::Sid::dontHideStavesInFirstSystem</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ad637cc26e200b7ed86f0419d3ce64f3a"><div class="ttname"><a href="classMs_1_1Score.html#ad637cc26e200b7ed86f0419d3ce64f3a">Ms::Score::styleP</a></div><div class="ttdeci">qreal styleP(Sid idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00896">score.h:896</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea7c57c1a271c9009fd6ca44f199ed31de"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea7c57c1a271c9009fd6ca44f199ed31de">Ms::Sid::minEmptyMeasures</a></div></div>
<div class="ttc" id="structMs_1_1Spring_html_a1cbc2c5ab8e76451bbcc84b0cdc94bd6"><div class="ttname"><a href="structMs_1_1Spring.html#a1cbc2c5ab8e76451bbcc84b0cdc94bd6">Ms::Spring::fix</a></div><div class="ttdeci">qreal fix</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01884">layout.cpp:1884</a></div></div>
<div class="ttc" id="segment_8h_html"><div class="ttname"><a href="segment_8h.html">segment.h</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a6802d9faa8168c8425b8dcb3d11d2edb"><div class="ttname"><a href="classMs_1_1ChordRest.html#a6802d9faa8168c8425b8dcb3d11d2edb">Ms::ChordRest::actualDurationType</a></div><div class="ttdeci">const TDuration actualDurationType() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00123">chordrest.h:123</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a78e0b4b578eafff2f44d0753e4d32f0b"><div class="ttname"><a href="classMs_1_1Measure.html#a78e0b4b578eafff2f44d0753e4d32f0b">Ms::Measure::undoGetSegmentR</a></div><div class="ttdeci">Segment * undoGetSegmentR(SegmentType st, const Fraction &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00796">measure.cpp:796</a></div></div>
<div class="ttc" id="classMs_1_1System_html_aa562355bd9ceb1065284da1e2a19cc9c"><div class="ttname"><a href="classMs_1_1System.html#aa562355bd9ceb1065284da1e2a19cc9c">Ms::System::hasFixedDownDistance</a></div><div class="ttdeci">bool hasFixedDownDistance() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00195">system.h:195</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_a11b6172fa0289a8eaad4b8f7b995f817"><div class="ttname"><a href="classMs_1_1MScore.html#a11b6172fa0289a8eaad4b8f7b995f817">Ms::MScore::division</a></div><div class="ttdeci">static int division</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00369">mscore.h:369</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a51fa420463d9aadfbdc0839fb781ff1e"><div class="ttname"><a href="classMs_1_1System.html#a51fa420463d9aadfbdc0839fb781ff1e">Ms::System::staff</a></div><div class="ttdeci">SysStaff * staff(int staffIdx) const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00148">system.h:148</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a5033ef29dffbf6e40958e4fdd2802b6d"><div class="ttname"><a href="classMs_1_1Element.html#a5033ef29dffbf6e40958e4fdd2802b6d">Ms::Element::setHeader</a></div><div class="ttdeci">void setHeader(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00439">element.h:439</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a630eb061f651b37400274e180f12cc62"><div class="ttname"><a href="classMs_1_1System.html#a630eb061f651b37400274e180f12cc62">Ms::System::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clear measure list. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00114">system.cpp:114</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ae550ee02f05637cd42d972c95bb6985d"><div class="ttname"><a href="classMs_1_1Score.html#ae550ee02f05637cd42d972c95bb6985d">Ms::Score::systems</a></div><div class="ttdeci">const QList&lt; System * &gt; &amp; systems() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01015">score.h:1015</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a688dc7a975a470846cf6ca71d2628af9"><div class="ttname"><a href="classMs_1_1ChordRest.html#a688dc7a975a470846cf6ca71d2628af9">Ms::ChordRest::replaceBeam</a></div><div class="ttdeci">void replaceBeam(Beam *newBeam)</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8cpp_source.html#l00814">chordrest.cpp:814</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a60dda023bb2ac14cc6625ab7b5d711b7"><div class="ttname"><a href="classMs_1_1Chord.html#a60dda023bb2ac14cc6625ab7b5d711b7">Ms::Chord::graceNotes</a></div><div class="ttdeci">const QVector&lt; Chord * &gt; &amp; graceNotes() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00148">chord.h:148</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a9a782ad57ba6f6f813a9caff2992df92"><div class="ttname"><a href="classMs_1_1Score.html#a9a782ad57ba6f6f813a9caff2992df92">Ms::Score::last</a></div><div class="ttdeci">MeasureBase * last() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00372">measurebase.cpp:372</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html"><div class="ttname"><a href="classMs_1_1Beam.html">Ms::Beam</a></div><div class="ttdef"><b>Definition:</b> <a href="beam_8h_source.html#l00037">beam.h:37</a></div></div>
<div class="ttc" id="classMs_1_1ScoreElement_html_a3d5c97191484848b3f10e754246f8758"><div class="ttname"><a href="classMs_1_1ScoreElement.html#a3d5c97191484848b3f10e754246f8758">Ms::ScoreElement::links</a></div><div class="ttdeci">LinkedElements * links() const</div><div class="ttdef"><b>Definition:</b> <a href="scoreElement_8h_source.html#l00248">scoreElement.h:248</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eac694e96ba92f954edbc6a0c810e98aff"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eac694e96ba92f954edbc6a0c810e98aff">Ms::Sid::dotNoteDistance</a></div></div>
<div class="ttc" id="classMs_1_1Slur_html"><div class="ttname"><a href="classMs_1_1Slur.html">Ms::Slur</a></div><div class="ttdef"><b>Definition:</b> <a href="slur_8h_source.html#l00054">slur.h:54</a></div></div>
<div class="ttc" id="classMs_1_1Part_html"><div class="ttname"><a href="classMs_1_1Part.html">Ms::Part</a></div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2part_8h_source.html#l00055">part.h:55</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a015e1e0a27a32eef6070e3fc45a682fe"><div class="ttname"><a href="classMs_1_1Note.html#a015e1e0a27a32eef6070e3fc45a682fe">Ms::Note::mirror</a></div><div class="ttdeci">bool mirror() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00409">note.h:409</a></div></div>
<div class="ttc" id="classMs_1_1DurationElement_html_abd480ba4d052d040db56e1e504cf2596"><div class="ttname"><a href="classMs_1_1DurationElement.html#abd480ba4d052d040db56e1e504cf2596">Ms::DurationElement::ticks</a></div><div class="ttdeci">virtual Fraction ticks() const</div><div class="ttdef"><b>Definition:</b> <a href="duration_8h_source.html#l00057">duration.h:57</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a146014b5067b0027c6163b3d2e5d8b07"><div class="ttname"><a href="classMs_1_1System.html#a146014b5067b0027c6163b3d2e5d8b07">Ms::System::spannerSegments</a></div><div class="ttdeci">QList&lt; SpannerSegment * &gt; &amp; spannerSegments()</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00176">system.h:176</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_aca131f1f53787e9bfa4fa5e3b564e7de"><div class="ttname"><a href="classMs_1_1MScore.html#aca131f1f53787e9bfa4fa5e3b564e7de">Ms::MScore::verticalOrientation</a></div><div class="ttdeci">static bool verticalOrientation()</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00332">mscore.h:332</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ac7157fd475a0865b1b319270eff75571"><div class="ttname"><a href="classMs_1_1Score.html#ac7157fd475a0865b1b319270eff75571">Ms::Score::setSelectionChanged</a></div><div class="ttdeci">void setSelectionChanged(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00780">score.h:780</a></div></div>
<div class="ttc" id="hook_8h_html"><div class="ttname"><a href="hook_8h.html">hook.h</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea45c529cd6bc7ad4c83459ff564827d1b"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea45c529cd6bc7ad4c83459ff564827d1b">Ms::Sid::maxSystemSpread</a></div></div>
<div class="ttc" id="classMs_1_1Skyline_html_aeb121365aa19908fc8a2f00c6c593078"><div class="ttname"><a href="classMs_1_1Skyline.html#aeb121365aa19908fc8a2f00c6c593078">Ms::Skyline::add</a></div><div class="ttdeci">void add(const Shape &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="skyline_8cpp_source.html#l00098">skyline.cpp:98</a></div></div>
<div class="ttc" id="sym_8h_html"><div class="ttname"><a href="sym_8h.html">sym.h</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_afe37fe95797d678dcc2fe87714970c70"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#afe37fe95797d678dcc2fe87714970c70">Ms::VerticalGapData::addFillSpacing</a></div><div class="ttdeci">qreal addFillSpacing(qreal step, qreal maxFill)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05266">layout.cpp:5266</a></div></div>
<div class="ttc" id="classMs_1_1Tuplet_html_a4926540c91f806d69f5b56be91301c7c"><div class="ttname"><a href="classMs_1_1Tuplet.html#a4926540c91f806d69f5b56be91301c7c">Ms::Tuplet::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="tuplet_8cpp_source.html#l00167">tuplet.cpp:167</a></div></div>
<div class="ttc" id="namespaceMs_html_af1c6d5c887f8bc4c394e7050f483914fa1e23852820b9154316c7c06e2b7ba051"><div class="ttname"><a href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914fa1e23852820b9154316c7c06e2b7ba051">Ms::BarLineType::NORMAL</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_a7952d1966f3d3b451d8d796a6958a5c3"><div class="ttname"><a href="classMs_1_1Beam.html#a7952d1966f3d3b451d8d796a6958a5c3">Ms::Beam::layoutGraceNotes</a></div><div class="ttdeci">void layoutGraceNotes()</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00449">beam.cpp:449</a></div></div>
<div class="ttc" id="namespaceMs_html_af1c6d5c887f8bc4c394e7050f483914f"><div class="ttname"><a href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914f">Ms::BarLineType</a></div><div class="ttdeci">BarLineType</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00195">mscore.h:195</a></div></div>
<div class="ttc" id="classMs_1_1ChangeMMRest_html"><div class="ttname"><a href="classMs_1_1ChangeMMRest.html">Ms::ChangeMMRest</a></div><div class="ttdef"><b>Definition:</b> <a href="undo_8h_source.html#l01190">undo.h:1190</a></div></div>
<div class="ttc" id="namespaceMs_html_ab2880482092ea87b3762323df0b8f124"><div class="ttname"><a href="namespaceMs.html#ab2880482092ea87b3762323df0b8f124">Ms::findLyricsMaxY</a></div><div class="ttdeci">static qreal findLyricsMaxY(Segment &amp;s, int staffIdx)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03209">layout.cpp:3209</a></div></div>
<div class="ttc" id="keysig_8h_html"><div class="ttname"><a href="keysig_8h.html">keysig.h</a></div></div>
<div class="ttc" id="namespaceMs_html_aa80fcdcc05a733b5f5503f5ebac3913e"><div class="ttname"><a href="namespaceMs.html#aa80fcdcc05a733b5f5503f5ebac3913e">Ms::breakCrossMeasureBeams</a></div><div class="ttdeci">static void breakCrossMeasureBeams(Measure *measure)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02721">layout.cpp:2721</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aedba86af30a033adef26958d92990e67"><div class="ttname"><a href="classMs_1_1Measure.html#aedba86af30a033adef26958d92990e67">Ms::Measure::layout2</a></div><div class="ttdeci">void layout2()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00654">measure.cpp:654</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a6a063f005375c9b61c53cf49ebc14623"><div class="ttname"><a href="classMs_1_1Element.html#a6a063f005375c9b61c53cf49ebc14623">Ms::Element::rxpos</a></div><div class="ttdeci">qreal &amp; rxpos()</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00249">element.h:249</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a8f60347a3bda60cf2db952b9dc6332ab"><div class="ttname"><a href="classMs_1_1Element.html#a8f60347a3bda60cf2db952b9dc6332ab">Ms::Element::ryoffset</a></div><div class="ttdeci">qreal &amp; ryoffset()</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00266">element.h:266</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a951493711a51487f7f3c1786703b1a20"><div class="ttname"><a href="classMs_1_1Element.html#a951493711a51487f7f3c1786703b1a20">Ms::Element::placement</a></div><div class="ttdeci">Placement placement() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00228">element.h:228</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a2504e5f861dd1f31323c9da26a3234c8"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a2504e5f861dd1f31323c9da26a3234c8">Ms::VerticalGapData::addSpaceAroundCurlyBracket</a></div><div class="ttdeci">void addSpaceAroundCurlyBracket()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05179">layout.cpp:5179</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894">Ms::SegmentType</a></div><div class="ttdeci">SegmentType</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00436">types.h:436</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894aa82364cc325a1dcba2361dbc4531c0ac"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894aa82364cc325a1dcba2361dbc4531c0ac">Ms::SegmentType::BarLine</a></div></div>
<div class="ttc" id="classMs_1_1ScoreFont_html_a3961745e9d8ad69188ec511dc7f9b21f"><div class="ttname"><a href="classMs_1_1ScoreFont.html#a3961745e9d8ad69188ec511dc7f9b21f">Ms::ScoreFont::fontFactory</a></div><div class="ttdeci">static ScoreFont * fontFactory(QString)</div><div class="ttdef"><b>Definition:</b> <a href="sym_8cpp_source.html#l06689">sym.cpp:6689</a></div></div>
<div class="ttc" id="classMs_1_1SkylineLine_html_a770f1e2838daffe1f51ecfac9ed938f5"><div class="ttname"><a href="classMs_1_1SkylineLine.html#a770f1e2838daffe1f51ecfac9ed938f5">Ms::SkylineLine::add</a></div><div class="ttdeci">void add(const Shape &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="skyline_8cpp_source.html#l00084">skyline.cpp:84</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a0169fb17fae5207d537cb8f2c3a3951f"><div class="ttname"><a href="classMs_1_1Score.html#a0169fb17fae5207d537cb8f2c3a3951f">Ms::Score::_layoutMode</a></div><div class="ttdeci">LayoutMode _layoutMode</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00562">score.h:562</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_acd8aacbbce632709b24bc9554ffe976a"><div class="ttname"><a href="structMs_1_1LayoutContext.html#acd8aacbbce632709b24bc9554ffe976a">Ms::LayoutContext::processedSpanners</a></div><div class="ttdeci">std::set&lt; Spanner * &gt; processedSpanners</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00089">layout.h:89</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a74b58efcee9d2b1868643982f5152c70">Ms::SegmentType::StartRepeatBarLine</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a2aaffc490540f2744696b3ffda1fd66a"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a2aaffc490540f2744696b3ffda1fd66a">Ms::MeasureBase::setNo</a></div><div class="ttdeci">void setNo(int n)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00145">measurebase.h:145</a></div></div>
<div class="ttc" id="classMs_1_1Ambitus_html_a742733b3bbe922ee6ef0563aab3723a4"><div class="ttname"><a href="classMs_1_1Ambitus.html#a742733b3bbe922ee6ef0563aab3723a4">Ms::Ambitus::clone</a></div><div class="ttdeci">Ambitus * clone() const override</div><div class="ttdef"><b>Definition:</b> <a href="ambitus_8h_source.html#l00047">ambitus.h:47</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eae2fec131897c443768056e19b2fe6899"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eae2fec131897c443768056e19b2fe6899">Ms::Sid::hideEmptyStaves</a></div></div>
<div class="ttc" id="namespaceMs_html_a0170d0c2acdf047caab45053aec53588"><div class="ttname"><a href="namespaceMs.html#a0170d0c2acdf047caab45053aec53588">Ms::toMeasureBase</a></div><div class="ttdeci">static const MeasureBase * toMeasureBase(const ScoreElement *e)</div><div class="ttdef"><b>Definition:</b> <a href="scoreElement_8h_source.html#l00463">scoreElement.h:463</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a697017a2b8bc5e08c40c79579c4f9826"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a697017a2b8bc5e08c40c79579c4f9826">Ms::MeasureBase::setRepeatStart</a></div><div class="ttdeci">void setRepeatStart(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00153">measurebase.h:153</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ad4153b0dbfe2fb2a229fd93a45c71f7b"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ad4153b0dbfe2fb2a229fd93a45c71f7b">Ms::MeasureBase::lineBreak</a></div><div class="ttdeci">bool lineBreak() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00161">measurebase.h:161</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a30c056051bbce9e867a512b8cbc1f912"><div class="ttname"><a href="classMs_1_1Element.html#a30c056051bbce9e867a512b8cbc1f912">Ms::Element::y</a></div><div class="ttdeci">virtual qreal y() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00245">element.h:245</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_ae0e98f18c6aade818eb0c8594cebc69c"><div class="ttname"><a href="structMs_1_1LayoutContext.html#ae0e98f18c6aade818eb0c8594cebc69c">Ms::LayoutContext::adjustMeasureNo</a></div><div class="ttdeci">int adjustMeasureNo(MeasureBase *)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02509">layout.cpp:2509</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a8f87ff99331819e91eea762687ef8950"><div class="ttname"><a href="classMs_1_1ChordRest.html#a8f87ff99331819e91eea762687ef8950">Ms::ChordRest::removeDeleteBeam</a></div><div class="ttdeci">void removeDeleteBeam(bool beamed)</div><div class="ttdoc">Remove ChordRest from beam, delete beam if empty. </div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8cpp_source.html#l00796">chordrest.cpp:796</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a0fd80339f7fe2ce2a9dedae21188821d"><div class="ttname"><a href="classMs_1_1Note.html#a0fd80339f7fe2ce2a9dedae21188821d">Ms::Note::setMirror</a></div><div class="ttdeci">void setMirror(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00410">note.h:410</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a979df7753ae3d039720198643f865f56"><div class="ttname"><a href="classMs_1_1Measure.html#a979df7753ae3d039720198643f865f56">Ms::Measure::stretchMeasure</a></div><div class="ttdeci">void stretchMeasure(qreal stretch)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l03462">measure.cpp:3462</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a4c0205b5940976cc9f7cb9eb543fbc08"><div class="ttname"><a href="classMs_1_1ChordRest.html#a4c0205b5940976cc9f7cb9eb543fbc08">Ms::ChordRest::durationType</a></div><div class="ttdeci">const TDuration durationType() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00120">chordrest.h:120</a></div></div>
<div class="ttc" id="classMs_1_1Lyrics_html"><div class="ttname"><a href="classMs_1_1Lyrics.html">Ms::Lyrics</a></div><div class="ttdef"><b>Definition:</b> <a href="lyrics_8h_source.html#l00027">lyrics.h:27</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a9f375d79304c4cec5b45ea883c9efc86"><div class="ttname"><a href="classMs_1_1Element.html#a9f375d79304c4cec5b45ea883c9efc86">Ms::Element::spatium</a></div><div class="ttdeci">qreal spatium() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00132">element.cpp:132</a></div></div>
<div class="ttc" id="mscore_8h_html_a7b14c16d0b45fd100ee97e74cfd907c0"><div class="ttname"><a href="mscore_8h.html#a7b14c16d0b45fd100ee97e74cfd907c0">VOICES</a></div><div class="ttdeci">#define VOICES</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00074">mscore.h:74</a></div></div>
<div class="ttc" id="hairpin_8h_html"><div class="ttname"><a href="hairpin_8h.html">hairpin.h</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_abb1a21e5e71cfac9a4591d006ec66462"><div class="ttname"><a href="structMs_1_1AcEl.html#abb1a21e5e71cfac9a4591d006ec66462">Ms::AcEl::descent</a></div><div class="ttdeci">qreal descent</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00686">layout.cpp:686</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a86bcbc446dea8eeec80bd81505fd77bd"><div class="ttname"><a href="classMs_1_1Chord.html#a86bcbc446dea8eeec80bd81505fd77bd">Ms::Chord::setTremolo</a></div><div class="ttdeci">void setTremolo(Tremolo *t)</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00456">chord.cpp:456</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_afd4b28e5752dc085c8e0e4203631a1c0"><div class="ttname"><a href="classMs_1_1Score.html#afd4b28e5752dc085c8e0e4203631a1c0">Ms::Score::loWidth</a></div><div class="ttdeci">qreal loWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l03678">score.cpp:3678</a></div></div>
<div class="ttc" id="classMs_1_1Fraction_html_a1d92a73ce7f9b7f895a9a083f6fe1eb2"><div class="ttname"><a href="classMs_1_1Fraction.html#a1d92a73ce7f9b7f895a9a083f6fe1eb2">Ms::Fraction::ticks</a></div><div class="ttdeci">int ticks() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2fraction_8h_source.html#l00238">fraction.h:238</a></div></div>
<div class="ttc" id="classMs_1_1Tuplet_html"><div class="ttname"><a href="classMs_1_1Tuplet.html">Ms::Tuplet</a></div><div class="ttdoc">Example of 1/8 triplet: _baseLen = 1/8 (tuplet is measured in eighth notes) _ratio = 3/2 (3 eighth tu...</div><div class="ttdef"><b>Definition:</b> <a href="tuplet_8h_source.html#l00036">tuplet.h:36</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ab75c49bf26fcb549bd1959ffe7925d8b"><div class="ttname"><a href="classMs_1_1Element.html#ab75c49bf26fcb549bd1959ffe7925d8b">Ms::Element::setEnabled</a></div><div class="ttdeci">void setEnabled(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00456">element.h:456</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_accf66d981db70ac1bd843ca5e03330a1"><div class="ttname"><a href="classMs_1_1Segment.html#accf66d981db70ac1bd843ca5e03330a1">Ms::Segment::segmentType</a></div><div class="ttdeci">static SegmentType segmentType(ElementType type)</div><div class="ttdef"><b>Definition:</b> <a href="segment_8cpp_source.html#l00749">segment.cpp:749</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a9adaf3b1b191b949ca562d891c4c5a49"><div class="ttname"><a href="classMs_1_1Segment.html#a9adaf3b1b191b949ca562d891c4c5a49">Ms::Segment::cr</a></div><div class="ttdeci">ChordRest * cr(int track) const</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00233">segment.h:233</a></div></div>
<div class="ttc" id="classMs_1_1MMRestRange_html"><div class="ttname"><a href="classMs_1_1MMRestRange.html">Ms::MMRestRange</a></div><div class="ttdef"><b>Definition:</b> <a href="mmrestrange_8h_source.html#l00032">mmrestrange.h:32</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapDataList_html"><div class="ttname"><a href="classMs_1_1VerticalGapDataList.html">Ms::VerticalGapDataList</a></div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00067">layout.h:67</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_a7e98943cb86fb69bc5e59024f3d880fd"><div class="ttname"><a href="classMs_1_1Tremolo.html#a7e98943cb86fb69bc5e59024f3d880fd">Ms::Tremolo::twoNotes</a></div><div class="ttdeci">bool twoNotes() const</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00095">tremolo.h:95</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a6ba0ad4dad0b5de65db725a10fc64278"><div class="ttname"><a href="classMs_1_1Element.html#a6ba0ad4dad0b5de65db725a10fc64278">Ms::Element::addToSkyline</a></div><div class="ttdeci">bool addToSkyline() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00463">element.h:463</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a136eb39ecfa4096dc41df49e135a5ce7"><div class="ttname"><a href="classMs_1_1Chord.html#a136eb39ecfa4096dc41df49e135a5ce7">Ms::Chord::graceNotesBefore</a></div><div class="ttdeci">QVector&lt; Chord * &gt; graceNotesBefore() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l03017">chord.cpp:3017</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a3d4e16cf0a0fcc9351b006fdb05d00c9"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a3d4e16cf0a0fcc9351b006fdb05d00c9">Ms::VerticalGapData::isFixedHeight</a></div><div class="ttdeci">bool isFixedHeight() const</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05247">layout.cpp:5247</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_a48f845d7303e0445e4d9bb220873accc"><div class="ttname"><a href="classMs_1_1TimeSig.html#a48f845d7303e0445e4d9bb220873accc">Ms::TimeSig::stretch</a></div><div class="ttdeci">Fraction stretch() const</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8h_source.html#l00089">timesig.h:89</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a405ecf7ac85a17e4285644b04a8085d0"><div class="ttname"><a href="classMs_1_1Measure.html#a405ecf7ac85a17e4285644b04a8085d0">Ms::Measure::setMMRestCount</a></div><div class="ttdeci">void setMMRestCount(int n)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00257">measure.h:257</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ae8a8d5cae3cb7386cd6012953ab92573"><div class="ttname"><a href="classMs_1_1Measure.html#ae8a8d5cae3cb7386cd6012953ab92573">Ms::Measure::noText</a></div><div class="ttdeci">MeasureNumber * noText(int staffIdx) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00318">measure.cpp:318</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a1564e474208b08b6bdb6cb0ffce38b08"><div class="ttname"><a href="classMs_1_1ChordRest.html#a1564e474208b08b6bdb6cb0ffce38b08">Ms::ChordRest::crossMeasureDurationType</a></div><div class="ttdeci">TDuration crossMeasureDurationType() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00157">chordrest.h:157</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_a992a7da1c28a530754bfa2cf5cde85a1"><div class="ttname"><a href="classMs_1_1Beam.html#a992a7da1c28a530754bfa2cf5cde85a1">Ms::Beam::add</a></div><div class="ttdeci">void add(Element *) override</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00152">beam.cpp:152</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a693ed2bc02f09dc0fff3f6731dfa3e98"><div class="ttname"><a href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98">Ms::Staff::HideMode</a></div><div class="ttdeci">HideMode</div><div class="ttdef"><b>Definition:</b> <a href="staff_8h_source.html#l00065">staff.h:65</a></div></div>
<div class="ttc" id="classMs_1_1Ambitus_html_a48ca0c7673fd47eb158ac88ba65d663d"><div class="ttname"><a href="classMs_1_1Ambitus.html#a48ca0c7673fd47eb158ac88ba65d663d">Ms::Ambitus::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="ambitus_8cpp_source.html#l00290">ambitus.cpp:290</a></div></div>
<div class="ttc" id="classMs_1_1FretDiagram_html"><div class="ttname"><a href="classMs_1_1FretDiagram.html">Ms::FretDiagram</a></div><div class="ttdoc">Fretboard diagram. </div><div class="ttdef"><b>Definition:</b> <a href="fret_8h_source.html#l00127">fret.h:127</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapDataList_html_ad0221acb745b4c68868ce307c8070732"><div class="ttname"><a href="classMs_1_1VerticalGapDataList.html#ad0221acb745b4c68868ce307c8070732">Ms::VerticalGapDataList::sumStretchFactor</a></div><div class="ttdeci">qreal sumStretchFactor() const</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05287">layout.cpp:5287</a></div></div>
<div class="ttc" id="classMs_1_1Part_html_aa11473b705e1917640e87bba141cdee4"><div class="ttname"><a href="classMs_1_1Part.html#aa11473b705e1917640e87bba141cdee4">Ms::Part::staves</a></div><div class="ttdeci">QList&lt; Staff * &gt; * staves()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2part_8h_source.html#l00079">part.h:79</a></div></div>
<div class="ttc" id="classMs_1_1AccidentalState_html"><div class="ttname"><a href="classMs_1_1AccidentalState.html">Ms::AccidentalState</a></div><div class="ttdef"><b>Definition:</b> <a href="key_8h_source.html#l00137">key.h:137</a></div></div>
<div class="ttc" id="structMs_1_1Spring_html"><div class="ttname"><a href="structMs_1_1Spring.html">Ms::Spring</a></div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01881">layout.cpp:1881</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a984c5f0381896ac71fcf054d056bbe66"><div class="ttname"><a href="classMs_1_1Element.html#a984c5f0381896ac71fcf054d056bbe66">Ms::Element::symCutOutNE</a></div><div class="ttdeci">QPointF symCutOutNE(SymId id) const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l01641">element.cpp:1641</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_abcffe190c5e3a72320316d1c8e05700a"><div class="ttname"><a href="classMs_1_1Tremolo.html#abcffe190c5e3a72320316d1c8e05700a">Ms::Tremolo::chord2</a></div><div class="ttdeci">Chord * chord2() const</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00084">tremolo.h:84</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a35ebcb1cff57477d55fc1dc9bc8508c0"><div class="ttname"><a href="classMs_1_1Score.html#a35ebcb1cff57477d55fc1dc9bc8508c0">Ms::Score::setNoteHeadWidth</a></div><div class="ttdeci">void setNoteHeadWidth(qreal n)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01164">score.h:1164</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a238e845d7b6a1e04230d35934cd00a74"><div class="ttname"><a href="classMs_1_1Score.html#a238e845d7b6a1e04230d35934cd00a74">Ms::Score::createPlayEvents</a></div><div class="ttdeci">void createPlayEvents(Chord *)</div><div class="ttdef"><b>Definition:</b> <a href="rendermidi_8cpp_source.html#l02168">rendermidi.cpp:2168</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ac8216e757cdc34ebc9a840900e040edf"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ac8216e757cdc34ebc9a840900e040edf">Ms::MeasureBase::noBreak</a></div><div class="ttdeci">bool noBreak() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00170">measurebase.h:170</a></div></div>
<div class="ttc" id="namespaceMs_html_a4ddd02afd2f797a6a269ddce7466a4d6ae1f2d5134ed2543d38a0de9751cf75d9"><div class="ttname"><a href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6ae1f2d5134ed2543d38a0de9751cf75d9">Ms::Direction::AUTO</a></div></div>
<div class="ttc" id="classMs_1_1TDuration_html_ad9263bf173856b77421e83a48a7bf68ca05e8f1c139e16d278117c17e7fc13ef6"><div class="ttname"><a href="classMs_1_1TDuration.html#ad9263bf173856b77421e83a48a7bf68ca05e8f1c139e16d278117c17e7fc13ef6">Ms::TDuration::DurationType::V_QUARTER</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_ae890234f0152fc2af7ec392c5ce0abf2"><div class="ttname"><a href="classMs_1_1TimeSig.html#ae890234f0152fc2af7ec392c5ce0abf2">Ms::TimeSig::clone</a></div><div class="ttdeci">TimeSig * clone() const override</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8h_source.html#l00069">timesig.h:69</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_ac53ba577f2fb5d2c0884a0d02c628a48"><div class="ttname"><a href="structMs_1_1LayoutContext.html#ac53ba577f2fb5d2c0884a0d02c628a48">Ms::LayoutContext::getNextPage</a></div><div class="ttdeci">void getNextPage()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01986">layout.cpp:1986</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_ad1a47117e08b36e435b627bde7861886"><div class="ttname"><a href="classMs_1_1ChordRest.html#ad1a47117e08b36e435b627bde7861886">Ms::ChordRest::setCrossMeasureDurationType</a></div><div class="ttdeci">void setCrossMeasureDurationType(TDuration v)</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00158">chordrest.h:158</a></div></div>
<div class="ttc" id="classMs_1_1Selection_html_a4e5346c014b21425ba2ef41c0274930b"><div class="ttname"><a href="classMs_1_1Selection.html#a4e5346c014b21425ba2ef41c0274930b">Ms::Selection::remove</a></div><div class="ttdeci">void remove(Element *)</div><div class="ttdef"><b>Definition:</b> <a href="select_8cpp_source.html#l00359">select.cpp:359</a></div></div>
<div class="ttc" id="classMs_1_1Skyline_html_a3c189e0748d2d449f71a264e284ab21b"><div class="ttname"><a href="classMs_1_1Skyline.html#a3c189e0748d2d449f71a264e284ab21b">Ms::Skyline::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="skyline_8cpp_source.html#l00194">skyline.cpp:194</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a83b52654e7177b6ab649f8da843f28a5"><div class="ttname"><a href="classMs_1_1Chord.html#a83b52654e7177b6ab649f8da843f28a5">Ms::Chord::layoutArpeggio2</a></div><div class="ttdeci">void layoutArpeggio2()</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l02534">chord.cpp:2534</a></div></div>
<div class="ttc" id="box_8h_html"><div class="ttname"><a href="box_8h.html">box.h</a></div><div class="ttdoc">Definition of HBox and VBox classes. </div></div>
<div class="ttc" id="classMs_1_1Beam_html_ad4f30020049f6fba843ecfcdd53ba269"><div class="ttname"><a href="classMs_1_1Beam.html#ad4f30020049f6fba843ecfcdd53ba269">Ms::Beam::cross</a></div><div class="ttdeci">bool cross() const</div><div class="ttdef"><b>Definition:</b> <a href="beam_8h_source.html#l00154">beam.h:154</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_a0df5f1a470654ab4cd89e148f2d6f14f"><div class="ttname"><a href="classMs_1_1MScore.html#a0df5f1a470654ab4cd89e148f2d6f14f">Ms::MScore::noHorizontalStretch</a></div><div class="ttdeci">static bool noHorizontalStretch</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00356">mscore.h:356</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a50e6e934be473faa8cc345e9d66b1a7a"><div class="ttname"><a href="classMs_1_1Score.html#a50e6e934be473faa8cc345e9d66b1a7a">Ms::Score::doLayout</a></div><div class="ttdeci">void doLayout()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04865">layout.cpp:4865</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a87f96d1fa43004af6444997951f70a6e"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a87f96d1fa43004af6444997951f70a6e">Ms::MeasureBase::setLineBreak</a></div><div class="ttdeci">void setLineBreak(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00162">measurebase.h:162</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a844c77bb4dd38e718c5d9a4cf2464d5d"><div class="ttname"><a href="classMs_1_1Staff.html#a844c77bb4dd38e718c5d9a4cf2464d5d">Ms::Staff::isTop</a></div><div class="ttdeci">bool isTop() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01323">staff.cpp:1323</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a04a1b9c2e9db98787c7d81aff906b336"><div class="ttname"><a href="classMs_1_1Chord.html#a04a1b9c2e9db98787c7d81aff906b336">Ms::Chord::tremolo</a></div><div class="ttdeci">Tremolo * tremolo() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00138">chord.h:138</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a4d110ef401e1ecf0338442919917224d"><div class="ttname"><a href="classMs_1_1Chord.html#a4d110ef401e1ecf0338442919917224d">Ms::Chord::layoutSpanners</a></div><div class="ttdeci">void layoutSpanners()</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l02580">chord.cpp:2580</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a9109c2c9621f0cc9ecd86afcae54afe8"><div class="ttname"><a href="classMs_1_1Measure.html#a9109c2c9621f0cc9ecd86afcae54afe8">Ms::Measure::mmRest</a></div><div class="ttdeci">Measure * mmRest() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00253">measure.h:253</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894a99d2eb8b30f0aa252f5382705006fa78"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a99d2eb8b30f0aa252f5382705006fa78">Ms::SegmentType::BeginBarLine</a></div></div>
<div class="ttc" id="classMs_1_1MeasureNumber_html"><div class="ttname"><a href="classMs_1_1MeasureNumber.html">Ms::MeasureNumber</a></div><div class="ttdef"><b>Definition:</b> <a href="measurenumber_8h_source.html#l00031">measurenumber.h:31</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a52b30fdd589beba5b760a561a50ac601"><div class="ttname"><a href="classMs_1_1Element.html#a52b30fdd589beba5b760a561a50ac601">Ms::Element::parent</a></div><div class="ttdeci">Element * parent() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00199">element.h:199</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea8a31b7c8a80a77c6c9c5aaad9e2e1e68"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea8a31b7c8a80a77c6c9c5aaad9e2e1e68">Ms::Sid::stemWidth</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_a068df0bd57e559772d9689106088771d"><div class="ttname"><a href="structMs_1_1AcEl.html#a068df0bd57e559772d9689106088771d">Ms::AcEl::leftClear</a></div><div class="ttdeci">qreal leftClear</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00688">layout.cpp:688</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a2f11c692c3cd0e6698fe2f83b11d2746"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a2f11c692c3cd0e6698fe2f83b11d2746">Ms::MeasureBase::next</a></div><div class="ttdeci">MeasureBase * next() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00085">measurebase.h:85</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a0c223da39c9d643f45912fae4e78f17e"><div class="ttname"><a href="classMs_1_1Score.html#a0c223da39c9d643f45912fae4e78f17e">Ms::Score::layoutChords3</a></div><div class="ttdeci">void layoutChords3(std::vector&lt; Note *&gt; &amp;, const Staff *, Segment *)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00847">layout.cpp:847</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_ad3e47f24d3c77f2bfd4e8e03f85d6124"><div class="ttname"><a href="structMs_1_1LayoutContext.html#ad3e47f24d3c77f2bfd4e8e03f85d6124">Ms::LayoutContext::firstSystem</a></div><div class="ttdeci">bool firstSystem</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00082">layout.h:82</a></div></div>
<div class="ttc" id="namespaceMs_html_a39873f2b64993a8c6b6754e3a78a4bf1"><div class="ttname"><a href="namespaceMs.html#a39873f2b64993a8c6b6754e3a78a4bf1">Ms::alignHarmonies</a></div><div class="ttdeci">void alignHarmonies(const System *system, const std::vector&lt; Segment *&gt; &amp;sl, bool harmony, const qreal maxShiftAbove, const qreal maxShiftBelow)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03550">layout.cpp:3550</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_adf5c9dc552745c05fda274364a894881"><div class="ttname"><a href="classMs_1_1TimeSig.html#adf5c9dc552745c05fda274364a894881">Ms::TimeSig::sig</a></div><div class="ttdeci">Fraction sig() const</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8h_source.html#l00084">timesig.h:84</a></div></div>
<div class="ttc" id="classMs_1_1Fraction_html"><div class="ttname"><a href="classMs_1_1Fraction.html">Ms::Fraction</a></div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2fraction_8h_source.html#l00046">fraction.h:46</a></div></div>
<div class="ttc" id="classMs_1_1Glissando_html_a19066d9818980d4177b724e54df62047"><div class="ttname"><a href="classMs_1_1Glissando.html#a19066d9818980d4177b724e54df62047">Ms::Glissando::guessInitialNote</a></div><div class="ttdeci">static Note * guessInitialNote(Chord *chord)</div><div class="ttdef"><b>Definition:</b> <a href="glissando_8cpp_source.html#l00456">glissando.cpp:456</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a436845d5d0032348dfe5f9618d12cb0c"><div class="ttname"><a href="classMs_1_1System.html#a436845d5d0032348dfe5f9618d12cb0c">Ms::System::staves</a></div><div class="ttdeci">QList&lt; SysStaff * &gt; * staves()</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00144">system.h:144</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a7884fad7b22d960efd4e9d84e61e7fe0">Ms::SegmentType::ChordRest</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a97575ef0255cb4b9cde48b6c8730a00f"><div class="ttname"><a href="classMs_1_1Note.html#a97575ef0255cb4b9cde48b6c8730a00f">Ms::Note::removeSpannerBack</a></div><div class="ttdeci">bool removeSpannerBack(Spanner *e)</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00490">note.h:490</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_ae9e872e395ceb99e383a6ef53ceb9848"><div class="ttname"><a href="classMs_1_1ChordRest.html#ae9e872e395ceb99e383a6ef53ceb9848">Ms::ChordRest::up</a></div><div class="ttdeci">bool up() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00108">chordrest.h:108</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a458e64e2a7ec6846e1f085dc843fa416"><div class="ttname"><a href="classMs_1_1Segment.html#a458e64e2a7ec6846e1f085dc843fa416">Ms::Segment::setRtick</a></div><div class="ttdeci">void setRtick(const Fraction &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00161">segment.h:161</a></div></div>
<div class="ttc" id="classMs_1_1SkylineLine_html"><div class="ttname"><a href="classMs_1_1SkylineLine.html">Ms::SkylineLine</a></div><div class="ttdef"><b>Definition:</b> <a href="skyline_8h_source.html#l00041">skyline.h:41</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a9c4de13b592b3e0cc6a2398641da99ed"><div class="ttname"><a href="classMs_1_1Measure.html#a9c4de13b592b3e0cc6a2398641da99ed">Ms::Measure::system</a></div><div class="ttdeci">System * system() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00120">measure.h:120</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a57af65dafb20c1282ea78ba3d74725a0"><div class="ttname"><a href="classMs_1_1System.html#a57af65dafb20c1282ea78ba3d74725a0">Ms::System::page</a></div><div class="ttdeci">Page * page() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00130">system.h:130</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a229ec32c64e743ef265e720ac0c44df3"><div class="ttname"><a href="classMs_1_1Score.html#a229ec32c64e743ef265e720ac0c44df3">Ms::Score::move</a></div><div class="ttdeci">Element * move(const QString &amp;cmd)</div><div class="ttdef"><b>Definition:</b> <a href="cmd_8cpp_source.html#l02275">cmd.cpp:2275</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a5c2da938ad615b8d3d2adccf77eb2059"><div class="ttname"><a href="classMs_1_1Measure.html#a5c2da938ad615b8d3d2adccf77eb2059">Ms::Measure::checkTrailer</a></div><div class="ttdeci">void checkTrailer()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l04351">measure.cpp:4351</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_a78e7202ffb38948cd251b6e86eab9ef1"><div class="ttname"><a href="classMs_1_1TimeSig.html#a78e7202ffb38948cd251b6e86eab9ef1">Ms::TimeSig::setSig</a></div><div class="ttdeci">void setSig(const Fraction &amp;f, TimeSigType st=TimeSigType::NORMAL)</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8cpp_source.html#l00064">timesig.cpp:64</a></div></div>
<div class="ttc" id="classMs_1_1MuseScoreView_html"><div class="ttname"><a href="classMs_1_1MuseScoreView.html">Ms::MuseScoreView</a></div><div class="ttdef"><b>Definition:</b> <a href="mscoreview_8h_source.html#l00032">mscoreview.h:32</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a34bb3c54117e0a1b7ca0c632c19a0bd7"><div class="ttname"><a href="classMs_1_1Chord.html#a34bb3c54117e0a1b7ca0c632c19a0bd7">Ms::Chord::downNote</a></div><div class="ttdeci">Note * downNote() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00106">chord.cpp:106</a></div></div>
<div class="ttc" id="classMs_1_1System_html_aaf529665602c113a229f81e888bdf06f"><div class="ttname"><a href="classMs_1_1System.html#aaf529665602c113a229f81e888bdf06f">Ms::System::remove</a></div><div class="ttdeci">void remove(Element *) override</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01101">system.cpp:1101</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a2c3bd9ec57fc55b441188dc2d6f21eea"><div class="ttname"><a href="classMs_1_1System.html#a2c3bd9ec57fc55b441188dc2d6f21eea">Ms::System::nextVisibleStaff</a></div><div class="ttdeci">int nextVisibleStaff(int) const</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00613">system.cpp:613</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_abb3880878a2f2826b253d5e0e14b32b6"><div class="ttname"><a href="classMs_1_1Element.html#abb3880878a2f2826b253d5e0e14b32b6">Ms::Element::header</a></div><div class="ttdeci">bool header() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00438">element.h:438</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aec5e17c92d990fc2b60e77225552fd1c"><div class="ttname"><a href="classMs_1_1Measure.html#aec5e17c92d990fc2b60e77225552fd1c">Ms::Measure::layoutWeight</a></div><div class="ttdeci">int layoutWeight(int maxMMRestLength=0) const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l03974">measure.cpp:3974</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_aadbf45e4cc8747dd4bbdf585c5fdddb7"><div class="ttname"><a href="classMs_1_1Chord.html#aadbf45e4cc8747dd4bbdf585c5fdddb7">Ms::Chord::stemPos</a></div><div class="ttdeci">QPointF stemPos() const override</div><div class="ttdoc">page coordinates </div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00393">chord.cpp:393</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a9263c16f6d004ee4fce1ae6633fd022d"><div class="ttname"><a href="classMs_1_1ChordRest.html#a9263c16f6d004ee4fce1ae6633fd022d">Ms::ChordRest::shape</a></div><div class="ttdeci">virtual Shape shape() const override</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8cpp_source.html#l01255">chordrest.cpp:1255</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a48d54ab45d94e4ef6a420f94d2612f18"><div class="ttname"><a href="classMs_1_1Score.html#a48d54ab45d94e4ef6a420f94d2612f18">Ms::Score::layoutMode</a></div><div class="ttdeci">LayoutMode layoutMode() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01112">score.h:1112</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a6a5f3aed4895d192dfe62c82bf654e12"><div class="ttname"><a href="classMs_1_1Score.html#a6a5f3aed4895d192dfe62c82bf654e12">Ms::Score::layoutLyrics</a></div><div class="ttdeci">void layoutLyrics(System *)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03386">layout.cpp:3386</a></div></div>
<div class="ttc" id="namespaceMs_html_a410467a129f146b200e237377e2a695c"><div class="ttname"><a href="namespaceMs.html#a410467a129f146b200e237377e2a695c">Ms::isTopBeam</a></div><div class="ttdeci">bool isTopBeam(ChordRest *cr)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03105">layout.cpp:3105</a></div></div>
<div class="ttc" id="classMs_1_1SysStaff_html_aee9868a0f2bc566af571f4fd377d6741"><div class="ttname"><a href="classMs_1_1SysStaff.html#aee9868a0f2bc566af571f4fd377d6741">Ms::SysStaff::y</a></div><div class="ttdeci">qreal y() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00063">system.h:63</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a0d7f809a91a9458cea81a2ab84f42532"><div class="ttname"><a href="classMs_1_1System.html#a0d7f809a91a9458cea81a2ab84f42532">Ms::System::appendMeasure</a></div><div class="ttdeci">void appendMeasure(MeasureBase *)</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00133">system.cpp:133</a></div></div>
<div class="ttc" id="namespaceMs_html_a1f1eab3fe8ae544f6c20be2d2a39582a"><div class="ttname"><a href="namespaceMs.html#a1f1eab3fe8ae544f6c20be2d2a39582a">Ms::toString</a></div><div class="ttdeci">const char * toString(Direction val)</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8cpp_source.html#l00181">mscore.cpp:181</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html_ad6858aab488742d20c542d35ac7bf7f1"><div class="ttname"><a href="classMs_1_1Spanner.html#ad6858aab488742d20c542d35ac7bf7f1">Ms::Spanner::endCR</a></div><div class="ttdeci">ChordRest * endCR()</div><div class="ttdef"><b>Definition:</b> <a href="spanner_8cpp_source.html#l00815">spanner.cpp:815</a></div></div>
<div class="ttc" id="classMs_1_1BarLine_html_a4a0426d2e0676bda9cca5f61388cbcf6"><div class="ttname"><a href="classMs_1_1BarLine.html#a4a0426d2e0676bda9cca5f61388cbcf6">Ms::BarLine::barLineType</a></div><div class="ttdeci">BarLineType barLineType() const</div><div class="ttdef"><b>Definition:</b> <a href="barline_8h_source.html#l00124">barline.h:124</a></div></div>
<div class="ttc" id="stafflines_8h_html"><div class="ttname"><a href="stafflines_8h.html">stafflines.h</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_aa7757f6d62dc28447706ee8eb12da5ec"><div class="ttname"><a href="classMs_1_1Element.html#aa7757f6d62dc28447706ee8eb12da5ec">Ms::Element::setParent</a></div><div class="ttdeci">void setParent(Element *e)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00200">element.h:200</a></div></div>
<div class="ttc" id="measure_8h_html"><div class="ttname"><a href="measure_8h.html">measure.h</a></div><div class="ttdoc">Definition of class Measure. </div></div>
<div class="ttc" id="structMs_1_1AcEl_html_a61d26cddad28aec211df72ceb32c19dd"><div class="ttname"><a href="structMs_1_1AcEl.html#a61d26cddad28aec211df72ceb32c19dd">Ms::AcEl::x</a></div><div class="ttdeci">qreal x</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00679">layout.cpp:679</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a9bdc2e024e29b58a2a25678a957782d5"><div class="ttname"><a href="classMs_1_1Note.html#a9bdc2e024e29b58a2a25678a957782d5">Ms::Note::setTieBack</a></div><div class="ttdeci">void setTieBack(Tie *t)</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00421">note.h:421</a></div></div>
<div class="ttc" id="classMs_1_1NoteHead_html_a31c343e7e7f09fee0246ef6a1d7a4e87a45b570219d7d4c6d4c05af96807c8d7a"><div class="ttname"><a href="classMs_1_1NoteHead.html#a31c343e7e7f09fee0246ef6a1d7a4e87a45b570219d7d4c6d4c05af96807c8d7a">Ms::NoteHead::Type::HEAD_AUTO</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a9103d7e3ecf91f604d7bfd8a529ef09d"><div class="ttname"><a href="classMs_1_1ChordRest.html#a9103d7e3ecf91f604d7bfd8a529ef09d">Ms::ChordRest::beamMode</a></div><div class="ttdeci">Beam::Mode beamMode() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00091">chordrest.h:91</a></div></div>
<div class="ttc" id="classMs_1_1Clef_html_aca48a453519341c23fd7394f0654738e"><div class="ttname"><a href="classMs_1_1Clef.html#aca48a453519341c23fd7394f0654738e">Ms::Clef::clone</a></div><div class="ttdeci">Clef * clone() const override</div><div class="ttdef"><b>Definition:</b> <a href="clef_8h_source.html#l00142">clef.h:142</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_af4bf38122d09df51e5ca36694c6aeeb5"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#af4bf38122d09df51e5ca36694c6aeeb5">Ms::VerticalGapData::sysStaff</a></div><div class="ttdeci">SysStaff * sysStaff</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00041">layout.h:41</a></div></div>
<div class="ttc" id="harmony_8h_html"><div class="ttname"><a href="harmony_8h.html">harmony.h</a></div></div>
<div class="ttc" id="classMs_1_1Rest_html"><div class="ttname"><a href="classMs_1_1Rest.html">Ms::Rest</a></div><div class="ttdoc">This class implements a rest. </div><div class="ttdef"><b>Definition:</b> <a href="rest_8h_source.html#l00029">rest.h:29</a></div></div>
<div class="ttc" id="namespaceMs_html_a105a71265c435455f12f9198895fb3ee"><div class="ttname"><a href="namespaceMs.html#a105a71265c435455f12f9198895fb3ee">Ms::breakMultiMeasureRest</a></div><div class="ttdeci">static bool breakMultiMeasureRest(Measure *m)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02417">layout.cpp:2417</a></div></div>
<div class="ttc" id="namespaceMs_html_a9b94748a1c466ed6e89f2c80e57b644b"><div class="ttname"><a href="namespaceMs.html#a9b94748a1c466ed6e89f2c80e57b644b">Ms::staff2track</a></div><div class="ttdeci">int staff2track(int staffIdx)</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00077">mscore.h:77</a></div></div>
<div class="ttc" id="classMs_1_1Skyline_html_a13325c30212ec913c5da8f9b7a5368a8"><div class="ttname"><a href="classMs_1_1Skyline.html#a13325c30212ec913c5da8f9b7a5368a8">Ms::Skyline::north</a></div><div class="ttdeci">SkylineLine &amp; north()</div><div class="ttdef"><b>Definition:</b> <a href="skyline_8h_source.html#l00088">skyline.h:88</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a6b28dcc84bca9dab3f01ee993d301285"><div class="ttname"><a href="classMs_1_1Score.html#a6b28dcc84bca9dab3f01ee993d301285">Ms::Score::scoreFont</a></div><div class="ttdeci">ScoreFont * scoreFont() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01160">score.h:1160</a></div></div>
<div class="ttc" id="classMs_1_1Stem_html_ab86a81e498e1f8cc1029b3e6160f717a"><div class="ttname"><a href="classMs_1_1Stem.html#ab86a81e498e1f8cc1029b3e6160f717a">Ms::Stem::p2</a></div><div class="ttdeci">QPointF p2() const</div><div class="ttdef"><b>Definition:</b> <a href="stem_8h_source.html#l00074">stem.h:74</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aec3ae8afe6d74337ccdaf50a735f4c92"><div class="ttname"><a href="classMs_1_1Score.html#aec3ae8afe6d74337ccdaf50a735f4c92">Ms::Score::spannerMap</a></div><div class="ttdeci">SpannerMap &amp; spannerMap()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01142">score.h:1142</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a74445d56eed54f6c4d22c5ba301a531f"><div class="ttname"><a href="classMs_1_1Staff.html#a74445d56eed54f6c4d22c5ba301a531f">Ms::Staff::lineDistance</a></div><div class="ttdeci">qreal lineDistance(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01554">staff.cpp:1554</a></div></div>
<div class="ttc" id="classMs_1_1Drumset_html_a0c116c7a1faa14e7d3f5b583561f5245"><div class="ttname"><a href="classMs_1_1Drumset.html#a0c116c7a1faa14e7d3f5b583561f5245">Ms::Drumset::isValid</a></div><div class="ttdeci">bool isValid(int pitch) const</div><div class="ttdef"><b>Definition:</b> <a href="drumset_8h_source.html#l00072">drumset.h:72</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_abed8eb110fc91cb3bbf8312d71c8c763"><div class="ttname"><a href="classMs_1_1TimeSig.html#abed8eb110fc91cb3bbf8312d71c8c763">Ms::TimeSig::denominator</a></div><div class="ttdeci">int denominator() const</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8h_source.html#l00087">timesig.h:87</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eae236b885a4014354180ec82383499db5"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eae236b885a4014354180ec82383499db5">Ms::Sid::maxAkkoladeDistance</a></div></div>
<div class="ttc" id="classMs_1_1Drumset_html_a57e943db32934a5f5b85f56d6cc5dc47"><div class="ttname"><a href="classMs_1_1Drumset.html#a57e943db32934a5f5b85f56d6cc5dc47">Ms::Drumset::noteHead</a></div><div class="ttdeci">NoteHead::Group noteHead(int pitch) const</div><div class="ttdef"><b>Definition:</b> <a href="drumset_8h_source.html#l00073">drumset.h:73</a></div></div>
<div class="ttc" id="namespaceMs_html_a47dcef959ab36006b46ca9005b316008"><div class="ttname"><a href="namespaceMs.html#a47dcef959ab36006b46ca9005b316008">Ms::addKey</a></div><div class="ttdeci">static void addKey(const KeySigEvent key, const bool printObj, Score *score, Measure *measure, const int staffIdx, const Fraction &amp;tick)</div><div class="ttdoc">Add a KeySigEvent to the score. </div><div class="ttdef"><b>Definition:</b> <a href="importmxmlpass2_8cpp_source.html#l03498">importmxmlpass2.cpp:3498</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a8cce5e6de5f0a4b9a16aa1b3e6aef7b6"><div class="ttname"><a href="classMs_1_1Score.html#a8cce5e6de5f0a4b9a16aa1b3e6aef7b6">Ms::Score::setScoreFont</a></div><div class="ttdeci">void setScoreFont(ScoreFont *f)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01161">score.h:1161</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea8840c6da2e66f5ee18c4b1aa2c354fd1"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea8840c6da2e66f5ee18c4b1aa2c354fd1">Ms::Sid::staffLowerBorder</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html"><div class="ttname"><a href="classMs_1_1Chord.html">Ms::Chord</a></div><div class="ttdoc">Graphic representation of a chord. </div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00055">chord.h:55</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a884bf81982c8c302cbdf79ea567c3ced"><div class="ttname"><a href="classMs_1_1Element.html#a884bf81982c8c302cbdf79ea567c3ced">Ms::Element::setTrack</a></div><div class="ttdeci">virtual void setTrack(int val)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00352">element.h:352</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_ad248bef7f25a4fe152ce281372a24d3f"><div class="ttname"><a href="classMs_1_1Staff.html#ad248bef7f25a4fe152ce281372a24d3f">Ms::Staff::staffType</a></div><div class="ttdeci">const StaffType * staffType(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01010">staff.cpp:1010</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a5816bc4dfa1e8a4d155ff931ff3e7c8e"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a5816bc4dfa1e8a4d155ff931ff3e7c8e">Ms::MeasureBase::repeatStart</a></div><div class="ttdeci">bool repeatStart() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00152">measurebase.h:152</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a638691b3520258aed47a5f3d2b67ad24"><div class="ttname"><a href="classMs_1_1Score.html#a638691b3520258aed47a5f3d2b67ad24">Ms::Score::undo</a></div><div class="ttdeci">void undo(UndoCommand *, EditData *=0) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l03746">score.cpp:3746</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_abd781d11186d1951028a0efaf6d5cf5a"><div class="ttname"><a href="classMs_1_1Element.html#abd781d11186d1951028a0efaf6d5cf5a">Ms::Element::width</a></div><div class="ttdeci">virtual qreal width() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00280">element.h:280</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_ab6ff6aba127497e2aa116b01ca73b563"><div class="ttname"><a href="classMs_1_1Staff.html#ab6ff6aba127497e2aa116b01ca73b563">Ms::Staff::timeSig</a></div><div class="ttdeci">TimeSig * timeSig(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l00468">staff.cpp:468</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aad15f62a3b7005066fff26ef0012874e"><div class="ttname"><a href="classMs_1_1Score.html#aad15f62a3b7005066fff26ef0012874e">Ms::Score::findCR</a></div><div class="ttdeci">ChordRest * findCR(Fraction tick, int track) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l03953">score.cpp:3953</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_af26552704e561432d3acf360f729bf55"><div class="ttname"><a href="structMs_1_1AcEl.html#af26552704e561432d3acf360f729bf55">Ms::AcEl::line</a></div><div class="ttdeci">int line</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00682">layout.cpp:682</a></div></div>
<div class="ttc" id="classMs_1_1ScoreElement_html_a70883d048b0884821ac779d9ab168151"><div class="ttname"><a href="classMs_1_1ScoreElement.html#a70883d048b0884821ac779d9ab168151">Ms::ScoreElement::score</a></div><div class="ttdeci">Score * score() const</div><div class="ttdef"><b>Definition:</b> <a href="scoreElement_8h_source.html#l00189">scoreElement.h:189</a></div></div>
<div class="ttc" id="classMs_1_1KeySig_html_a167094029a75cd2df41ebd1b2abee522"><div class="ttname"><a href="classMs_1_1KeySig.html#a167094029a75cd2df41ebd1b2abee522">Ms::KeySig::keySigEvent</a></div><div class="ttdeci">KeySigEvent keySigEvent() const</div><div class="ttdef"><b>Definition:</b> <a href="keysig_8h_source.html#l00062">keysig.h:62</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a4e9ad4c47081dec0aebcd2aea96b309f"><div class="ttname"><a href="classMs_1_1Segment.html#a4e9ad4c47081dec0aebcd2aea96b309f">Ms::Segment::element</a></div><div class="ttdeci">Element * element(int track) const</div><div class="ttdef"><b>Definition:</b> <a href="segment_8cpp_source.html#l00424">segment.cpp:424</a></div></div>
<div class="ttc" id="namespaceMs_html_a56785a0f227cf3d1d0a4891656a35daaa97b2544863191b69cc11635be5d02244"><div class="ttname"><a href="namespaceMs.html#a56785a0f227cf3d1d0a4891656a35daaa97b2544863191b69cc11635be5d02244">Ms::PropertyFlags::NOSTYLE</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a9cdd100c2ccfdab5d60251bc99e72f09"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a9cdd100c2ccfdab5d60251bc99e72f09">Ms::VerticalGapData::_factor</a></div><div class="ttdeci">qreal _factor</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00031">layout.h:31</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ad1de1c246a7f35e5b63781630e3c7d58"><div class="ttname"><a href="classMs_1_1Score.html#ad1de1c246a7f35e5b63781630e3c7d58">Ms::Score::staff</a></div><div class="ttdeci">Staff * staff(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00657">score.h:657</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a550c9abf9f41513672b152651e4c6a95"><div class="ttname"><a href="classMs_1_1Chord.html#a550c9abf9f41513672b152651e4c6a95">Ms::Chord::cmdUpdateNotes</a></div><div class="ttdeci">void cmdUpdateNotes(AccidentalState *)</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l01732">chord.cpp:1732</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eacb21bc44055692398df9983b7bc3ac64"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eacb21bc44055692398df9983b7bc3ac64">Ms::Sid::spreadSystem</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a8c27ddfb0004417dd89b655e3480a6a0"><div class="ttname"><a href="classMs_1_1Segment.html#a8c27ddfb0004417dd89b655e3480a6a0">Ms::Segment::next1</a></div><div class="ttdeci">Segment * next1() const</div><div class="ttdoc">return next Segment, don’t stop searching at end of Measure </div><div class="ttdef"><b>Definition:</b> <a href="segment_8cpp_source.html#l00223">segment.cpp:223</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_a2d1e149be3385c5540ef31af5d4fb20e"><div class="ttname"><a href="classMs_1_1MScore.html#a2d1e149be3385c5540ef31af5d4fb20e">Ms::MScore::verticalPageGap</a></div><div class="ttdeci">static qreal verticalPageGap</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00384">mscore.h:384</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_ad2edc025a393651b7cd3d8c1b4404c8b"><div class="ttname"><a href="classMs_1_1Chord.html#ad2edc025a393651b7cd3d8c1b4404c8b">Ms::Chord::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l01820">chord.cpp:1820</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a047fa69a68b80e772ad8fd9f85d2c837"><div class="ttname"><a href="classMs_1_1Score.html#a047fa69a68b80e772ad8fd9f85d2c837">Ms::Score::layoutChords2</a></div><div class="ttdeci">qreal layoutChords2(std::vector&lt; Note *&gt; &amp;notes, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00588">layout.cpp:588</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a180de4d0e2a4b8dda03c5ed38c12f4fe"><div class="ttname"><a href="classMs_1_1Note.html#a180de4d0e2a4b8dda03c5ed38c12f4fe">Ms::Note::setHidden</a></div><div class="ttdeci">void setHidden(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00442">note.h:442</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a282d4f8bfc6261d114cb945980f2a78e"><div class="ttname"><a href="classMs_1_1Score.html#a282d4f8bfc6261d114cb945980f2a78e">Ms::Score::updateVelo</a></div><div class="ttdeci">void updateVelo()</div><div class="ttdef"><b>Definition:</b> <a href="rendermidi_8cpp_source.html#l00903">rendermidi.cpp:903</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a8226b0d61543b1fca19861ca748900ba"><div class="ttname"><a href="classMs_1_1Score.html#a8226b0d61543b1fca19861ca748900ba">Ms::Score::pageNumberOffset</a></div><div class="ttdeci">int pageNumberOffset() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01091">score.h:1091</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a6b47e5546f64b548040f03aed658a179"><div class="ttname"><a href="classMs_1_1Measure.html#a6b47e5546f64b548040f03aed658a179">Ms::Measure::layoutMeasureNumber</a></div><div class="ttdeci">void layoutMeasureNumber()</div><div class="ttdoc">Layouts the Measure Numbers according to the Measure&amp;#39;s MeasureNumberMode. </div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00556">measure.cpp:556</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a12875266ecd46db59c8ba3a12857c944"><div class="ttname"><a href="classMs_1_1Segment.html#a12875266ecd46db59c8ba3a12857c944">Ms::Segment::isChordRestType</a></div><div class="ttdeci">bool isChordRestType() const</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00244">segment.h:244</a></div></div>
<div class="ttc" id="namespaceMs_html_af1c6d5c887f8bc4c394e7050f483914faede91669dcab48ceb3bc9cfb08bf0605"><div class="ttname"><a href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914faede91669dcab48ceb3bc9cfb08bf0605">Ms::BarLineType::DOTTED</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a650e991868e0532ab8f5cfa4e8c7d86e"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a650e991868e0532ab8f5cfa4e8c7d86e">Ms::MeasureBase::setSystem</a></div><div class="ttdeci">void setSystem(System *s)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00107">measurebase.h:107</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html"><div class="ttname"><a href="classMs_1_1VerticalGapData.html">Ms::VerticalGapData</a></div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00028">layout.h:28</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_af0d82c4a09a3e996e4c753bc573c203b"><div class="ttname"><a href="structMs_1_1AcEl.html#af0d82c4a09a3e996e4c753bc573c203b">Ms::AcEl::note</a></div><div class="ttdeci">Note * note</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00678">layout.cpp:678</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ac872216bf9760613e1f059f8531be5ad"><div class="ttname"><a href="classMs_1_1Measure.html#ac872216bf9760613e1f059f8531be5ad">Ms::Measure::staffLines</a></div><div class="ttdeci">StaffLines * staffLines(int staffIdx)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00306">measure.cpp:306</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a11c815063edf5abc1bff515e11b03a2b"><div class="ttname"><a href="classMs_1_1ChordRest.html#a11c815063edf5abc1bff515e11b03a2b">Ms::ChordRest::staffMove</a></div><div class="ttdeci">int staffMove() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00116">chordrest.h:116</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a693ed2bc02f09dc0fff3f6731dfa3e98af3fc827ade4b968e50406496907ef962"><div class="ttname"><a href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98af3fc827ade4b968e50406496907ef962">Ms::Staff::HideMode::ALWAYS</a></div></div>
<div class="ttc" id="classMs_1_1SysStaff_html_a57e339125410bd2815b37f3a294e3ea0"><div class="ttname"><a href="classMs_1_1SysStaff.html#a57e339125410bd2815b37f3a294e3ea0">Ms::SysStaff::setShow</a></div><div class="ttdeci">void setShow(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00074">system.h:74</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a4a1ae88c341d451822e9c710fffdba10"><div class="ttname"><a href="classMs_1_1Measure.html#a4a1ae88c341d451822e9c710fffdba10">Ms::Measure::layoutStaffLines</a></div><div class="ttdeci">void layoutStaffLines()</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00262">measure.cpp:262</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a185fc7776084b28c2f33003434729ffe"><div class="ttname"><a href="classMs_1_1Chord.html#a185fc7776084b28c2f33003434729ffe">Ms::Chord::layoutStem1</a></div><div class="ttdeci">void layoutStem1() override</div><div class="ttdoc">Layout _stem and _stemSlash. </div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l01496">chord.cpp:1496</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_afecb2c6b929ec69b1959613acaa1dc90"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#afecb2c6b929ec69b1959613acaa1dc90">Ms::VerticalGapData::_addedNormalisedSpace</a></div><div class="ttdeci">qreal _addedNormalisedSpace</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00034">layout.h:34</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_afdd8a358b8e40b9e02bca11e9fbb8829"><div class="ttname"><a href="classMs_1_1Staff.html#afdd8a358b8e40b9e02bca11e9fbb8829">Ms::Staff::isTabStaff</a></div><div class="ttdeci">bool isTabStaff(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01516">staff.cpp:1516</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaad8449ae5f63b8b3de90b8912c0266da"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaad8449ae5f63b8b3de90b8912c0266da">Ms::Sid::maxChordShiftAbove</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a94a3a697e4767c1e0ed46c205a81ac24"><div class="ttname"><a href="classMs_1_1ChordRest.html#a94a3a697e4767c1e0ed46c205a81ac24">Ms::ChordRest::segment</a></div><div class="ttdeci">virtual Segment * segment() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00081">chordrest.h:81</a></div></div>
<div class="ttc" id="classMs_1_1KeySig_html"><div class="ttname"><a href="classMs_1_1KeySig.html">Ms::KeySig</a></div><div class="ttdoc">The KeySig class represents a Key Signature on a staff. </div><div class="ttdef"><b>Definition:</b> <a href="keysig_8h_source.html#l00031">keysig.h:31</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a4aaeddbaa0294766f9d5509d2fec6f39"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a4aaeddbaa0294766f9d5509d2fec6f39">Ms::VerticalGapData::_maxActualSpacing</a></div><div class="ttdeci">qreal _maxActualSpacing</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00033">layout.h:33</a></div></div>
<div class="ttc" id="ottava_8h_html"><div class="ttname"><a href="ottava_8h.html">ottava.h</a></div></div>
<div class="ttc" id="classMs_1_1MasterScore_html"><div class="ttname"><a href="classMs_1_1MasterScore.html">Ms::MasterScore</a></div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01269">score.h:1269</a></div></div>
<div class="ttc" id="classMs_1_1AccidentalState_html_a3d8092df8cff6239b00865e957610f9e"><div class="ttname"><a href="classMs_1_1AccidentalState.html#a3d8092df8cff6239b00865e957610f9e">Ms::AccidentalState::init</a></div><div class="ttdeci">void init(Key key)</div><div class="ttdef"><b>Definition:</b> <a href="key_8cpp_source.html#l00203">key.cpp:203</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a828f022bce378eb3bdf609c32c44f24d"><div class="ttname"><a href="classMs_1_1Staff.html#a828f022bce378eb3bdf609c32c44f24d">Ms::Staff::spatium</a></div><div class="ttdeci">qreal spatium(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l00816">staff.cpp:816</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a291718ca12053bd8e663a8fcd756bd6b"><div class="ttname"><a href="classMs_1_1Score.html#a291718ca12053bd8e663a8fcd756bd6b">Ms::Score::npages</a></div><div class="ttdeci">virtual int npages() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01010">score.h:1010</a></div></div>
<div class="ttc" id="classMs_1_1ChangeKeySig_html"><div class="ttname"><a href="classMs_1_1ChangeKeySig.html">Ms::ChangeKeySig</a></div><div class="ttdef"><b>Definition:</b> <a href="undo_8h_source.html#l00411">undo.h:411</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea83a473e523160149b1f60621fcba0b5b"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea83a473e523160149b1f60621fcba0b5b">Ms::Sid::createMultiMeasureRests</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a369f7689a1a21e8b0aa07e5bbacb3d76"><div class="ttname"><a href="classMs_1_1Score.html#a369f7689a1a21e8b0aa07e5bbacb3d76">Ms::Score::styleB</a></div><div class="ttdeci">bool styleB(Sid idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00898">score.h:898</a></div></div>
<div class="ttc" id="classMs_1_1Shape_html_a159413b243aff63b765b2a0aebde7f36"><div class="ttname"><a href="classMs_1_1Shape.html#a159413b243aff63b765b2a0aebde7f36">Ms::Shape::minHorizontalDistance</a></div><div class="ttdeci">qreal minHorizontalDistance(const Shape &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="shape_8cpp_source.html#l00082">shape.cpp:82</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaefbbb63ca3f542327e2160efc22f0427"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaefbbb63ca3f542327e2160efc22f0427">Ms::Sid::dividerLeftY</a></div></div>
<div class="ttc" id="classMs_1_1Spacer_html"><div class="ttname"><a href="classMs_1_1Spacer.html">Ms::Spacer</a></div><div class="ttdoc">Vertical spacer element to adjust the distance of staves. </div><div class="ttdef"><b>Definition:</b> <a href="spacer_8h_source.html#l00033">spacer.h:33</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aa7ea8f4f050ba44ed0cf95ad4f5d3c06"><div class="ttname"><a href="classMs_1_1Score.html#aa7ea8f4f050ba44ed0cf95ad4f5d3c06">Ms::Score::ntracks</a></div><div class="ttdeci">int ntracks() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00654">score.h:654</a></div></div>
<div class="ttc" id="classMs_1_1Drumset_html_a19e7739fa57e35a79928fa58766d9c5a"><div class="ttname"><a href="classMs_1_1Drumset.html#a19e7739fa57e35a79928fa58766d9c5a">Ms::Drumset::line</a></div><div class="ttdeci">int line(int pitch) const</div><div class="ttdef"><b>Definition:</b> <a href="drumset_8h_source.html#l00075">drumset.h:75</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a2a2ce2358cc23529d8f038a940062e62"><div class="ttname"><a href="classMs_1_1Element.html#a2a2ce2358cc23529d8f038a940062e62">Ms::Element::setPos</a></div><div class="ttdeci">void setPos(qreal x, qreal y)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00246">element.h:246</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_ac1a0c95bfede9e37dd3fd910905092b8ae1f2d5134ed2543d38a0de9751cf75d9"><div class="ttname"><a href="classMs_1_1MScore.html#ac1a0c95bfede9e37dd3fd910905092b8ae1f2d5134ed2543d38a0de9751cf75d9">Ms::MScore::DirectionH::AUTO</a></div></div>
<div class="ttc" id="namespaceMs_html_a9506eedd97d44c482010b77e53a72b18"><div class="ttname"><a href="namespaceMs.html#a9506eedd97d44c482010b77e53a72b18">Ms::distance</a></div><div class="ttdeci">static int distance(const Location &amp;l1, const Location &amp;l2)</div><div class="ttdef"><b>Definition:</b> <a href="connector_8cpp_source.html#l00120">connector.cpp:120</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ead80edba277a8f1ab117e9c42036187c8"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead80edba277a8f1ab117e9c42036187c8">Ms::Sid::pagePrintableWidth</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_adc6b9aa10c0b149eea492432ceeb3ce3"><div class="ttname"><a href="classMs_1_1ChordRest.html#adc6b9aa10c0b149eea492432ceeb3ce3">Ms::ChordRest::setDurationType</a></div><div class="ttdeci">void setDurationType(TDuration::DurationType t)</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8cpp_source.html#l00661">chordrest.cpp:661</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a9aae800cd73b0dff71aa6f690f77d7fc"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a9aae800cd73b0dff71aa6f690f77d7fc">Ms::VerticalGapData::addSpacing</a></div><div class="ttdeci">qreal addSpacing(qreal step)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05225">layout.cpp:5225</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a14581354d9bfc2c39c7dafbed79403da"><div class="ttname"><a href="classMs_1_1Element.html#a14581354d9bfc2c39c7dafbed79403da">Ms::Element::staff</a></div><div class="ttdeci">Staff * staff() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00276">element.cpp:276</a></div></div>
<div class="ttc" id="classMs_1_1LayoutBreak_html"><div class="ttname"><a href="classMs_1_1LayoutBreak.html">Ms::LayoutBreak</a></div><div class="ttdoc">symbols for line break, page break etc. </div><div class="ttdef"><b>Definition:</b> <a href="layoutbreak_8h_source.html#l00027">layoutbreak.h:27</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a0d0757612d3d41e59d34a20278900258"><div class="ttname"><a href="classMs_1_1Score.html#a0d0757612d3d41e59d34a20278900258">Ms::Score::rebuildTempoAndTimeSigMaps</a></div><div class="ttdeci">void rebuildTempoAndTimeSigMaps(Measure *m)</div><div class="ttdoc">updates tempomap and time sig map for a measure </div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l00463">score.cpp:463</a></div></div>
<div class="ttc" id="classMs_1_1RemoveElement_html"><div class="ttname"><a href="classMs_1_1RemoveElement.html">Ms::RemoveElement</a></div><div class="ttdef"><b>Definition:</b> <a href="undo_8h_source.html#l00571">undo.h:571</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ab0624346b77edaab4269b9eb2523a225"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ab0624346b77edaab4269b9eb2523a225">Ms::MeasureBase::no</a></div><div class="ttdeci">int no() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00144">measurebase.h:144</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_abbb8a43c3c9cdb1a3cce412bfe4409ef"><div class="ttname"><a href="classMs_1_1MeasureBase.html#abbb8a43c3c9cdb1a3cce412bfe4409ef">Ms::MeasureBase::setTick</a></div><div class="ttdeci">void setTick(const Fraction &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00126">measurebase.h:126</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894a744c4c5d2986906841d0f6e0e4906985"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a744c4c5d2986906841d0f6e0e4906985">Ms::SegmentType::Ambitus</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a5cb93da114779e0e9811e2e6d9322e2e"><div class="ttname"><a href="classMs_1_1System.html#a5cb93da114779e0e9811e2e6d9322e2e">Ms::System::systemDividerLeft</a></div><div class="ttdeci">SystemDivider * systemDividerLeft() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00179">system.h:179</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_ab0ce88117199ff8fea149d99b515c2e7"><div class="ttname"><a href="classMs_1_1Note.html#ab0ce88117199ff8fea149d99b515c2e7">Ms::Note::userMirror</a></div><div class="ttdeci">MScore::DirectionH userMirror() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00455">note.h:455</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a260e9896d5323993e2ba87c40f60d5ce"><div class="ttname"><a href="classMs_1_1ChordRest.html#a260e9896d5323993e2ba87c40f60d5ce">Ms::ChordRest::small</a></div><div class="ttdeci">bool small() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00112">chordrest.h:112</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_afe0530ec07045553559ded6c16d5dd6c"><div class="ttname"><a href="classMs_1_1Chord.html#afe0530ec07045553559ded6c16d5dd6c">Ms::Chord::crossMeasureSetup</a></div><div class="ttdeci">void crossMeasureSetup(bool on) override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l02494">chord.cpp:2494</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea6198654de2e6d8b98dd935d960ffd154"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea6198654de2e6d8b98dd935d960ffd154">Ms::Sid::alignAccidentalsLeft</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapDataList_html_a1a7300a0d3832784cf4b478d6f65bbe2"><div class="ttname"><a href="classMs_1_1VerticalGapDataList.html#a1a7300a0d3832784cf4b478d6f65bbe2">Ms::VerticalGapDataList::smallest</a></div><div class="ttdeci">qreal smallest(qreal limit=-1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05299">layout.cpp:5299</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea7c4235db39ed54025b0557b483c3ae41"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea7c4235db39ed54025b0557b483c3ae41">Ms::Sid::spreadSquareBracket</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_ae22472cdd1ee2864eb9e971e7950ae16"><div class="ttname"><a href="structMs_1_1LayoutContext.html#ae22472cdd1ee2864eb9e971e7950ae16">Ms::LayoutContext::score</a></div><div class="ttdeci">Score * score</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00080">layout.h:80</a></div></div>
<div class="ttc" id="classMs_1_1KeySig_html_ac70a2ea997165c6d12af4238a05c4d37"><div class="ttname"><a href="classMs_1_1KeySig.html#ac70a2ea997165c6d12af4238a05c4d37">Ms::KeySig::clone</a></div><div class="ttdeci">KeySig * clone() const override</div><div class="ttdef"><b>Definition:</b> <a href="keysig_8h_source.html#l00041">keysig.h:41</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a80aa5db67223dff29e9113f23865b62b"><div class="ttname"><a href="classMs_1_1Staff.html#a80aa5db67223dff29e9113f23865b62b">Ms::Staff::mag</a></div><div class="ttdeci">qreal mag(const StaffType *) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l00830">staff.cpp:830</a></div></div>
<div class="ttc" id="namespaceMs_html_a312ec8a39e6d4053d8f84c23b86ceaec"><div class="ttname"><a href="namespaceMs.html#a312ec8a39e6d4053d8f84c23b86ceaec">Ms::layoutTies</a></div><div class="ttdeci">void layoutTies(Chord *ch, System *system, const Fraction &amp;stick)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03501">layout.cpp:3501</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a69bb5a25e3e1c714788540ce57f92a71"><div class="ttname"><a href="classMs_1_1Score.html#a69bb5a25e3e1c714788540ce57f92a71">Ms::Score::style</a></div><div class="ttdeci">virtual MStyle &amp; style()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00887">score.h:887</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a7b344ea7b12893001b693d782d19a081"><div class="ttname"><a href="classMs_1_1ChordRest.html#a7b344ea7b12893001b693d782d19a081">Ms::ChordRest::vStaffIdx</a></div><div class="ttdeci">virtual int vStaffIdx() const override</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00118">chordrest.h:118</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ad1e0d3968ecafec4140aac087bd8fd99"><div class="ttname"><a href="classMs_1_1Element.html#ad1e0d3968ecafec4140aac087bd8fd99">Ms::Element::vStaffIdx</a></div><div class="ttdeci">virtual int vStaffIdx() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00358">element.h:358</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a5b7778fe0022d74f748a9150342fe598"><div class="ttname"><a href="classMs_1_1Score.html#a5b7778fe0022d74f748a9150342fe598">Ms::Score::doLayoutRange</a></div><div class="ttdeci">void doLayoutRange(const Fraction &amp;, const Fraction &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04885">layout.cpp:4885</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aebf61ce48548d4c61db23b0d94e184ae"><div class="ttname"><a href="classMs_1_1Score.html#aebf61ce48548d4c61db23b0d94e184ae">Ms::Score::noteHeadWidth</a></div><div class="ttdeci">qreal noteHeadWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01163">score.h:1163</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a3888570668d289ec09dd850d4c169e1c"><div class="ttname"><a href="classMs_1_1Score.html#a3888570668d289ec09dd850d4c169e1c">Ms::Score::firstMeasure</a></div><div class="ttdeci">Ms::Measure * firstMeasure() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l01609">score.cpp:1609</a></div></div>
<div class="ttc" id="classMs_1_1Ambitus_html"><div class="ttname"><a href="classMs_1_1Ambitus.html">Ms::Ambitus</a></div><div class="ttdef"><b>Definition:</b> <a href="ambitus_8h_source.html#l00026">ambitus.h:26</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html_affc33cb9d3e419eb2c5a52ecb9e44736"><div class="ttname"><a href="classMs_1_1Spanner.html#affc33cb9d3e419eb2c5a52ecb9e44736">Ms::Spanner::tick2</a></div><div class="ttdeci">Fraction tick2() const</div><div class="ttdef"><b>Definition:</b> <a href="spanner_8h_source.html#l00176">spanner.h:176</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a429b1f1b6240aec75c46b7aab08c8b1f"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a429b1f1b6240aec75c46b7aab08c8b1f">Ms::VerticalGapData::addSpaceAroundVBox</a></div><div class="ttdeci">void addSpaceAroundVBox(bool above)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05157">layout.cpp:5157</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a7d2a3a40bb9f87be831540f0258e95df"><div class="ttname"><a href="classMs_1_1System.html#a7d2a3a40bb9f87be831540f0258e95df">Ms::System::firstVisibleStaff</a></div><div class="ttdeci">int firstVisibleStaff() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00629">system.cpp:629</a></div></div>
<div class="ttc" id="namespaceMs_html_aa0f871cf8181cec31d68d20a39010655a5d15377f29d4bca438ef8a339555af95"><div class="ttname"><a href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a5d15377f29d4bca438ef8a339555af95">Ms::Pid::HEAD_GROUP</a></div></div>
<div class="ttc" id="classMs_1_1Stem_html_aadcbdc10cbafbc7486be0092097fae12"><div class="ttname"><a href="classMs_1_1Stem.html#aadcbdc10cbafbc7486be0092097fae12">Ms::Stem::lineWidth</a></div><div class="ttdeci">qreal lineWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="stem_8h_source.html#l00065">stem.h:65</a></div></div>
<div class="ttc" id="classMs_1_1Dynamic_html"><div class="ttname"><a href="classMs_1_1Dynamic.html">Ms::Dynamic</a></div><div class="ttdoc">dynamics marker; determines midi velocity </div><div class="ttdef"><b>Definition:</b> <a href="dynamic_8h_source.html#l00031">dynamic.h:31</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a617ab3f074400ef5ba92e9f3b441e940"><div class="ttname"><a href="classMs_1_1Score.html#a617ab3f074400ef5ba92e9f3b441e940">Ms::Score::measure</a></div><div class="ttdeci">MeasureBase * measure(int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l01650">score.cpp:1650</a></div></div>
<div class="ttc" id="classMs_1_1Page_html_adb26ac04b2bb7c6d3c1d7f61d361daa1"><div class="ttname"><a href="classMs_1_1Page.html#adb26ac04b2bb7c6d3c1d7f61d361daa1">Ms::Page::rebuildBspTree</a></div><div class="ttdeci">void rebuildBspTree()</div><div class="ttdef"><b>Definition:</b> <a href="page_8h_source.html#l00074">page.h:74</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6feab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab1a326c06d88bf042f73d70f50197905">Ms::Beam::Mode::END</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea2699e0ac7f36e1099d48db3e5706992f"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea2699e0ac7f36e1099d48db3e5706992f">Ms::Sid::tremoloDistance</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ab2347f55630666c0a3e699b6c91bbf80"><div class="ttname"><a href="classMs_1_1Score.html#ab2347f55630666c0a3e699b6c91bbf80">Ms::Score::measures</a></div><div class="ttdeci">MeasureBaseList * measures()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01018">score.h:1018</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a1397cfb5140978e6cd9aa294ade7d738"><div class="ttname"><a href="classMs_1_1Element.html#a1397cfb5140978e6cd9aa294ade7d738">Ms::Element::rypos</a></div><div class="ttdeci">qreal &amp; rypos()</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00250">element.h:250</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a1ca675ae448b1850c924d042b3f39691"><div class="ttname"><a href="classMs_1_1System.html#a1ca675ae448b1850c924d042b3f39691">Ms::System::minDistance</a></div><div class="ttdeci">qreal minDistance(System *) const</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01382">system.cpp:1382</a></div></div>
<div class="ttc" id="namespaceMs_html_a7efd77a58797a375f3d6d631e51b204e"><div class="ttname"><a href="namespaceMs.html#a7efd77a58797a375f3d6d631e51b204e">Ms::searchTieNote</a></div><div class="ttdeci">Note * searchTieNote(Note *note)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2utils_8cpp_source.html#l00772">utils.cpp:772</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_aaa31b11917139c63c6dc4a46f939b95f"><div class="ttname"><a href="classMs_1_1Note.html#aaa31b11917139c63c6dc4a46f939b95f">Ms::Note::headBodyWidth</a></div><div class="ttdeci">qreal headBodyWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8cpp_source.html#l00947">note.cpp:947</a></div></div>
<div class="ttc" id="namespaceMs_html_ae95dea350de4a3014dbcbcfe9a6a75dcaf6adb53735dfab8f94c96875ce053396"><div class="ttname"><a href="namespaceMs.html#ae95dea350de4a3014dbcbcfe9a6a75dcaf6adb53735dfab8f94c96875ce053396">Ms::LayoutFlag::PLAY_EVENTS</a></div></div>
<div class="ttc" id="classMs_1_1DurationElement_html"><div class="ttname"><a href="classMs_1_1DurationElement.html">Ms::DurationElement</a></div><div class="ttdoc">Virtual base class for Chord, Rest and Tuplet. </div><div class="ttdef"><b>Definition:</b> <a href="duration_8h_source.html#l00034">duration.h:34</a></div></div>
<div class="ttc" id="classMs_1_1Shape_html_a51535d0e5b819152b44f47f98925e1e7"><div class="ttname"><a href="classMs_1_1Shape.html#a51535d0e5b819152b44f47f98925e1e7">Ms::Shape::translated</a></div><div class="ttdeci">Shape translated(const QPointF &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="shape_8cpp_source.html#l00063">shape.cpp:63</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ab4986d1b4f0d45b8e84cf52c46885c36"><div class="ttname"><a href="classMs_1_1Element.html#ab4986d1b4f0d45b8e84cf52c46885c36">Ms::Element::track</a></div><div class="ttdeci">int track() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00351">element.h:351</a></div></div>
<div class="ttc" id="classMs_1_1KeySig_html_a50ff6fe9275deb66132ebc4166bf8207"><div class="ttname"><a href="classMs_1_1KeySig.html#a50ff6fe9275deb66132ebc4166bf8207">Ms::KeySig::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="keysig_8cpp_source.html#l00090">keysig.cpp:90</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a84dfddee94c6532d6df8279129cb8384"><div class="ttname"><a href="classMs_1_1Score.html#a84dfddee94c6532d6df8279129cb8384">Ms::Score::_showVBox</a></div><div class="ttdeci">bool _showVBox</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00467">score.h:467</a></div></div>
<div class="ttc" id="classMs_1_1Tie_html"><div class="ttname"><a href="classMs_1_1Tie.html">Ms::Tie</a></div><div class="ttdoc">a Tie has a Note as startElement/endElement </div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8h_source.html#l00060">tie.h:60</a></div></div>
<div class="ttc" id="namespaceMs_html_aa0f871cf8181cec31d68d20a39010655ade5719c2dfdeb16392d208bee8e76229"><div class="ttname"><a href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655ade5719c2dfdeb16392d208bee8e76229">Ms::Pid::AUTOPLACE</a></div></div>
<div class="ttc" id="classMs_1_1SlurTieSegment_html_afabd534baeefa0cfef3c7ff829fd8ad0"><div class="ttname"><a href="classMs_1_1SlurTieSegment.html#afabd534baeefa0cfef3c7ff829fd8ad0">Ms::SlurTieSegment::shape</a></div><div class="ttdeci">virtual Shape shape() const override</div><div class="ttdef"><b>Definition:</b> <a href="slurtie_8h_source.html#l00112">slurtie.h:112</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ab5518cc652f95d5d64ddd2bd7bfc6f6b"><div class="ttname"><a href="classMs_1_1Element.html#ab5518cc652f95d5d64ddd2bd7bfc6f6b">Ms::Element::autoplaceSegmentElement</a></div><div class="ttdeci">void autoplaceSegmentElement(bool above, bool add)</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l02482">element.cpp:2482</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a4fb26ab17477cfbc62b748034c0de041">Ms::SegmentType::Clef</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ead3a95911641db612363b3985d386e7f7"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ead3a95911641db612363b3985d386e7f7">Ms::Sid::ledgerLineLength</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a6e80c952d019b265c81945b98c91fed2"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a6e80c952d019b265c81945b98c91fed2">Ms::MeasureBase::endTick</a></div><div class="ttdeci">Fraction endTick() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00131">measurebase.h:131</a></div></div>
<div class="ttc" id="classMs_1_1Page_html_a4406043135c1ea0028f010710ebe9774"><div class="ttname"><a href="classMs_1_1Page.html#a4406043135c1ea0028f010710ebe9774">Ms::Page::systems</a></div><div class="ttdeci">const QList&lt; System * &gt; &amp; systems() const</div><div class="ttdef"><b>Definition:</b> <a href="page_8h_source.html#l00052">page.h:52</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html"><div class="ttname"><a href="classMs_1_1Spanner.html">Ms::Spanner</a></div><div class="ttdoc">Virtual base class for slurs, ties, lines etc. </div><div class="ttdef"><b>Definition:</b> <a href="spanner_8h_source.html#l00123">spanner.h:123</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea233a910dde3c26b67cfe1cabb3b17d3a"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea233a910dde3c26b67cfe1cabb3b17d3a">Ms::Sid::lyricsMinBottomDistance</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a304d88a7891a731cbfb8e5b0c2e8a5fc"><div class="ttname"><a href="classMs_1_1Element.html#a304d88a7891a731cbfb8e5b0c2e8a5fc">Ms::Element::setTrailer</a></div><div class="ttdeci">void setTrailer(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00442">element.h:442</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_af3fbc117c926f4bc9bd5f0ee3e8ad478"><div class="ttname"><a href="classMs_1_1Tremolo.html#af3fbc117c926f4bc9bd5f0ee3e8ad478">Ms::Tremolo::chord1</a></div><div class="ttdeci">Chord * chord1() const</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00083">tremolo.h:83</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a50092b502c319cb696998f24fc038695"><div class="ttname"><a href="classMs_1_1Element.html#a50092b502c319cb696998f24fc038695">Ms::Element::placeBelow</a></div><div class="ttdeci">bool placeBelow() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00231">element.h:231</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_a3c2a1a737f7fb1fa190291b63ce118f4"><div class="ttname"><a href="classMs_1_1Tremolo.html#a3c2a1a737f7fb1fa190291b63ce118f4">Ms::Tremolo::lines</a></div><div class="ttdeci">int lines() const</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00096">tremolo.h:96</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a1a35e7598d783204faa93ba261b5909d"><div class="ttname"><a href="classMs_1_1Chord.html#a1a35e7598d783204faa93ba261b5909d">Ms::Chord::upNote</a></div><div class="ttdeci">Note * upNote() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00069">chord.cpp:69</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html"><div class="ttname"><a href="structMs_1_1LayoutContext.html">Ms::LayoutContext</a></div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00079">layout.h:79</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a580438281cd8680a99047ceb42e5b15f"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a580438281cd8680a99047ceb42e5b15f">Ms::VerticalGapData::factor</a></div><div class="ttdeci">qreal factor() const</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05197">layout.cpp:5197</a></div></div>
<div class="ttc" id="classMs_1_1System_html_af40610f94eb1240d9b432efc583e805e"><div class="ttname"><a href="classMs_1_1System.html#af40610f94eb1240d9b432efc583e805e">Ms::System::adjustStavesNumber</a></div><div class="ttdeci">void adjustStavesNumber(int)</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00207">system.cpp:207</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_ad55c1e54b156996f2b1d211c31eb7df9"><div class="ttname"><a href="classMs_1_1Note.html#ad55c1e54b156996f2b1d211c31eb7df9">Ms::Note::bboxRightPos</a></div><div class="ttdeci">qreal bboxRightPos() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8cpp_source.html#l00936">note.cpp:936</a></div></div>
<div class="ttc" id="namespaceMs_html_a9210a20e1a75146ee5e3102a3bbb9320"><div class="ttname"><a href="namespaceMs.html#a9210a20e1a75146ee5e3102a3bbb9320">Ms::notTopBeam</a></div><div class="ttdeci">bool notTopBeam(ChordRest *cr)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03134">layout.cpp:3134</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ab39888225a9fe0533558a379b1545cb1"><div class="ttname"><a href="classMs_1_1Score.html#ab39888225a9fe0533558a379b1545cb1">Ms::Score::nstaves</a></div><div class="ttdeci">int nstaves() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00653">score.h:653</a></div></div>
<div class="ttc" id="namespaceMs_html_a57c9d6489bf49c4da32db4e674c3515e"><div class="ttname"><a href="namespaceMs.html#a57c9d6489bf49c4da32db4e674c3515e">Ms::processLines</a></div><div class="ttdeci">static void processLines(System *system, std::vector&lt; Spanner *&gt; lines, bool align)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03709">layout.cpp:3709</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_aac8969ffb365d143f0b60b4a222303f4"><div class="ttname"><a href="classMs_1_1Note.html#aac8969ffb365d143f0b60b4a222303f4">Ms::Note::setDotsHidden</a></div><div class="ttdeci">void setDotsHidden(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00444">note.h:444</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aa4353d2ea4660f134a9030dbf9216b25"><div class="ttname"><a href="classMs_1_1Score.html#aa4353d2ea4660f134a9030dbf9216b25">Ms::Score::staffIdx</a></div><div class="ttdeci">int staffIdx(const Part *) const</div><div class="ttdoc">Return index for the first staff of part. </div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l05000">score.cpp:5000</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a3679cdb6351e67e9f482fa9a7fb3d466"><div class="ttname"><a href="classMs_1_1Element.html#a3679cdb6351e67e9f482fa9a7fb3d466">Ms::Element::generated</a></div><div class="ttdeci">bool generated() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00234">element.h:234</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html_a825bfba09be9b0598940b854ba494312"><div class="ttname"><a href="classMs_1_1Spanner.html#a825bfba09be9b0598940b854ba494312">Ms::Spanner::tick</a></div><div class="ttdeci">virtual Fraction tick() const override</div><div class="ttdef"><b>Definition:</b> <a href="spanner_8h_source.html#l00175">spanner.h:175</a></div></div>
<div class="ttc" id="namespaceMs_html_af1c6d5c887f8bc4c394e7050f483914fa7c6a77bcc662a0b7d6e00c22fba3ba21"><div class="ttname"><a href="namespaceMs.html#af1c6d5c887f8bc4c394e7050f483914fa7c6a77bcc662a0b7d6e00c22fba3ba21">Ms::BarLineType::START_REPEAT</a></div></div>
<div class="ttc" id="classMs_1_1ElementList_html"><div class="ttname"><a href="classMs_1_1ElementList.html">Ms::ElementList</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00565">element.h:565</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a693ed2bc02f09dc0fff3f6731dfa3e98a443475558f0168dff92ecde26b98ae5a"><div class="ttname"><a href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98a443475558f0168dff92ecde26b98ae5a">Ms::Staff::HideMode::NEVER</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a2837b53e5e5172c8e7fe77a2fc634e41"><div class="ttname"><a href="classMs_1_1System.html#a2837b53e5e5172c8e7fe77a2fc634e41">Ms::System::addBrackets</a></div><div class="ttdeci">void addBrackets(Measure *measure)</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00488">system.cpp:488</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a6c58c83a689bd9d8caa462ab3559b176"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a6c58c83a689bd9d8caa462ab3559b176">Ms::MeasureBase::pageBreak</a></div><div class="ttdeci">bool pageBreak() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00164">measurebase.h:164</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aabf8eae8fbefcade6724ea507c16a9ed"><div class="ttname"><a href="classMs_1_1Score.html#aabf8eae8fbefcade6724ea507c16a9ed">Ms::Score::layoutChords1</a></div><div class="ttdeci">void layoutChords1(Segment *segment, int staffIdx)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00147">layout.cpp:147</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a1f36066aac6e0601246d56816129b7e7"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a1f36066aac6e0601246d56816129b7e7">Ms::LayoutContext::startWithLongNames</a></div><div class="ttdeci">bool startWithLongNames</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00081">layout.h:81</a></div></div>
<div class="ttc" id="classMs_1_1CmdStateLocker_html"><div class="ttname"><a href="classMs_1_1CmdStateLocker.html">Ms::CmdStateLocker</a></div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04874">layout.cpp:4874</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_aab85a5d7b01dd5f816168d3e8a6e4dad"><div class="ttname"><a href="classMs_1_1MeasureBase.html#aab85a5d7b01dd5f816168d3e8a6e4dad">Ms::MeasureBase::setPageBreak</a></div><div class="ttdeci">void setPageBreak(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00165">measurebase.h:165</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaefa10f531820c21c466b58288845a875"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaefa10f531820c21c466b58288845a875">Ms::Sid::dividerLeft</a></div></div>
<div class="ttc" id="namespaceMs_html_a72e619a51799cbb2ec85aa0a07e8fd18a84e4213ee54478574ea15a166ea10152"><div class="ttname"><a href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18a84e4213ee54478574ea15a166ea10152">Ms::VerticalAlignRange::MEASURE</a></div></div>
<div class="ttc" id="note_8h_html"><div class="ttname"><a href="note_8h.html">note.h</a></div><div class="ttdoc">Definition of classes Note and NoteHead. </div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a8529d60c353a12b3a05fc4dee5243a44"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a8529d60c353a12b3a05fc4dee5243a44">Ms::VerticalGapData::_normalisedSpacing</a></div><div class="ttdeci">qreal _normalisedSpacing</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00032">layout.h:32</a></div></div>
<div class="ttc" id="chord_8h_html"><div class="ttname"><a href="chord_8h.html">chord.h</a></div><div class="ttdoc">Definition of classes Chord, HelpLine and NoteList. </div></div>
<div class="ttc" id="classMs_1_1BarLine_html_aa7cce50a8d5f1e25e7a511039e311e3d"><div class="ttname"><a href="classMs_1_1BarLine.html#aa7cce50a8d5f1e25e7a511039e311e3d">Ms::BarLine::setBarLineType</a></div><div class="ttdeci">void setBarLineType(const QString &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="barline_8cpp_source.html#l00265">barline.cpp:265</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a93f20b9f05035a10d6e78c10ebdaf761"><div class="ttname"><a href="classMs_1_1Score.html#a93f20b9f05035a10d6e78c10ebdaf761">Ms::Score::enableVerticalSpread</a></div><div class="ttdeci">bool enableVerticalSpread() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l03461">score.cpp:3461</a></div></div>
<div class="ttc" id="classMs_1_1DurationElement_html_ab46be26ba621ac65774af1ad7bb07cd7"><div class="ttname"><a href="classMs_1_1DurationElement.html#ab46be26ba621ac65774af1ad7bb07cd7">Ms::DurationElement::setTicks</a></div><div class="ttdeci">void setTicks(const Fraction &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="duration_8h_source.html#l00059">duration.h:59</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_adcb12997b0fc5b963013139a4e1f3921"><div class="ttname"><a href="classMs_1_1Measure.html#adcb12997b0fc5b963013139a4e1f3921">Ms::Measure::breakMultiMeasureRest</a></div><div class="ttdeci">bool breakMultiMeasureRest() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00236">measure.h:236</a></div></div>
<div class="ttc" id="classMs_1_1Fraction_html_ab7f69a821d6b59f4e448eb3e5ecb33fa"><div class="ttname"><a href="classMs_1_1Fraction.html#ab7f69a821d6b59f4e448eb3e5ecb33fa">Ms::Fraction::isNotZero</a></div><div class="ttdeci">bool isNotZero() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2fraction_8h_source.html#l00078">fraction.h:78</a></div></div>
<div class="ttc" id="classMs_1_1StaffType_html_a8573023e9149c33b1dc28e8e841e21ca"><div class="ttname"><a href="classMs_1_1StaffType.html#a8573023e9149c33b1dc28e8e841e21ca">Ms::StaffType::lineDistance</a></div><div class="ttdeci">Spatium lineDistance() const</div><div class="ttdef"><b>Definition:</b> <a href="stafftype_8h_source.html#l00294">stafftype.h:294</a></div></div>
<div class="ttc" id="classMs_1_1Fingering_html"><div class="ttname"><a href="classMs_1_1Fingering.html">Ms::Fingering</a></div><div class="ttdef"><b>Definition:</b> <a href="fingering_8h_source.html#l00024">fingering.h:24</a></div></div>
<div class="ttc" id="classMs_1_1Accidental_html_a6068f72a92f62c8111e9c36b73bdd732"><div class="ttname"><a href="classMs_1_1Accidental.html#a6068f72a92f62c8111e9c36b73bdd732">Ms::Accidental::symbol</a></div><div class="ttdeci">SymId symbol() const</div><div class="ttdef"><b>Definition:</b> <a href="accidental_8cpp_source.html#l00280">accidental.cpp:280</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a0cf3aae4535ef71cc3ac6aca5bc4777d"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a0cf3aae4535ef71cc3ac6aca5bc4777d">Ms::MeasureBase::setSectionBreak</a></div><div class="ttdeci">void setSectionBreak(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00168">measurebase.h:168</a></div></div>
<div class="ttc" id="classMs_1_1Tie_html_acf72f934562e0b3b45f9e8984d0dd970"><div class="ttname"><a href="classMs_1_1Tie.html#acf72f934562e0b3b45f9e8984d0dd970">Ms::Tie::layoutFor</a></div><div class="ttdeci">TieSegment * layoutFor(System *)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8cpp_source.html#l00640">tie.cpp:640</a></div></div>
<div class="ttc" id="classMs_1_1StaffType_html"><div class="ttname"><a href="classMs_1_1StaffType.html">Ms::StaffType</a></div><div class="ttdef"><b>Definition:</b> <a href="stafftype_8h_source.html#l00177">stafftype.h:177</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feab50339a10e1de285ac99d4c3990b8693">Ms::Beam::Mode::NONE</a></div></div>
<div class="ttc" id="classMs_1_1Clef_html_a906b7768a20cb40b4e79aacdb94a583c"><div class="ttname"><a href="classMs_1_1Clef.html#a906b7768a20cb40b4e79aacdb94a583c">Ms::Clef::showCourtesy</a></div><div class="ttdeci">bool showCourtesy() const</div><div class="ttdef"><b>Definition:</b> <a href="clef_8h_source.html#l00161">clef.h:161</a></div></div>
<div class="ttc" id="namespaceMs_html_a299f1a25ba7157c59bcfb113649dbd05"><div class="ttname"><a href="namespaceMs.html#a299f1a25ba7157c59bcfb113649dbd05">Ms::distributeStaves</a></div><div class="ttdeci">static void distributeStaves(Page *page)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01568">layout.cpp:1568</a></div></div>
<div class="ttc" id="system_8h_html"><div class="ttname"><a href="system_8h.html">system.h</a></div><div class="ttdoc">Definition of classes SysStaff and System. </div></div>
<div class="ttc" id="mscore_8h_html"><div class="ttname"><a href="mscore_8h.html">mscore.h</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a5a6ecdc9edbbef845313a1048311dc40"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a5a6ecdc9edbbef845313a1048311dc40">Ms::MeasureBase::setPrev</a></div><div class="ttdeci">void setPrev(MeasureBase *e)</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00090">measurebase.h:90</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a44fa196161dc82a567582d7acd4f8cca"><div class="ttname"><a href="classMs_1_1Staff.html#a44fa196161dc82a567582d7acd4f8cca">Ms::Staff::clef</a></div><div class="ttdeci">ClefType clef(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l00331">staff.cpp:331</a></div></div>
<div class="ttc" id="volta_8h_html"><div class="ttname"><a href="volta_8h.html">volta.h</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a29b7c1273c42ffbceaed3be455a8eff1"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a29b7c1273c42ffbceaed3be455a8eff1">Ms::MeasureBase::noOffset</a></div><div class="ttdeci">int noOffset() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00146">measurebase.h:146</a></div></div>
<div class="ttc" id="sticking_8h_html"><div class="ttname"><a href="sticking_8h.html">sticking.h</a></div></div>
<div class="ttc" id="namespaceMs_html_a1d19008c03cb6d496010a5451a9a5e71a2200becb80f0019c4a2ccecec350d0db"><div class="ttname"><a href="namespaceMs.html#a1d19008c03cb6d496010a5451a9a5e71a2200becb80f0019c4a2ccecec350d0db">Ms::CrossMeasure::SECOND</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_afa6b543d5f66f5e9c6b216bddf9c4afd"><div class="ttname"><a href="classMs_1_1Chord.html#afa6b543d5f66f5e9c6b216bddf9c4afd">Ms::Chord::hook</a></div><div class="ttdeci">Hook * hook() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00165">chord.h:165</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a0ab58cc207efdeaedf1de006cd22d03d"><div class="ttname"><a href="classMs_1_1Staff.html#a0ab58cc207efdeaedf1de006cd22d03d">Ms::Staff::brackets</a></div><div class="ttdeci">const QList&lt; BracketItem * &gt; &amp; brackets() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8h_source.html#l00132">staff.h:132</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_ac1a0c95bfede9e37dd3fd910905092b8a684d325a7303f52e64011467ff5c5758"><div class="ttname"><a href="classMs_1_1MScore.html#ac1a0c95bfede9e37dd3fd910905092b8a684d325a7303f52e64011467ff5c5758">Ms::MScore::DirectionH::LEFT</a></div></div>
<div class="ttc" id="namespaceMs_html_a602ef082ffbbe2c4b11e2375cc4aa794aeab244836adffdeef9573f36a3baba75"><div class="ttname"><a href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794aeab244836adffdeef9573f36a3baba75">Ms::SymId::noteheadBlack</a></div></div>
<div class="ttc" id="bracket_8h_html"><div class="ttname"><a href="bracket_8h.html">bracket.h</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a362a1699d39b7f1684c13a1a8c75c376"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a362a1699d39b7f1684c13a1a8c75c376">Ms::MeasureBase::prev</a></div><div class="ttdeci">MeasureBase * prev() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00088">measurebase.h:88</a></div></div>
<div class="ttc" id="classMs_1_1Page_html"><div class="ttname"><a href="classMs_1_1Page.html">Ms::Page</a></div><div class="ttdef"><b>Definition:</b> <a href="page_8h_source.html#l00034">page.h:34</a></div></div>
<div class="ttc" id="namespaceMs_html_a9b1fb02f916c554309371c6513550a1ba17b8ef2c330f1430e00c9de5469fc7e7"><div class="ttname"><a href="namespaceMs.html#a9b1fb02f916c554309371c6513550a1ba17b8ef2c330f1430e00c9de5469fc7e7">Ms::LayoutMode::LINE</a></div></div>
<div class="ttc" id="classMs_1_1TDuration_html_ad9263bf173856b77421e83a48a7bf68cac23bf58f35bf1fdfa910d9de6dba47f4"><div class="ttname"><a href="classMs_1_1TDuration.html#ad9263bf173856b77421e83a48a7bf68cac23bf58f35bf1fdfa910d9de6dba47f4">Ms::TDuration::DurationType::V_MEASURE</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_af32bfc79ddc9bb0c30b72de0e8f3eed6"><div class="ttname"><a href="classMs_1_1ChordRest.html#af32bfc79ddc9bb0c30b72de0e8f3eed6">Ms::ChordRest::beam</a></div><div class="ttdeci">virtual Beam * beam() const final</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00094">chordrest.h:94</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a4aefe9ae9c020b436a6dfca0a9129531"><div class="ttname"><a href="classMs_1_1Score.html#a4aefe9ae9c020b436a6dfca0a9129531">Ms::Score::createMMRest</a></div><div class="ttdeci">void createMMRest(Measure *, Measure *, const Fraction &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02056">layout.cpp:2056</a></div></div>
<div class="ttc" id="namespaceMs_html_a1c23512c83b57cff9134dee4c7bf009f"><div class="ttname"><a href="namespaceMs.html#a1c23512c83b57cff9134dee4c7bf009f">Ms::removeBeam</a></div><div class="ttdeci">static void removeBeam(Beam *&amp;beam)</div><div class="ttdoc">Set beam mode for all elements and remove the beam. </div><div class="ttdef"><b>Definition:</b> <a href="importmxmlpass2_8cpp_source.html#l01762">importmxmlpass2.cpp:1762</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a4c0c387416b42decef16b9f25d2b935f"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a4c0c387416b42decef16b9f25d2b935f">Ms::MeasureBase::computeMinWidth</a></div><div class="ttdeci">virtual void computeMinWidth()</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00176">measurebase.h:176</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aeb1a034f75cd5b9e6ba3cf3af695ad19"><div class="ttname"><a href="classMs_1_1Score.html#aeb1a034f75cd5b9e6ba3cf3af695ad19">Ms::Score::firstSegment</a></div><div class="ttdeci">Segment * firstSegment(SegmentType s) const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8cpp_source.html#l01720">score.cpp:1720</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a9f91ce44289781c10fbaab9f5867d387"><div class="ttname"><a href="classMs_1_1Element.html#a9f91ce44289781c10fbaab9f5867d387">Ms::Element::visible</a></div><div class="ttdeci">bool visible() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00221">element.h:221</a></div></div>
<div class="ttc" id="classMs_1_1BarLine_html_a315de2de22b2736e597f2b008619d7cc"><div class="ttname"><a href="classMs_1_1BarLine.html#a315de2de22b2736e597f2b008619d7cc">Ms::BarLine::layoutRect</a></div><div class="ttdeci">QRectF layoutRect() const</div><div class="ttdef"><b>Definition:</b> <a href="barline_8cpp_source.html#l01288">barline.cpp:1288</a></div></div>
<div class="ttc" id="namespaceMs_html_a1f8470ac2e722a112c0c83de917a51a6"><div class="ttname"><a href="namespaceMs.html#a1f8470ac2e722a112c0c83de917a51a6">Ms::sff2</a></div><div class="ttdeci">static qreal sff2(qreal width, qreal xMin, const SpringMap &amp;springs)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01895">layout.cpp:1895</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a6071a1241456ef93c8a06c62269090a7"><div class="ttname"><a href="classMs_1_1Chord.html#a6071a1241456ef93c8a06c62269090a7">Ms::Chord::isGrace</a></div><div class="ttdeci">bool isGrace() const</div><div class="ttdef"><b>Definition:</b> <a href="chord_8h_source.html#l00180">chord.h:180</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_aa3dcfb3550a5ee045428734fdb2fad22"><div class="ttname"><a href="structMs_1_1LayoutContext.html#aa3dcfb3550a5ee045428734fdb2fad22">Ms::LayoutContext::endTick</a></div><div class="ttdeci">Fraction endTick</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00103">layout.h:103</a></div></div>
<div class="ttc" id="namespaceMs_html_aa0f871cf8181cec31d68d20a39010655ac6e6dc18b53b4c2681394b9d8aefcec7"><div class="ttname"><a href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655ac6e6dc18b53b4c2681394b9d8aefcec7">Ms::Pid::FIXED</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a6f4204d12e78c77052520492ae4416cd"><div class="ttname"><a href="classMs_1_1Element.html#a6f4204d12e78c77052520492ae4416cd">Ms::Element::setGenerated</a></div><div class="ttdeci">void setGenerated(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00235">element.h:235</a></div></div>
<div class="ttc" id="classMs_1_1DurationElement_html_a5eae2d4a8a4a01245e2a18d97ee7988a"><div class="ttname"><a href="classMs_1_1DurationElement.html#a5eae2d4a8a4a01245e2a18d97ee7988a">Ms::DurationElement::tuplet</a></div><div class="ttdeci">Tuplet * tuplet() const</div><div class="ttdef"><b>Definition:</b> <a href="duration_8h_source.html#l00050">duration.h:50</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html"><div class="ttname"><a href="classMs_1_1Staff.html">Ms::Staff</a></div><div class="ttdoc">Global staff data not directly related to drawing. </div><div class="ttdef"><b>Definition:</b> <a href="staff_8h_source.html#l00063">staff.h:63</a></div></div>
<div class="ttc" id="lyrics_8h_html"><div class="ttname"><a href="lyrics_8h.html">lyrics.h</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a29c760c918a400d7fb360c44da0e3ed1"><div class="ttname"><a href="classMs_1_1Score.html#a29c760c918a400d7fb360c44da0e3ed1">Ms::Score::createBeams</a></div><div class="ttdeci">void createBeams(LayoutContext &amp;, Measure *)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02525">layout.cpp:2525</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aa8955b92304c0f9e719c99cd1302db78"><div class="ttname"><a href="classMs_1_1Measure.html#aa8955b92304c0f9e719c99cd1302db78">Ms::Measure::isEmpty</a></div><div class="ttdeci">bool isEmpty(int staffIdx) const</div><div class="ttdoc">Check if the measure is filled by a full-measure rest, or is full of rests on this staff...</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l02836">measure.cpp:2836</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a88d1556bac485bde9b2d6ae3c1e6bd77"><div class="ttname"><a href="classMs_1_1Score.html#a88d1556bac485bde9b2d6ae3c1e6bd77">Ms::Score::undoAddElement</a></div><div class="ttdeci">void undoAddElement(Element *element)</div><div class="ttdef"><b>Definition:</b> <a href="edit_8cpp_source.html#l04406">edit.cpp:4406</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_ad506977829d7909fc0ad9b74e00bea33"><div class="ttname"><a href="classMs_1_1Measure.html#ad506977829d7909fc0ad9b74e00bea33">Ms::Measure::setTimesig</a></div><div class="ttdeci">void setTimesig(const Fraction &amp;f)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00143">measure.h:143</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_a1c4c00c6b1052c6c122f5fc665ec8a20"><div class="ttname"><a href="classMs_1_1Segment.html#a1c4c00c6b1052c6c122f5fc665ec8a20">Ms::Segment::next</a></div><div class="ttdeci">Segment * next() const</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00085">segment.h:85</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a68b1fd6dd0a9d1bb28c7746b37bd8157"><div class="ttname"><a href="classMs_1_1Chord.html#a68b1fd6dd0a9d1bb28c7746b37bd8157">Ms::Chord::remove</a></div><div class="ttdeci">Q_INVOKABLE void remove(Ms::Element *) override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00603">chord.cpp:603</a></div></div>
<div class="ttc" id="classMs_1_1Segment_html_ac30bce62d008049b47f408497d32dccc"><div class="ttname"><a href="classMs_1_1Segment.html#ac30bce62d008049b47f408497d32dccc">Ms::Segment::annotations</a></div><div class="ttdeci">const std::vector&lt; Element * &gt; &amp; annotations() const</div><div class="ttdef"><b>Definition:</b> <a href="segment_8h_source.html#l00172">segment.h:172</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBaseList_html_a55f35e1782bf231894ba35e6c595851e"><div class="ttname"><a href="classMs_1_1MeasureBaseList.html#a55f35e1782bf231894ba35e6c595851e">Ms::MeasureBaseList::first</a></div><div class="ttdeci">MeasureBase * first() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00157">score.h:157</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_af8d5f9d4a8333ebdc23180529f8439db"><div class="ttname"><a href="classMs_1_1Score.html#af8d5f9d4a8333ebdc23180529f8439db">Ms::Score::spanner</a></div><div class="ttdeci">const std::multimap&lt; int, Spanner * &gt; &amp; spanner() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01141">score.h:1141</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a660983b43143b9a1aa6d883e39d0fc81"><div class="ttname"><a href="classMs_1_1Chord.html#a660983b43143b9a1aa6d883e39d0fc81">Ms::Chord::stemPosX</a></div><div class="ttdeci">qreal stemPosX() const override</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l00379">chord.cpp:379</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_ae697d5ba89d7fd287571f18216914f60"><div class="ttname"><a href="structMs_1_1AcEl.html#ae697d5ba89d7fd287571f18216914f60">Ms::AcEl::bottom</a></div><div class="ttdeci">qreal bottom</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00681">layout.cpp:681</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a2d24aa5a3e7f51fc53311c360e19bd19"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a2d24aa5a3e7f51fc53311c360e19bd19">Ms::LayoutContext::LayoutContext</a></div><div class="ttdeci">LayoutContext(Score *s)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05086">layout.cpp:5086</a></div></div>
<div class="ttc" id="classMs_1_1SystemDivider_html"><div class="ttname"><a href="classMs_1_1SystemDivider.html">Ms::SystemDivider</a></div><div class="ttdef"><b>Definition:</b> <a href="systemdivider_8h_source.html#l00025">systemdivider.h:25</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ad4608ce52672a6b42930af320d9de2ef"><div class="ttname"><a href="classMs_1_1Element.html#ad4608ce52672a6b42930af320d9de2ef">Ms::Element::rtick</a></div><div class="ttdeci">virtual Fraction rtick() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00336">element.cpp:336</a></div></div>
<div class="ttc" id="slur_8h_html"><div class="ttname"><a href="slur_8h.html">slur.h</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a6f850cd0581c46bee4661210b7a7777c"><div class="ttname"><a href="classMs_1_1Element.html#a6f850cd0581c46bee4661210b7a7777c">Ms::Element::x</a></div><div class="ttdeci">virtual qreal x() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00244">element.h:244</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a19322e850e35356fc301b735ed3900c8"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a19322e850e35356fc301b735ed3900c8">Ms::LayoutContext::startTick</a></div><div class="ttdeci">Fraction startTick</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00102">layout.h:102</a></div></div>
<div class="ttc" id="classMs_1_1CmdStateLocker_html_ac8c472a03b779a7f26984fa582781103"><div class="ttname"><a href="classMs_1_1CmdStateLocker.html#ac8c472a03b779a7f26984fa582781103">Ms::CmdStateLocker::score</a></div><div class="ttdeci">Score * score</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04875">layout.cpp:4875</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_a9491f66d4e4c82e05aaea063d3654ac8"><div class="ttname"><a href="classMs_1_1Measure.html#a9491f66d4e4c82e05aaea063d3654ac8">Ms::Measure::hasMMRest</a></div><div class="ttdeci">bool hasMMRest() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00251">measure.h:251</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_adb0e0d60086c88bf8f663bd36c49bbd6"><div class="ttname"><a href="classMs_1_1Tremolo.html#adb0e0d60086c88bf8f663bd36c49bbd6">Ms::Tremolo::layout</a></div><div class="ttdeci">void layout() override</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8cpp_source.html#l00482">tremolo.cpp:482</a></div></div>
<div class="ttc" id="namespaceMs_html_a72e619a51799cbb2ec85aa0a07e8fd18a49f1f9beb48e7b006a35b2377403bea8"><div class="ttname"><a href="namespaceMs.html#a72e619a51799cbb2ec85aa0a07e8fd18a49f1f9beb48e7b006a35b2377403bea8">Ms::VerticalAlignRange::SEGMENT</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapDataList_html_a57072e581d267b61bc0bfa81c2864473"><div class="ttname"><a href="classMs_1_1VerticalGapDataList.html#a57072e581d267b61bc0bfa81c2864473">Ms::VerticalGapDataList::deleteAll</a></div><div class="ttdeci">void deleteAll()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05277">layout.cpp:5277</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea322eea03da4654d479967cb87170853d"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea322eea03da4654d479967cb87170853d">Ms::Sid::enableIndentationOnFirstSystem</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a528c9e0eefcf6ffa27fb49d32e4f64c0"><div class="ttname"><a href="classMs_1_1Score.html#a528c9e0eefcf6ffa27fb49d32e4f64c0">Ms::Score::pages</a></div><div class="ttdeci">virtual const QList&lt; Page * &gt; &amp; pages() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01012">score.h:1012</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a864ad984e2922bc06edd59dd0ac9a889"><div class="ttname"><a href="classMs_1_1Score.html#a864ad984e2922bc06edd59dd0ac9a889">Ms::Score::getNextSystem</a></div><div class="ttdeci">System * getNextSystem(LayoutContext &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l02030">layout.cpp:2030</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_a6bf4c99f6a10905a3d2c97ff0c77174d"><div class="ttname"><a href="structMs_1_1AcEl.html#a6bf4c99f6a10905a3d2c97ff0c77174d">Ms::AcEl::width</a></div><div class="ttdeci">qreal width</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00684">layout.cpp:684</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_a7735446d0fd3fbe4fecb1a6ab149c146"><div class="ttname"><a href="classMs_1_1Beam.html#a7735446d0fd3fbe4fecb1a6ab149c146">Ms::Beam::addSkyline</a></div><div class="ttdeci">void addSkyline(Skyline &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l02460">beam.cpp:2460</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_ac2c76daf5a9dc4c3cc0f366a394ab4d6"><div class="ttname"><a href="classMs_1_1Beam.html#ac2c76daf5a9dc4c3cc0f366a394ab4d6">Ms::Beam::layout</a></div><div class="ttdeci">void layout()</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00514">beam.cpp:514</a></div></div>
<div class="ttc" id="classMs_1_1CmdStateLocker_html_a0e3f9c15a4145645b443959f273715c5"><div class="ttname"><a href="classMs_1_1CmdStateLocker.html#a0e3f9c15a4145645b443959f273715c5">Ms::CmdStateLocker::~CmdStateLocker</a></div><div class="ttdeci">~CmdStateLocker()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l04878">layout.cpp:4878</a></div></div>
<div class="ttc" id="namespaceMs_html_a56be22d124547a688e971dcfc73752ff"><div class="ttname"><a href="namespaceMs.html#a56be22d124547a688e971dcfc73752ff">Ms::pd</a></div><div class="ttdeci">static const std::vector&lt; ParDescr &gt; pd</div><div class="ttdef"><b>Definition:</b> <a href="compressor_8cpp_source.html#l00036">compressor.cpp:36</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aad5110345772e4588ae5c651c35d9387"><div class="ttname"><a href="classMs_1_1Measure.html#aad5110345772e4588ae5c651c35d9387">Ms::Measure::getSegmentR</a></div><div class="ttdeci">Segment * getSegmentR(SegmentType st, const Fraction &amp;f)</div><div class="ttdoc">Get a segment of type st at relative tick position t. </div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l00829">measure.cpp:829</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_aaa704d32c5e4253d54d722276f507e2d"><div class="ttname"><a href="classMs_1_1ChordRest.html#aaa704d32c5e4253d54d722276f507e2d">Ms::ChordRest::measure</a></div><div class="ttdeci">virtual Measure * measure() const =0</div></div>
<div class="ttc" id="classMs_1_1Score_html_ae50d0b620dca99b269dea62ddcf71f5a"><div class="ttname"><a href="classMs_1_1Score.html#ae50d0b620dca99b269dea62ddcf71f5a">Ms::Score::connectTies</a></div><div class="ttdeci">void connectTies(bool silent=false)</div><div class="ttdoc">Rebuild tie connections. </div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01427">layout.cpp:1427</a></div></div>
<div class="ttc" id="classMs_1_1Part_html_a6cae82662abe64d683dff09b3c7874f8"><div class="ttname"><a href="classMs_1_1Part.html#a6cae82662abe64d683dff09b3c7874f8">Ms::Part::instrument</a></div><div class="ttdeci">Instrument * instrument(Fraction={ -1, 1 })</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2part_8cpp_source.html#l00334">part.cpp:334</a></div></div>
<div class="ttc" id="classMs_1_1CmdState_html_afedeca0fc328649e13f18d948e0fabb2"><div class="ttname"><a href="classMs_1_1CmdState.html#afedeca0fc328649e13f18d948e0fabb2">Ms::CmdState::unlock</a></div><div class="ttdeci">void unlock()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00306">score.h:306</a></div></div>
<div class="ttc" id="namespaceMs_html_aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9"><div class="ttname"><a href="namespaceMs.html#aa0f871cf8181cec31d68d20a39010655a1b8a8605d2ff5670a215e55c6645e0d9">Ms::Pid::OFFSET</a></div></div>
<div class="ttc" id="classMs_1_1DurationElement_html_a3791beed710457022daf6619f31a1eeb"><div class="ttname"><a href="classMs_1_1DurationElement.html#a3791beed710457022daf6619f31a1eeb">Ms::DurationElement::actualTicks</a></div><div class="ttdeci">Fraction actualTicks() const</div><div class="ttdef"><b>Definition:</b> <a href="duration_8cpp_source.html#l00087">duration.cpp:87</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a3c37abb86b5dfb5b16fe74155154bab8"><div class="ttname"><a href="classMs_1_1Element.html#a3c37abb86b5dfb5b16fe74155154bab8">Ms::Element::staffIdx</a></div><div class="ttdeci">int staffIdx() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00357">element.h:357</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a62c2aead455c3d63ec9466b945c6fb5a"><div class="ttname"><a href="classMs_1_1Note.html#a62c2aead455c3d63ec9466b945c6fb5a">Ms::Note::add</a></div><div class="ttdeci">void add(Element *) override</div><div class="ttdef"><b>Definition:</b> <a href="note_8cpp_source.html#l01106">note.cpp:1106</a></div></div>
<div class="ttc" id="classMs_1_1MScore_html_a4869cc8207f7c0ad6772120a1ec78c56"><div class="ttname"><a href="classMs_1_1MScore.html#a4869cc8207f7c0ad6772120a1ec78c56">Ms::MScore::horizontalPageGapOdd</a></div><div class="ttdeci">static qreal horizontalPageGapOdd</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00386">mscore.h:386</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ad46a1fa8985b3d3897101b295a7a5d3e"><div class="ttname"><a href="classMs_1_1Element.html#ad46a1fa8985b3d3897101b295a7a5d3e">Ms::Element::shape</a></div><div class="ttdeci">virtual Shape shape() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00290">element.h:290</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_aaa9eed88d78a41f6cef322c1e3b663a8"><div class="ttname"><a href="classMs_1_1Score.html#aaa9eed88d78a41f6cef322c1e3b663a8">Ms::Score::staves</a></div><div class="ttdeci">QList&lt; Staff * &gt; &amp; staves()</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00651">score.h:651</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_ad9eec4888c9aa3acb109163a2b1819a5"><div class="ttname"><a href="classMs_1_1Note.html#ad9eec4888c9aa3acb109163a2b1819a5">Ms::Note::userDotPosition</a></div><div class="ttdeci">Direction userDotPosition() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00458">note.h:458</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a085dc30a4daa69c394cd0031221d33dc"><div class="ttname"><a href="classMs_1_1Chord.html#a085dc30a4daa69c394cd0031221d33dc">Ms::Chord::layoutArticulations</a></div><div class="ttdeci">void layoutArticulations()</div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l03426">chord.cpp:3426</a></div></div>
<div class="ttc" id="layout_8h_html"><div class="ttname"><a href="layout_8h.html">layout.h</a></div></div>
<div class="ttc" id="classMs_1_1TDuration_html"><div class="ttname"><a href="classMs_1_1TDuration.html">Ms::TDuration</a></div><div class="ttdef"><b>Definition:</b> <a href="durationtype_8h_source.html#l00028">durationtype.h:28</a></div></div>
<div class="ttc" id="classMs_1_1Drumset_html"><div class="ttname"><a href="classMs_1_1Drumset.html">Ms::Drumset</a></div><div class="ttdef"><b>Definition:</b> <a href="drumset_8h_source.html#l00068">drumset.h:68</a></div></div>
<div class="ttc" id="classMs_1_1Page_html_a7e188c4049e98cb251340317bedeb1c0"><div class="ttname"><a href="classMs_1_1Page.html#a7e188c4049e98cb251340317bedeb1c0">Ms::Page::bm</a></div><div class="ttdeci">qreal bm() const</div><div class="ttdef"><b>Definition:</b> <a href="page_8cpp_source.html#l00481">page.cpp:481</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_ae31dc0de799c1e206af979e65bf837ab"><div class="ttname"><a href="classMs_1_1Staff.html#ae31dc0de799c1e206af979e65bf837ab">Ms::Staff::part</a></div><div class="ttdeci">Part * part() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8h_source.html#l00122">staff.h:122</a></div></div>
<div class="ttc" id="classMs_1_1Chord_html_a8a5728af14a2e7b599dabe6df851858d"><div class="ttname"><a href="classMs_1_1Chord.html#a8a5728af14a2e7b599dabe6df851858d">Ms::Chord::layoutStem</a></div><div class="ttdeci">void layoutStem()</div><div class="ttdoc">Layout chord tremolo stem and hook. </div><div class="ttdef"><b>Definition:</b> <a href="chord_8cpp_source.html#l01533">chord.cpp:1533</a></div></div>
<div class="ttc" id="classMs_1_1System_html_af04d55563537c07d6b993edbf897f5fd"><div class="ttname"><a href="classMs_1_1System.html#af04d55563537c07d6b993edbf897f5fd">Ms::System::systemDividerRight</a></div><div class="ttdeci">SystemDivider * systemDividerRight() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00180">system.h:180</a></div></div>
<div class="ttc" id="classMs_1_1Part_html_ac0d6f1ee40e54d54510e2c2b56a7ec5c"><div class="ttname"><a href="classMs_1_1Part.html#ac0d6f1ee40e54d54510e2c2b56a7ec5c">Ms::Part::nstaves</a></div><div class="ttdeci">int nstaves() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2part_8h_source.html#l00078">part.h:78</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6feaccc0377a8afbf50e7094f5c23a8af223"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6feaccc0377a8afbf50e7094f5c23a8af223">Ms::Beam::Mode::INVALID</a></div></div>
<div class="ttc" id="ambitus_8h_html"><div class="ttname"><a href="ambitus_8h.html">ambitus.h</a></div></div>
<div class="ttc" id="libmscore_2style_8h_html"><div class="ttname"><a href="libmscore_2style_8h.html">style.h</a></div></div>
<div class="ttc" id="namespaceMs_html_ab75fbe8b5bec673d00aa110712b4c887"><div class="ttname"><a href="namespaceMs.html#ab75fbe8b5bec673d00aa110712b4c887">Ms::resolveAccidentals</a></div><div class="ttdeci">static bool resolveAccidentals(AcEl *left, AcEl *right, qreal &amp;lx, qreal pd, qreal sp)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00696">layout.cpp:696</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a8eddd82040d61bffb0d863d6f26270d6"><div class="ttname"><a href="classMs_1_1Score.html#a8eddd82040d61bffb0d863d6f26270d6">Ms::Score::isMaster</a></div><div class="ttdeci">virtual bool isMaster() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00593">score.h:593</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a2bf2d8bb97e185e0230f52cfc550c8db"><div class="ttname"><a href="classMs_1_1Score.html#a2bf2d8bb97e185e0230f52cfc550c8db">Ms::Score::_staves</a></div><div class="ttdeci">QList&lt; Staff * &gt; _staves</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00442">score.h:442</a></div></div>
<div class="ttc" id="classMs_1_1Rest_html_ab29b536313ed9f33a07e65939faadef3"><div class="ttname"><a href="classMs_1_1Rest.html#ab29b536313ed9f33a07e65939faadef3">Ms::Rest::setTrack</a></div><div class="ttdeci">void setTrack(int val)</div><div class="ttdef"><b>Definition:</b> <a href="rest_8cpp_source.html#l00769">rest.cpp:769</a></div></div>
<div class="ttc" id="classMs_1_1TieSegment_html"><div class="ttname"><a href="classMs_1_1TieSegment.html">Ms::TieSegment</a></div><div class="ttdoc">a single segment of slur; also used for Tie </div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2tie_8h_source.html#l00025">tie.h:25</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ab0832f1270b77762f3c12758fe22c3c2"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ab0832f1270b77762f3c12758fe22c3c2">Ms::MeasureBase::el</a></div><div class="ttdeci">ElementList &amp; el()</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00104">measurebase.h:104</a></div></div>
<div class="ttc" id="tempotext_8h_html"><div class="ttname"><a href="tempotext_8h.html">tempotext.h</a></div></div>
<div class="ttc" id="classMs_1_1Fingering_html_ab204d8fc9e7842c1798326888039c13f"><div class="ttname"><a href="classMs_1_1Fingering.html#ab204d8fc9e7842c1798326888039c13f">Ms::Fingering::layoutType</a></div><div class="ttdeci">ElementType layoutType()</div><div class="ttdef"><b>Definition:</b> <a href="fingering_8cpp_source.html#l00057">fingering.cpp:57</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a693ed2bc02f09dc0fff3f6731dfa3e98ae54be9a95671f32cb40effb470d6c188"><div class="ttname"><a href="classMs_1_1Staff.html#a693ed2bc02f09dc0fff3f6731dfa3e98ae54be9a95671f32cb40effb470d6c188">Ms::Staff::HideMode::INSTRUMENT</a></div></div>
<div class="ttc" id="namespaceMs_html_a2c92ce0204176ede1ab86e2f44ae6b9ea45d886b842022787183a308e0200d336"><div class="ttname"><a href="namespaceMs.html#a2c92ce0204176ede1ab86e2f44ae6b9ea45d886b842022787183a308e0200d336">Ms::ElementType::CHORD</a></div></div>
<div class="ttc" id="namespaceMs_html_a48cf14669801f9b0080847f8d7902e5bab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="namespaceMs.html#a48cf14669801f9b0080847f8d7902e5bab50339a10e1de285ac99d4c3990b8693">Ms::OffsetChange::NONE</a></div></div>
<div class="ttc" id="classMs_1_1SysStaff_html_a707b63d183a730d81ff37aa45a22814c"><div class="ttname"><a href="classMs_1_1SysStaff.html#a707b63d183a730d81ff37aa45a22814c">Ms::SysStaff::skyline</a></div><div class="ttdeci">const Skyline &amp; skyline() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00076">system.h:76</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_a1abc92c0d4a32a0fc905da22dac303d9"><div class="ttname"><a href="classMs_1_1Tremolo.html#a1abc92c0d4a32a0fc905da22dac303d9">Ms::Tremolo::chord</a></div><div class="ttdeci">Chord * chord() const</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00068">tremolo.h:68</a></div></div>
<div class="ttc" id="classMs_1_1TDuration_html_a11652d3de9232ccf4fb664758fecfaf3"><div class="ttname"><a href="classMs_1_1TDuration.html#a11652d3de9232ccf4fb664758fecfaf3">Ms::TDuration::hooks</a></div><div class="ttdeci">int hooks() const</div><div class="ttdef"><b>Definition:</b> <a href="durationtype_8cpp_source.html#l00204">durationtype.cpp:204</a></div></div>
<div class="ttc" id="namespaceMs_html_a3f1ba7877c228a0e6e42e11658b4d77a"><div class="ttname"><a href="namespaceMs.html#a3f1ba7877c228a0e6e42e11658b4d77a">Ms::log</a></div><div class="ttdeci">static void log(MxmlLogger::Level level, const QString &amp;text, const QXmlStreamReader *const xmlreader)</div><div class="ttdef"><b>Definition:</b> <a href="importmxmllogger_8cpp_source.html#l00035">importmxmllogger.cpp:35</a></div></div>
<div class="ttc" id="classMs_1_1ChangeProperty_html"><div class="ttname"><a href="classMs_1_1ChangeProperty.html">Ms::ChangeProperty</a></div><div class="ttdef"><b>Definition:</b> <a href="undo_8h_source.html#l01033">undo.h:1033</a></div></div>
<div class="ttc" id="namespaceMs_html_a02cda2a18206af7dc3efbd0db9142e22a381fe0b09931a4acf5bc2176e1e6f854"><div class="ttname"><a href="namespaceMs.html#a02cda2a18206af7dc3efbd0db9142e22a381fe0b09931a4acf5bc2176e1e6f854">Ms::ElementFlag::GENERATED</a></div></div>
<div class="ttc" id="namespaceMs_html_a828b7d077638066c078fd12c2e34aa14"><div class="ttname"><a href="namespaceMs.html#a828b7d077638066c078fd12c2e34aa14">Ms::restoreBeams</a></div><div class="ttdeci">static void restoreBeams(Measure *m)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03363">layout.cpp:3363</a></div></div>
<div class="ttc" id="key_8h_html"><div class="ttname"><a href="key_8h.html">key.h</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html"><div class="ttname"><a href="structMs_1_1AcEl.html">Ms::AcEl</a></div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00677">layout.cpp:677</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_afa5c4d44781f40f962d4818271f60249"><div class="ttname"><a href="classMs_1_1Measure.html#afa5c4d44781f40f962d4818271f60249">Ms::Measure::barLinesSetSpan</a></div><div class="ttdeci">void barLinesSetSpan(Segment *)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l03720">measure.cpp:3720</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a70a8140969dcd988ed77e91c27b6a84f"><div class="ttname"><a href="classMs_1_1Element.html#a70a8140969dcd988ed77e91c27b6a84f">Ms::Element::symBbox</a></div><div class="ttdeci">QRectF symBbox(SymId id) const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l01591">element.cpp:1591</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea88e2a676fbe7a0e18f9c7de14d37ad35"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea88e2a676fbe7a0e18f9c7de14d37ad35">Ms::Sid::MusicalSymbolFont</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a028a9cb06e39b4da8ac2171855033f61"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a028a9cb06e39b4da8ac2171855033f61">Ms::LayoutContext::nextMeasure</a></div><div class="ttdeci">MeasureBase * nextMeasure</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00100">layout.h:100</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a3b676ebb68b3b2389539204b0e92a6fc"><div class="ttname"><a href="classMs_1_1System.html#a3b676ebb68b3b2389539204b0e92a6fc">Ms::System::restoreLayout2</a></div><div class="ttdeci">void restoreLayout2()</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00864">system.cpp:864</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_aeab5dbce17b6f48fd75b63b46c6a426b"><div class="ttname"><a href="classMs_1_1Beam.html#aeab5dbce17b6f48fd75b63b46c6a426b">Ms::Beam::layout1</a></div><div class="ttdeci">void layout1()</div><div class="ttdef"><b>Definition:</b> <a href="beam_8cpp_source.html#l00307">beam.cpp:307</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a4ce269915101a420df2d17c7082ec9d8"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a4ce269915101a420df2d17c7082ec9d8">Ms::LayoutContext::firstSystemIndent</a></div><div class="ttdeci">bool firstSystemIndent</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00083">layout.h:83</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea653c5686d0c5d0fa899597d72eebbd0d"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea653c5686d0c5d0fa899597d72eebbd0d">Ms::Sid::maxFretShiftBelow</a></div></div>
<div class="ttc" id="classMs_1_1Page_html_a27cbb69c1c1cdbe3f3a51f00283f465b"><div class="ttname"><a href="classMs_1_1Page.html#a27cbb69c1c1cdbe3f3a51f00283f465b">Ms::Page::tm</a></div><div class="ttdeci">qreal tm() const</div><div class="ttdef"><b>Definition:</b> <a href="page_8cpp_source.html#l00471">page.cpp:471</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_a3406a68198349ff0e9516ec040dfb40c"><div class="ttname"><a href="classMs_1_1Tremolo.html#a3406a68198349ff0e9516ec040dfb40c">Ms::Tremolo::crossStaffBeamBetween</a></div><div class="ttdeci">bool crossStaffBeamBetween() const</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8cpp_source.html#l00524">tremolo.cpp:524</a></div></div>
<div class="ttc" id="namespaceMs_html_a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb"><div class="ttname"><a href="namespaceMs.html#a24593d5bc01ac95fdbec3d354d258894a61c31f6ee53d26bc359f0a77fd8dc2fb">Ms::SegmentType::TimeSig</a></div></div>
<div class="ttc" id="beam_8h_html"><div class="ttname"><a href="beam_8h.html">beam.h</a></div></div>
<div class="ttc" id="classMs_1_1BarLine_html"><div class="ttname"><a href="classMs_1_1BarLine.html">Ms::BarLine</a></div><div class="ttdef"><b>Definition:</b> <a href="barline_8h_source.html#l00057">barline.h:57</a></div></div>
<div class="ttc" id="classMs_1_1Volta_html"><div class="ttname"><a href="classMs_1_1Volta.html">Ms::Volta</a></div><div class="ttdef"><b>Definition:</b> <a href="volta_8h_source.html#l00050">volta.h:50</a></div></div>
<div class="ttc" id="classMs_1_1TimeSig_html_aa96a3e42c031384a82e0b3d078114a02"><div class="ttname"><a href="classMs_1_1TimeSig.html#aa96a3e42c031384a82e0b3d078114a02">Ms::TimeSig::timeSigType</a></div><div class="ttdeci">TimeSigType timeSigType() const</div><div class="ttdef"><b>Definition:</b> <a href="timesig_8h_source.html#l00072">timesig.h:72</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_a23eaeae4e0e71fa56cf38ef5f8847310"><div class="ttname"><a href="structMs_1_1AcEl.html#a23eaeae4e0e71fa56cf38ef5f8847310">Ms::AcEl::rightClear</a></div><div class="ttdeci">qreal rightClear</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00687">layout.cpp:687</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a2beb5c0e7b78ee4366089341237b7b61"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a2beb5c0e7b78ee4366089341237b7b61">Ms::LayoutContext::curPage</a></div><div class="ttdeci">int curPage</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00085">layout.h:85</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a39025226e9614de8073a91e82dcbb8ee"><div class="ttname"><a href="classMs_1_1Note.html#a39025226e9614de8073a91e82dcbb8ee">Ms::Note::accidental</a></div><div class="ttdeci">Accidental * accidental() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00387">note.h:387</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aa910bff7edd9435bd775b373f6010b34"><div class="ttname"><a href="classMs_1_1Measure.html#aa910bff7edd9435bd775b373f6010b34">Ms::Measure::createEndBarLines</a></div><div class="ttdeci">qreal createEndBarLines(bool)</div><div class="ttdef"><b>Definition:</b> <a href="measure_8cpp_source.html#l03753">measure.cpp:3753</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a5dc40137cd531f03daad7bdca7ab68e6"><div class="ttname"><a href="classMs_1_1Score.html#a5dc40137cd531f03daad7bdca7ab68e6">Ms::Score::respace</a></div><div class="ttdeci">void respace(std::vector&lt; ChordRest *&gt; *elements)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01919">layout.cpp:1919</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a6e52d003f76686f0e20bb7843558cfab"><div class="ttname"><a href="classMs_1_1Staff.html#a6e52d003f76686f0e20bb7843558cfab">Ms::Staff::hideWhenEmpty</a></div><div class="ttdeci">HideMode hideWhenEmpty() const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8h_source.html#l00178">staff.h:178</a></div></div>
<div class="ttc" id="classMs_1_1System_html_aca7cbaa5dba797868bab81428164e673"><div class="ttname"><a href="classMs_1_1System.html#aca7cbaa5dba797868bab81428164e673">Ms::System::lastMeasure</a></div><div class="ttdeci">Measure * lastMeasure() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01205">system.cpp:1205</a></div></div>
<div class="ttc" id="namespaceMs_html_afa6870c3c1f6f75078e098386e4a6bdf"><div class="ttname"><a href="namespaceMs.html#afa6870c3c1f6f75078e098386e4a6bdf">Ms::beamNoContinue</a></div><div class="ttdeci">bool beamNoContinue(Beam::Mode mode)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l01217">layout.cpp:1217</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a573a2febbf6d0a0ee5b4fc3800705aeb"><div class="ttname"><a href="classMs_1_1System.html#a573a2febbf6d0a0ee5b4fc3800705aeb">Ms::System::vbox</a></div><div class="ttdeci">Box * vbox() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00170">system.cpp:170</a></div></div>
<div class="ttc" id="namespaceMs_html_a53c7362a3d7031429624621b2753b8cf"><div class="ttname"><a href="namespaceMs.html#a53c7362a3d7031429624621b2753b8cf">Ms::searchTieNote114</a></div><div class="ttdeci">Note * searchTieNote114(Note *note)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2utils_8cpp_source.html#l00879">utils.cpp:879</a></div></div>
<div class="ttc" id="classMs_1_1System_html_a38215a755206cfd574aab3986d59a11c"><div class="ttname"><a href="classMs_1_1System.html#a38215a755206cfd574aab3986d59a11c">Ms::System::add</a></div><div class="ttdeci">void add(Element *) override</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01012">system.cpp:1012</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_acc7b8669972325c93c8bc7c819a94b28"><div class="ttname"><a href="classMs_1_1ChordRest.html#acc7b8669972325c93c8bc7c819a94b28">Ms::ChordRest::setCrossMeasure</a></div><div class="ttdeci">void setCrossMeasure(CrossMeasure val)</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00153">chordrest.h:153</a></div></div>
<div class="ttc" id="classMs_1_1System_html"><div class="ttname"><a href="classMs_1_1System.html">Ms::System</a></div><div class="ttdoc">One row of measures for all instruments; a complete piece of the timeline. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00089">system.h:89</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_a2137ef7315aaed4adc68372946380d2c"><div class="ttname"><a href="classMs_1_1MeasureBase.html#a2137ef7315aaed4adc68372946380d2c">Ms::MeasureBase::repeatEnd</a></div><div class="ttdeci">bool repeatEnd() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8h_source.html#l00149">measurebase.h:149</a></div></div>
<div class="ttc" id="classMs_1_1Score_html"><div class="ttname"><a href="classMs_1_1Score.html">Ms::Score</a></div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00396">score.h:396</a></div></div>
<div class="ttc" id="stem_8h_html"><div class="ttname"><a href="stem_8h.html">stem.h</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a42043d12f931f0597ede4c070cafe75a"><div class="ttname"><a href="classMs_1_1Score.html#a42043d12f931f0597ede4c070cafe75a">Ms::Score::rebuildBspTree</a></div><div class="ttdeci">void rebuildBspTree()</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00084">layout.cpp:84</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_ab6aade6de785c3ad52c1ed1dadcfcd9f"><div class="ttname"><a href="classMs_1_1Element.html#ab6aade6de785c3ad52c1ed1dadcfcd9f">Ms::Element::linkedClone</a></div><div class="ttdeci">virtual Element * linkedClone()</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00219">element.cpp:219</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea96401c5dbfbdbed87fdb994c330f4b2e"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea96401c5dbfbdbed87fdb994c330f4b2e">Ms::Sid::lyricsMinTopDistance</a></div></div>
<div class="ttc" id="barline_8h_html"><div class="ttname"><a href="barline_8h.html">barline.h</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea03d7b999cbb700ae7ae5a55141d76384"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea03d7b999cbb700ae7ae5a55141d76384">Ms::Sid::dividerRightX</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a2a8ba8af6817e602c27c154e93542028"><div class="ttname"><a href="classMs_1_1Element.html#a2a8ba8af6817e602c27c154e93542028">Ms::Element::height</a></div><div class="ttdeci">virtual qreal height() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00278">element.h:278</a></div></div>
<div class="ttc" id="mmrestrange_8h_html"><div class="ttname"><a href="mmrestrange_8h.html">mmrestrange.h</a></div></div>
<div class="ttc" id="classMs_1_1Note_html_a488c3e17de900353472040373d0e7f83"><div class="ttname"><a href="classMs_1_1Note.html#a488c3e17de900353472040373d0e7f83">Ms::Note::small</a></div><div class="ttdeci">bool small() const</div><div class="ttdef"><b>Definition:</b> <a href="note_8h_source.html#l00412">note.h:412</a></div></div>
<div class="ttc" id="marker_8h_html"><div class="ttname"><a href="marker_8h.html">marker.h</a></div></div>
<div class="ttc" id="classMs_1_1LayoutBreak_html_aa955f1ea366e08738cdde0cc4362a3ad"><div class="ttname"><a href="classMs_1_1LayoutBreak.html#aa955f1ea366e08738cdde0cc4362a3ad">Ms::LayoutBreak::firstSystemIdentation</a></div><div class="ttdeci">bool firstSystemIdentation() const</div><div class="ttdef"><b>Definition:</b> <a href="layoutbreak_8h_source.html#l00074">layoutbreak.h:74</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a1a4d5789b71d29fd2e7c05311638aa7b"><div class="ttname"><a href="classMs_1_1Staff.html#a1a4d5789b71d29fd2e7c05311638aa7b">Ms::Staff::lines</a></div><div class="ttdeci">int lines(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l01535">staff.cpp:1535</a></div></div>
<div class="ttc" id="classMs_1_1System_html_ad3f579b57f4da0e51e0201418ccdbd10"><div class="ttname"><a href="classMs_1_1System.html#ad3f579b57f4da0e51e0201418ccdbd10">Ms::System::setInstrumentNames</a></div><div class="ttdeci">void setInstrumentNames(bool longName, Fraction tick={0, 1})</div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00880">system.cpp:880</a></div></div>
<div class="ttc" id="classMs_1_1Measure_html_aaf1d634e5b6782073f551ccf9e6b4481"><div class="ttname"><a href="classMs_1_1Measure.html#aaf1d634e5b6782073f551ccf9e6b4481">Ms::Measure::isIrregular</a></div><div class="ttdeci">bool isIrregular() const</div><div class="ttdef"><b>Definition:</b> <a href="measure_8h_source.html#l00146">measure.h:146</a></div></div>
<div class="ttc" id="namespaceMs_html_ae95dea350de4a3014dbcbcfe9a6a75dcafe617927f45d26bbaf17fc0e288066f8"><div class="ttname"><a href="namespaceMs.html#ae95dea350de4a3014dbcbcfe9a6a75dcafe617927f45d26bbaf17fc0e288066f8">Ms::LayoutFlag::FIX_PITCH_VELO</a></div></div>
<div class="ttc" id="classMs_1_1VerticalGapData_html_a84e88d404c58dce3fe624b35a2f9b3ce"><div class="ttname"><a href="classMs_1_1VerticalGapData.html#a84e88d404c58dce3fe624b35a2f9b3ce">Ms::VerticalGapData::VerticalGapData</a></div><div class="ttdeci">VerticalGapData(bool first, System *sys, Staff *st, SysStaff *sst, const Spacer *spacer, qreal y)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l05109">layout.cpp:5109</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a83eb91a089cdd2cd25d1f18c5b607310"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a83eb91a089cdd2cd25d1f18c5b607310">Ms::LayoutContext::measureNo</a></div><div class="ttdeci">int measureNo</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00101">layout.h:101</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a592da9bef8f5ea3c9840931e8db5f6f6"><div class="ttname"><a href="classMs_1_1Element.html#a592da9bef8f5ea3c9840931e8db5f6f6">Ms::Element::isNudged</a></div><div class="ttdeci">bool isNudged() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00274">element.h:274</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_adc45b084165da6ceb3afa7913d6a3feb"><div class="ttname"><a href="classMs_1_1Element.html#adc45b084165da6ceb3afa7913d6a3feb">Ms::Element::symWidth</a></div><div class="ttdeci">qreal symWidth(SymId id) const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l01569">element.cpp:1569</a></div></div>
<div class="ttc" id="structMs_1_1AcEl_html_a567a45827d8c039061ba10ecbccbfe2c"><div class="ttname"><a href="structMs_1_1AcEl.html#a567a45827d8c039061ba10ecbccbfe2c">Ms::AcEl::next</a></div><div class="ttdeci">int next</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l00683">layout.cpp:683</a></div></div>
<div class="ttc" id="classMs_1_1Beam_html_affab6e5059fcaefb7b25c31fd2d0e6fea19aad9f2fe3ce0023298ab83f7e75775"><div class="ttname"><a href="classMs_1_1Beam.html#affab6e5059fcaefb7b25c31fd2d0e6fea19aad9f2fe3ce0023298ab83f7e75775">Ms::Beam::Mode::BEGIN</a></div></div>
<div class="ttc" id="classMs_1_1Fraction_html_a63e242155373d30a2de43750ea718368"><div class="ttname"><a href="classMs_1_1Fraction.html#a63e242155373d30a2de43750ea718368">Ms::Fraction::fromTicks</a></div><div class="ttdeci">static Fraction fromTicks(int ticks)</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2fraction_8h_source.html#l00220">fraction.h:220</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea9df5023b8ec3a00dc282eece7e144532"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea9df5023b8ec3a00dc282eece7e144532">Ms::Sid::maxFretShiftAbove</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_a3ae68f5da280c53fd1d329f20601818b"><div class="ttname"><a href="classMs_1_1Element.html#a3ae68f5da280c53fd1d329f20601818b">Ms::Element::layout</a></div><div class="ttdeci">virtual void layout()</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00370">element.h:370</a></div></div>
<div class="ttc" id="namespaceMs_html_a602ef082ffbbe2c4b11e2375cc4aa794ae730db5c29b7ba34f4d465b01bd33c5e"><div class="ttname"><a href="namespaceMs.html#a602ef082ffbbe2c4b11e2375cc4aa794ae730db5c29b7ba34f4d465b01bd33c5e">Ms::SymId::stem</a></div></div>
<div class="ttc" id="namespaceMs_html_ace3977c7351a3c80613f191da242afdd"><div class="ttname"><a href="namespaceMs.html#ace3977c7351a3c80613f191da242afdd">Ms::SPATIUM20</a></div><div class="ttdeci">static constexpr qreal SPATIUM20</div><div class="ttdef"><b>Definition:</b> <a href="mscore_8h_source.html#l00091">mscore.h:91</a></div></div>
<div class="ttc" id="classMs_1_1Element_html_adc4d7b66745fbb0335dc73f0c3996994"><div class="ttname"><a href="classMs_1_1Element.html#adc4d7b66745fbb0335dc73f0c3996994">Ms::Element::bbox</a></div><div class="ttdeci">virtual const QRectF &amp; bbox() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8h_source.html#l00276">element.h:276</a></div></div>
<div class="ttc" id="tuplet_8h_html"><div class="ttname"><a href="tuplet_8h.html">tuplet.h</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea6ddf2c55b0a7ea98059dc9d6320ebf8f"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea6ddf2c55b0a7ea98059dc9d6320ebf8f">Ms::Sid::smallNoteMag</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ada587f42a4bbfc3e8321e4ce22c9febc"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ada587f42a4bbfc3e8321e4ce22c9febc">Ms::MeasureBase::nextMeasure</a></div><div class="ttdeci">Ms::Measure * nextMeasure() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00198">measurebase.cpp:198</a></div></div>
<div class="ttc" id="namespaceMs_html_a35bfb67e4b99502eb95a081fa7827322"><div class="ttname"><a href="namespaceMs.html#a35bfb67e4b99502eb95a081fa7827322">Ms::isTopTuplet</a></div><div class="ttdeci">bool isTopTuplet(ChordRest *cr)</div><div class="ttdef"><b>Definition:</b> <a href="layout_8cpp_source.html#l03163">layout.cpp:3163</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2eaeb0392e5088cc5879c0ee75a930b762c"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2eaeb0392e5088cc5879c0ee75a930b762c">Ms::Sid::maxChordShiftBelow</a></div></div>
<div class="ttc" id="classMs_1_1SpannerSegment_html"><div class="ttname"><a href="classMs_1_1SpannerSegment.html">Ms::SpannerSegment</a></div><div class="ttdoc">parent: System </div><div class="ttdef"><b>Definition:</b> <a href="spanner_8h_source.html#l00035">spanner.h:35</a></div></div>
<div class="ttc" id="classMs_1_1MeasureBase_html_ab63433e71da0f897674777d96da8fa0d"><div class="ttname"><a href="classMs_1_1MeasureBase.html#ab63433e71da0f897674777d96da8fa0d">Ms::MeasureBase::sectionBreakElement</a></div><div class="ttdeci">LayoutBreak * sectionBreakElement() const</div><div class="ttdef"><b>Definition:</b> <a href="measurebase_8cpp_source.html#l00666">measurebase.cpp:666</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_ab556c492bf4ca535ac980e0f557374a1"><div class="ttname"><a href="structMs_1_1LayoutContext.html#ab556c492bf4ca535ac980e0f557374a1">Ms::LayoutContext::curMeasure</a></div><div class="ttdeci">MeasureBase * curMeasure</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00099">layout.h:99</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea82fd8fc6a45f49d26bf6dd221e4d27f1"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea82fd8fc6a45f49d26bf6dd221e4d27f1">Ms::Sid::staffUpperBorder</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a7e623a06766698ff471836eac2f3fa57"><div class="ttname"><a href="classMs_1_1Score.html#a7e623a06766698ff471836eac2f3fa57">Ms::Score::lineMode</a></div><div class="ttdeci">bool lineMode() const</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l01117">score.h:1117</a></div></div>
<div class="ttc" id="staff_8h_html"><div class="ttname"><a href="staff_8h.html">staff.h</a></div><div class="ttdoc">Definition of class Staff. </div></div>
<div class="ttc" id="classMs_1_1Element_html_a0cb9e0cf90c74e5b718e10f8a9a796da"><div class="ttname"><a href="classMs_1_1Element.html#a0cb9e0cf90c74e5b718e10f8a9a796da">Ms::Element::symCutOutSW</a></div><div class="ttdeci">QPointF symCutOutSW(SymId id) const</div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l01656">element.cpp:1656</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ac325e3d1dc5f2586dffaa79ef0f6950b"><div class="ttname"><a href="classMs_1_1Score.html#ac325e3d1dc5f2586dffaa79ef0f6950b">Ms::Score::_scoreFont</a></div><div class="ttdeci">ScoreFont * _scoreFont</div><div class="ttdef"><b>Definition:</b> <a href="libmscore_2score_8h_source.html#l00435">score.h:435</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html"><div class="ttname"><a href="classMs_1_1ChordRest.html">Ms::ChordRest</a></div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00049">chordrest.h:49</a></div></div>
<div class="ttc" id="namespaceMs_html_a2bac757437d1a9e364db27de8f9c9e2ea427a6835629e8b670545ded6a98c68d7"><div class="ttname"><a href="namespaceMs.html#a2bac757437d1a9e364db27de8f9c9e2ea427a6835629e8b670545ded6a98c68d7">Ms::Sid::dividerRight</a></div></div>
<div class="ttc" id="classMs_1_1Spanner_html_a5fc082bf786fe24117dc3bdce289a7fe"><div class="ttname"><a href="classMs_1_1Spanner.html#a5fc082bf786fe24117dc3bdce289a7fe">Ms::Spanner::computeEndElement</a></div><div class="ttdeci">void computeEndElement()</div><div class="ttdef"><b>Definition:</b> <a href="spanner_8cpp_source.html#l00610">spanner.cpp:610</a></div></div>
<div class="ttc" id="classMs_1_1Tremolo_html_ae23f822657ab2477a8ad0d203e44569f"><div class="ttname"><a href="classMs_1_1Tremolo.html#ae23f822657ab2477a8ad0d203e44569f">Ms::Tremolo::setChords</a></div><div class="ttdeci">void setChords(Chord *c1, Chord *c2)</div><div class="ttdef"><b>Definition:</b> <a href="tremolo_8h_source.html#l00089">tremolo.h:89</a></div></div>
<div class="ttc" id="structMs_1_1LayoutContext_html_a23a16ac12220dcac28a0d4fbf0f03e8b"><div class="ttname"><a href="structMs_1_1LayoutContext.html#a23a16ac12220dcac28a0d4fbf0f03e8b">Ms::LayoutContext::page</a></div><div class="ttdeci">Page * page</div><div class="ttdef"><b>Definition:</b> <a href="layout_8h_source.html#l00084">layout.h:84</a></div></div>
<div class="ttc" id="classMs_1_1System_html_afaa29516c567e89998cf1df1f66664a9"><div class="ttname"><a href="classMs_1_1System.html#afaa29516c567e89998cf1df1f66664a9">Ms::System::distance</a></div><div class="ttdeci">qreal distance() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00199">system.h:199</a></div></div>
<div class="ttc" id="classMs_1_1Staff_html_a39233bf07b8a9434df49fd14fa92fb12"><div class="ttname"><a href="classMs_1_1Staff.html#a39233bf07b8a9434df49fd14fa92fb12">Ms::Staff::keySigEvent</a></div><div class="ttdeci">KeySigEvent keySigEvent(const Fraction &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="staff_8cpp_source.html#l00563">staff.cpp:563</a></div></div>
<div class="ttc" id="classMs_1_1ChordRest_html_a1ebb74b05f781c56e63bbc5ff221d7f3"><div class="ttname"><a href="classMs_1_1ChordRest.html#a1ebb74b05f781c56e63bbc5ff221d7f3">Ms::ChordRest::dots</a></div><div class="ttdeci">int dots() const</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00129">chordrest.h:129</a></div></div>
<div class="ttc" id="classMs_1_1Marker_html"><div class="ttname"><a href="classMs_1_1Marker.html">Ms::Marker</a></div><div class="ttdef"><b>Definition:</b> <a href="marker_8h_source.html#l00027">marker.h:27</a></div></div>
<div class="ttc" id="classMs_1_1System_html_ad440df7f5d01eb8f57f7752a96a4a780"><div class="ttname"><a href="classMs_1_1System.html#ad440df7f5d01eb8f57f7752a96a4a780">Ms::System::leftMargin</a></div><div class="ttdeci">qreal leftMargin() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00171">system.h:171</a></div></div>
<div class="ttc" id="classMs_1_1Clef_html_a31fa86e7a76e66fd538bd1247e2c9f34"><div class="ttname"><a href="classMs_1_1Clef.html#a31fa86e7a76e66fd538bd1247e2c9f34">Ms::Clef::setShowCourtesy</a></div><div class="ttdeci">void setShowCourtesy(bool v)</div><div class="ttdef"><b>Definition:</b> <a href="clef_8h_source.html#l00162">clef.h:162</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_ad11a10ab9b39230445e7faefa8270208"><div class="ttname"><a href="classMs_1_1Score.html#ad11a10ab9b39230445e7faefa8270208">Ms::Score::layoutLinear</a></div><div class="ttdeci">void layoutLinear(bool layoutAll, LayoutContext &amp;lc)</div><div class="ttdef"><b>Definition:</b> <a href="layoutlinear_8cpp_source.html#l00187">layoutlinear.cpp:187</a></div></div>
<div class="ttc" id="classMs_1_1Score_html_a854e949646c089e0e195db4798642d1e"><div class="ttname"><a href="classMs_1_1Score.html#a854e949646c089e0e195db4798642d1e">Ms::Score::nextMeasure</a></div><div class="ttdeci">ChordRest * nextMeasure(ChordRest *element, bool selectBehavior=false, bool mmRest=false)</div><div class="ttdef"><b>Definition:</b> <a href="navigate_8cpp_source.html#l00436">navigate.cpp:436</a></div></div>
<div class="ttc" id="namespaceMs_html_a4ddd02afd2f797a6a269ddce7466a4d6"><div class="ttname"><a href="namespaceMs.html#a4ddd02afd2f797a6a269ddce7466a4d6">Ms::Direction</a></div><div class="ttdeci">Direction</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00352">types.h:352</a></div></div>
<div class="ttc" id="classMs_1_1System_html_ac553454381db73276ef7a4a4b1ebd30a"><div class="ttname"><a href="classMs_1_1System.html#ac553454381db73276ef7a4a4b1ebd30a">Ms::System::measures</a></div><div class="ttdeci">const std::vector&lt; MeasureBase * &gt; &amp; measures() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00162">system.h:162</a></div></div>
<div class="ttc" id="classMs_1_1LayoutBreak_html_a160b67956d9b958c49cfd08b81b55868"><div class="ttname"><a href="classMs_1_1LayoutBreak.html#a160b67956d9b958c49cfd08b81b55868">Ms::LayoutBreak::startWithMeasureOne</a></div><div class="ttdeci">bool startWithMeasureOne() const</div><div class="ttdef"><b>Definition:</b> <a href="layoutbreak_8h_source.html#l00072">layoutbreak.h:72</a></div></div>
<div class="ttc" id="namespaceMs_html_a1d19008c03cb6d496010a5451a9a5e71"><div class="ttname"><a href="namespaceMs.html#a1d19008c03cb6d496010a5451a9a5e71">Ms::CrossMeasure</a></div><div class="ttdeci">CrossMeasure</div><div class="ttdef"><b>Definition:</b> <a href="chordrest_8h_source.html#l00025">chordrest.h:25</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
